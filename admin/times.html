<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Times - Yellup Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --bg-primary: #0c0e14; --bg-secondary: #12141c; --bg-card: #181a24;
            --bg-card-hover: #1e2030; --bg-sidebar: #10121a;
            --border: #1e2030; --border-light: #282a3a;
            --text-primary: #e8e9ed; --text-secondary: #8b8d9a; --text-muted: #5c5e6e;
            --accent: #f0b429; --accent-dim: rgba(240, 180, 41, 0.12);
            --green: #34d399; --green-dim: rgba(52, 211, 153, 0.12);
            --red: #f87171; --red-dim: rgba(248, 113, 113, 0.12);
            --blue: #60a5fa; --blue-dim: rgba(96, 165, 250, 0.12);
            --purple: #a78bfa; --purple-dim: rgba(167, 139, 250, 0.12);
            --sidebar-w: 250px; --header-h: 64px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'DM Sans', -apple-system, sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }

        /* ===== SIDEBAR ===== */
        .sidebar { position: fixed; left: 0; top: 0; width: var(--sidebar-w); height: 100vh; background: var(--bg-sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 100; transition: transform 0.3s ease; }
        .sidebar-brand { height: var(--header-h); display: flex; align-items: center; gap: 10px; padding: 0 20px; border-bottom: 1px solid var(--border); flex-shrink: 0; }
        .sidebar-brand .logo { width: 32px; height: 32px; background: var(--accent); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: 700; color: #000; }
        .sidebar-brand h1 { font-size: 17px; font-weight: 700; }
        .sidebar-brand h1 span { color: var(--text-muted); font-weight: 500; font-size: 12px; margin-left: 6px; }
        .sidebar-nav { flex: 1; overflow-y: auto; padding: 12px 0; }
        .sidebar-nav::-webkit-scrollbar { width: 0; }
        .nav-group { margin-bottom: 8px; }
        .nav-group-title { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.2px; color: var(--text-muted); padding: 12px 20px 6px; }
        .nav-item { display: flex; align-items: center; gap: 10px; padding: 8px 16px; margin: 1px 8px; border-radius: 8px; color: var(--text-secondary); text-decoration: none; font-size: 13px; font-weight: 500; transition: all 0.15s; }
        .nav-item:hover { background: var(--bg-card); color: var(--text-primary); }
        .nav-item.active { background: var(--accent-dim); color: var(--accent); }
        .nav-item .icon { width: 20px; text-align: center; font-size: 14px; flex-shrink: 0; }
        .sidebar-footer { padding: 12px 16px; border-top: 1px solid var(--border); flex-shrink: 0; }
        .sidebar-footer .admin-box { display: flex; align-items: center; gap: 10px; padding: 8px; border-radius: 8px; }
        .admin-avatar { width: 32px; height: 32px; background: linear-gradient(135deg, var(--accent), #e09800); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 13px; color: #000; }
        .admin-info-text { flex: 1; }
        .admin-info-text .name { font-size: 13px; font-weight: 600; }
        .admin-info-text .role { font-size: 11px; color: var(--text-muted); }
        .btn-logout { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 16px; padding: 4px; border-radius: 6px; }
        .btn-logout:hover { color: var(--red); background: var(--red-dim); }

        /* ===== MAIN ===== */
        .main { margin-left: var(--sidebar-w); min-height: 100vh; }
        .topbar { height: var(--header-h); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 32px; background: var(--bg-primary); position: sticky; top: 0; z-index: 50; }
        .topbar-left h2 { font-size: 16px; font-weight: 600; }
        .topbar-left p { font-size: 12px; color: var(--text-muted); margin-top: 1px; }
        .topbar-actions { display: flex; gap: 8px; }
        .content { padding: 24px 32px 40px; }

        /* ===== STATS ===== */
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px; }
        .stat-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; padding: 16px; }
        .stat-card .stat-icon { font-size: 20px; margin-bottom: 6px; }
        .stat-card .stat-value { font-size: 24px; font-weight: 700; font-family: 'JetBrains Mono', monospace; }
        .stat-card .stat-label { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

        /* ===== FILTER BAR ===== */
        .filter-bar { display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; align-items: center; }
        .search-box { flex: 1; min-width: 200px; position: relative; }
        .search-box input { width: 100%; padding: 9px 14px 9px 36px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-card); color: var(--text-primary); font-size: 13px; font-family: inherit; }
        .search-box input:focus { outline: none; border-color: var(--accent); }
        .search-box input::placeholder { color: var(--text-muted); }
        .search-box .si { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); font-size: 13px; color: var(--text-muted); pointer-events: none; }
        .filter-select { padding: 9px 14px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-card); color: var(--text-primary); font-size: 13px; font-family: inherit; }
        .filter-select option { background: var(--bg-card); }
        .filter-select:focus { outline: none; border-color: var(--accent); }

        /* ===== TABLE ===== */
        .table-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
        table { width: 100%; border-collapse: collapse; }
        thead th { padding: 10px 16px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); border-bottom: 1px solid var(--border); text-align: left; background: var(--bg-secondary); }
        tbody td { padding: 12px 16px; border-bottom: 1px solid var(--border); font-size: 13px; vertical-align: middle; }
        tbody tr:hover { background: var(--bg-card-hover); }
        tbody tr:last-child td { border-bottom: none; }

        .team-cell { display: flex; align-items: center; gap: 12px; }
        .team-badge { width: 38px; height: 38px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 15px; color: #fff; flex-shrink: 0; border: 2px solid rgba(255,255,255,0.15); }
        .team-name { font-weight: 600; font-size: 13px; }
        .team-country { font-size: 11px; color: var(--text-muted); }

        .id-badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 6px; font-family: 'JetBrains Mono', monospace; font-size: 10px; color: var(--text-muted); cursor: pointer; transition: all 0.15s; }
        .id-badge:hover { border-color: var(--accent); color: var(--accent); }
        .id-badge.copied { border-color: var(--green); color: var(--green); background: var(--green-dim); }

        .colors-row { display: flex; gap: 4px; }
        .color-dot { width: 22px; height: 22px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.15); }

        .actions { display: flex; gap: 6px; }
        .btn-icon { width: 30px; height: 30px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 13px; transition: all 0.15s; }
        .btn-icon:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-dim); }
        .btn-icon.danger:hover { border-color: var(--red); color: var(--red); background: var(--red-dim); }

        /* ===== PAGINATION ===== */
        .pagination { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border-top: 1px solid var(--border); }
        .pagination .info { font-size: 12px; color: var(--text-muted); }
        .pagination .btns { display: flex; gap: 6px; }
        .pg-btn { padding: 6px 14px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); font-size: 12px; cursor: pointer; font-family: inherit; }
        .pg-btn:hover { border-color: var(--accent); }
        .pg-btn:disabled { opacity: 0.3; cursor: not-allowed; }

        /* ===== BUTTONS ===== */
        .btn-primary { padding: 8px 16px; border-radius: 8px; border: none; background: var(--accent); color: #000; font-size: 13px; font-weight: 600; cursor: pointer; font-family: inherit; display: inline-flex; align-items: center; gap: 6px; }
        .btn-primary:hover { opacity: 0.9; }
        .btn-outline { padding: 8px 16px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-primary); font-size: 13px; font-weight: 500; cursor: pointer; font-family: inherit; display: inline-flex; align-items: center; gap: 6px; }
        .btn-outline:hover { border-color: var(--accent); }

        /* ===== MODAL ===== */
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 200; align-items: center; justify-content: center; }
        .modal-overlay.active { display: flex; }
        .modal { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; width: 90%; max-width: 560px; max-height: 90vh; overflow-y: auto; }
        .modal-header { padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .modal-header h3 { font-size: 15px; font-weight: 600; }
        .modal-close { background: none; border: none; color: var(--text-muted); font-size: 18px; cursor: pointer; padding: 4px; border-radius: 6px; }
        .modal-close:hover { color: var(--red); background: var(--red-dim); }
        .modal-body { padding: 20px; }

        .form-group { margin-bottom: 14px; }
        .form-group label { display: block; font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 5px; }
        .form-group input, .form-group select { width: 100%; padding: 9px 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg-secondary); color: var(--text-primary); font-size: 13px; font-family: inherit; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--accent); }
        .form-group select option { background: var(--bg-card); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

        /* Color picker */
        .colors-section { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin-bottom: 14px; }
        .colors-section h4 { font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 12px; }
        .colors-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .color-field label { font-size: 11px; color: var(--text-muted); margin-bottom: 4px; display: block; }
        .color-input-row { display: flex; gap: 6px; align-items: center; }
        .color-input-row input[type="color"] { width: 36px; height: 32px; border: none; border-radius: 6px; cursor: pointer; padding: 0; background: none; }
        .color-input-row input[type="text"] { flex: 1; padding: 6px 8px; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-card); color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 11px; text-transform: uppercase; }
        .color-input-row input[type="text"]:focus { outline: none; border-color: var(--accent); }

        /* Preview */
        .preview-section { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; padding: 20px; margin-bottom: 14px; text-align: center; }
        .preview-badge { width: 72px; height: 72px; border-radius: 16px; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 28px; color: #fff; border: 3px solid rgba(255,255,255,0.2); }
        .preview-name { font-size: 15px; font-weight: 600; }
        .preview-country { font-size: 12px; color: var(--text-muted); margin-top: 2px; }

        .modal-footer { padding: 0 20px 20px; display: flex; gap: 10px; }
        .modal-footer .btn-primary { flex: 1; justify-content: center; padding: 10px; }
        .modal-footer .btn-cancel { padding: 10px 20px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); font-size: 13px; cursor: pointer; font-family: inherit; }

        .empty-state { text-align: center; padding: 40px; color: var(--text-muted); font-size: 13px; }

        /* ===== TOAST ===== */
        .toast { position: fixed; bottom: 20px; right: 20px; padding: 12px 20px; border-radius: 10px; background: var(--bg-card); border: 1px solid var(--border); color: var(--text-primary); font-size: 13px; font-weight: 500; z-index: 999; transform: translateY(100px); opacity: 0; transition: all 0.3s; }
        .toast.show { transform: translateY(0); opacity: 1; }

        /* ===== MOBILE ===== */
        .mobile-toggle { display: none; position: fixed; top: 16px; left: 16px; z-index: 200; width: 40px; height: 40px; border-radius: 10px; background: var(--bg-card); border: 1px solid var(--border); color: var(--text-primary); font-size: 18px; cursor: pointer; align-items: center; justify-content: center; }
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 90; }
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .overlay.open { display: block; }
            .mobile-toggle { display: flex; }
            .main { margin-left: 0; }
            .topbar { padding: 0 16px 0 64px; }
            .content { padding: 16px; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .colors-grid { grid-template-columns: 1fr; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <button class="mobile-toggle" onclick="toggleSidebar()">â˜°</button>
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand"><div class="logo">Y</div><h1>Yellup <span>Admin</span></h1></div>
        <nav class="sidebar-nav">
            <div class="nav-group"><div class="nav-group-title">VisÃ£o Geral</div><a href="dashboard.html" class="nav-item"><span class="icon">ğŸ“Š</span> Dashboard</a></div>
            <div class="nav-group"><div class="nav-group-title">ConteÃºdo</div><a href="jogos.html" class="nav-item"><span class="icon">ğŸ®</span> Jogos</a><a href="perguntas.html" class="nav-item"><span class="icon">â“</span> Perguntas</a><a href="importar-perguntas.html" class="nav-item"><span class="icon">ğŸ“¥</span> Importar</a><a href="gerar-perguntas.html" class="nav-item"><span class="icon">ğŸ¤–</span> Gerar com IA</a><a href="times.html" class="nav-item active"><span class="icon">âš½</span> Times</a></div>
            <div class="nav-group"><div class="nav-group-title">Jogadores</div><a href="usuarios.html" class="nav-item"><span class="icon">ğŸ‘¥</span> UsuÃ¡rios</a><a href="ranking.html" class="nav-item"><span class="icon">ğŸ†</span> Rankings</a><a href="admin-noticias.html" class="nav-item"><span class="icon">ğŸ“°</span> NotÃ­cias</a></div>
            <div class="nav-group"><div class="nav-group-title">CompetiÃ§Ãµes</div><a href="torneios.html" class="nav-item"><span class="icon">ğŸ…</span> Torneios</a><a href="inicializar-pvp.html" class="nav-item"><span class="icon">âš”ï¸</span> Embates PvP</a></div>
            <div class="nav-group"><div class="nav-group-title">Financeiro</div><a href="financeiro.html" class="nav-item"><span class="icon">ğŸ’°</span> Resumo</a><a href="creditar-manual.html" class="nav-item"><span class="icon">â•</span> Creditar Manual</a><a href="transacoes.html" class="nav-item"><span class="icon">ğŸ’³</span> TransaÃ§Ãµes</a><a href="premiacao.html" class="nav-item"><span class="icon">ğŸ</span> PremiaÃ§Ã£o</a><a href="indicacoes.html" class="nav-item"><span class="icon">ğŸ”—</span> IndicaÃ§Ãµes</a></div>
            <div class="nav-group"><div class="nav-group-title">Bolsa</div><a href="bolsa-admin.html" class="nav-item"><span class="icon">ğŸ“ˆ</span> GestÃ£o da Bolsa</a></div>
            <div class="nav-group"><div class="nav-group-title">Sistema</div><a href="configuracoes.html" class="nav-item"><span class="icon">âš™ï¸</span> ConfiguraÃ§Ãµes</a><a href="checkup.html" class="nav-item"><span class="icon">ğŸ”</span> Checkup</a><a href="simulador_avancado.html" class="nav-item"><span class="icon">ğŸ§ª</span> Simulador</a><a href="teste-regras.html" class="nav-item"><span class="icon">ğŸ“œ</span> Regras</a></div>
        </nav>
        <div class="sidebar-footer"><div class="admin-box"><div class="admin-avatar">A</div><div class="admin-info-text"><div class="name">Admin</div><div class="role">Administrador</div></div><button class="btn-logout" onclick="sair()" title="Sair">â»</button></div></div>
    </aside>

    <!-- MAIN -->
    <div class="main">
        <div class="topbar">
            <div class="topbar-left">
                <h2>âš½ Times</h2>
                <p>Gerenciar times cadastrados</p>
            </div>
            <div class="topbar-actions">
                <button class="btn-outline" onclick="exportarCSV()">ğŸ“¥ CSV</button>
                <button class="btn-primary" onclick="abrirModal()">+ Novo Time</button>
            </div>
        </div>

        <div class="content">
            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-icon">âš½</div><div class="stat-value" id="statTotal">0</div><div class="stat-label">Total de Times</div></div>
                <div class="stat-card"><div class="stat-icon">ğŸ‡§ğŸ‡·</div><div class="stat-value" id="statBrasil">0</div><div class="stat-label">Brasil</div></div>
                <div class="stat-card"><div class="stat-icon">ğŸŒ</div><div class="stat-value" id="statEuropa">0</div><div class="stat-label">Europa</div></div>
                <div class="stat-card"><div class="stat-icon">ğŸŒ</div><div class="stat-value" id="statOutros">0</div><div class="stat-label">Outros</div></div>
            </div>

            <!-- Filters -->
            <div class="filter-bar">
                <div class="search-box">
                    <span class="si">ğŸ”</span>
                    <input type="text" id="busca" placeholder="Buscar por nome ou ID..." oninput="filtrarTimes()">
                </div>
                <select class="filter-select" id="filtroPais" onchange="filtrarTimes()">
                    <option value="">Todos os PaÃ­ses</option>
                </select>
                <select class="filter-select" id="ordenacao" onchange="filtrarTimes()">
                    <option value="nome-asc">Nome A-Z</option>
                    <option value="nome-desc">Nome Z-A</option>
                    <option value="pais-asc">PaÃ­s A-Z</option>
                    <option value="recente">Mais Recentes</option>
                </select>
            </div>

            <!-- Table -->
            <div class="table-card">
                <table>
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>ID</th>
                            <th>PaÃ­s</th>
                            <th>Cores</th>
                            <th style="width:90px">AÃ§Ãµes</th>
                        </tr>
                    </thead>
                    <tbody id="listaTimes">
                        <tr><td colspan="5" class="empty-state">Carregando times...</td></tr>
                    </tbody>
                </table>
                <div class="pagination">
                    <span class="info" id="paginaInfo">â€”</span>
                    <div class="btns">
                        <button class="pg-btn" onclick="paginaAnterior()" id="btnAnterior" disabled>â† Anterior</button>
                        <button class="pg-btn" onclick="proximaPagina()" id="btnProxima">PrÃ³xima â†’</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitulo">Novo Time</h3>
                <button class="modal-close" onclick="fecharModal()">âœ•</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="timeId">

                <!-- Preview -->
                <div class="preview-section">
                    <div class="preview-badge" id="previewBadge">?</div>
                    <div class="preview-name" id="previewNome">Nome do Time</div>
                    <div class="preview-country" id="previewPais">PaÃ­s</div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Nome do Time *</label>
                        <input type="text" id="nome" placeholder="Ex: Flamengo" oninput="atualizarPreview()">
                    </div>
                    <div class="form-group">
                        <label>PaÃ­s *</label>
                        <select id="pais" onchange="atualizarPreview()">
                            <option value="">Selecione...</option>
                            <option value="Brasil">ğŸ‡§ğŸ‡· Brasil</option>
                            <option value="Argentina">ğŸ‡¦ğŸ‡· Argentina</option>
                            <option value="Uruguai">ğŸ‡ºğŸ‡¾ Uruguai</option>
                            <option value="Paraguai">ğŸ‡µğŸ‡¾ Paraguai</option>
                            <option value="Chile">ğŸ‡¨ğŸ‡± Chile</option>
                            <option value="ColÃ´mbia">ğŸ‡¨ğŸ‡´ ColÃ´mbia</option>
                            <option value="Peru">ğŸ‡µğŸ‡ª Peru</option>
                            <option value="Equador">ğŸ‡ªğŸ‡¨ Equador</option>
                            <option value="Venezuela">ğŸ‡»ğŸ‡ª Venezuela</option>
                            <option value="BolÃ­via">ğŸ‡§ğŸ‡´ BolÃ­via</option>
                            <option value="MÃ©xico">ğŸ‡²ğŸ‡½ MÃ©xico</option>
                            <option value="EUA">ğŸ‡ºğŸ‡¸ EUA</option>
                            <option value="Inglaterra">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ Inglaterra</option>
                            <option value="Espanha">ğŸ‡ªğŸ‡¸ Espanha</option>
                            <option value="Alemanha">ğŸ‡©ğŸ‡ª Alemanha</option>
                            <option value="ItÃ¡lia">ğŸ‡®ğŸ‡¹ ItÃ¡lia</option>
                            <option value="FranÃ§a">ğŸ‡«ğŸ‡· FranÃ§a</option>
                            <option value="Portugal">ğŸ‡µğŸ‡¹ Portugal</option>
                            <option value="Holanda">ğŸ‡³ğŸ‡± Holanda</option>
                            <option value="BÃ©lgica">ğŸ‡§ğŸ‡ª BÃ©lgica</option>
                            <option value="EscÃ³cia">ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿ EscÃ³cia</option>
                            <option value="Turquia">ğŸ‡¹ğŸ‡· Turquia</option>
                            <option value="GrÃ©cia">ğŸ‡¬ğŸ‡· GrÃ©cia</option>
                            <option value="RÃºssia">ğŸ‡·ğŸ‡º RÃºssia</option>
                            <option value="UcrÃ¢nia">ğŸ‡ºğŸ‡¦ UcrÃ¢nia</option>
                            <option value="PolÃ´nia">ğŸ‡µğŸ‡± PolÃ´nia</option>
                            <option value="Ãustria">ğŸ‡¦ğŸ‡¹ Ãustria</option>
                            <option value="SuÃ­Ã§a">ğŸ‡¨ğŸ‡­ SuÃ­Ã§a</option>
                            <option value="Dinamarca">ğŸ‡©ğŸ‡° Dinamarca</option>
                            <option value="SuÃ©cia">ğŸ‡¸ğŸ‡ª SuÃ©cia</option>
                            <option value="Noruega">ğŸ‡³ğŸ‡´ Noruega</option>
                            <option value="JapÃ£o">ğŸ‡¯ğŸ‡µ JapÃ£o</option>
                            <option value="Coreia do Sul">ğŸ‡°ğŸ‡· Coreia do Sul</option>
                            <option value="China">ğŸ‡¨ğŸ‡³ China</option>
                            <option value="ArÃ¡bia Saudita">ğŸ‡¸ğŸ‡¦ ArÃ¡bia Saudita</option>
                            <option value="Qatar">ğŸ‡¶ğŸ‡¦ Qatar</option>
                            <option value="AustrÃ¡lia">ğŸ‡¦ğŸ‡º AustrÃ¡lia</option>
                        </select>
                    </div>
                </div>

                <!-- Colors -->
                <div class="colors-section">
                    <h4>ğŸ¨ Cores do Time</h4>
                    <div class="colors-grid">
                        <div class="color-field">
                            <label>PrimÃ¡ria</label>
                            <div class="color-input-row">
                                <input type="color" id="corPrimaria" value="#FF0000" onchange="syncColor('primaria'); atualizarPreview()">
                                <input type="text" id="corPrimariaHex" value="#FF0000" maxlength="7" oninput="syncHex('primaria'); atualizarPreview()">
                            </div>
                        </div>
                        <div class="color-field">
                            <label>SecundÃ¡ria</label>
                            <div class="color-input-row">
                                <input type="color" id="corSecundaria" value="#000000" onchange="syncColor('secundaria'); atualizarPreview()">
                                <input type="text" id="corSecundariaHex" value="#000000" maxlength="7" oninput="syncHex('secundaria'); atualizarPreview()">
                            </div>
                        </div>
                        <div class="color-field">
                            <label>TerciÃ¡ria</label>
                            <div class="color-input-row">
                                <input type="color" id="corTerciaria" value="#FFFFFF" onchange="syncColor('terciaria'); atualizarPreview()">
                                <input type="text" id="corTerciariaHex" value="#FFFFFF" maxlength="7" oninput="syncHex('terciaria'); atualizarPreview()">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="salvarTime()">ğŸ’¾ Salvar</button>
                <button class="btn-cancel" onclick="fecharModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        firebase.initializeApp({
            apiKey: "AIzaSyC5ZrkEy7KuCFJOtPvI7-P-JcA0MF4im5c",
            authDomain: "painel-yellup.firebaseapp.com",
            projectId: "painel-yellup",
            storageBucket: "painel-yellup.appspot.com",
            messagingSenderId: "608347210297",
            appId: "1:608347210297:web:75092713724e617c7203e8"
        });
        const db = firebase.firestore();
        const auth = firebase.auth();

        let todosTimes = [], timesFiltrados = [], paisesUnicos = new Set();
        let paginaAtual = 1;
        const porPagina = 20;

        const paisesEuropa = ['Inglaterra','Espanha','Alemanha','ItÃ¡lia','FranÃ§a','Portugal','Holanda','BÃ©lgica','EscÃ³cia','Turquia','GrÃ©cia','RÃºssia','UcrÃ¢nia','PolÃ´nia','Ãustria','SuÃ­Ã§a','Dinamarca','SuÃ©cia','Noruega'];

        const bandeiras = {
            'Brasil':'ğŸ‡§ğŸ‡·','Argentina':'ğŸ‡¦ğŸ‡·','Uruguai':'ğŸ‡ºğŸ‡¾','Paraguai':'ğŸ‡µğŸ‡¾','Chile':'ğŸ‡¨ğŸ‡±','ColÃ´mbia':'ğŸ‡¨ğŸ‡´',
            'Peru':'ğŸ‡µğŸ‡ª','Equador':'ğŸ‡ªğŸ‡¨','Venezuela':'ğŸ‡»ğŸ‡ª','BolÃ­via':'ğŸ‡§ğŸ‡´','MÃ©xico':'ğŸ‡²ğŸ‡½','EUA':'ğŸ‡ºğŸ‡¸',
            'Inglaterra':'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿','Espanha':'ğŸ‡ªğŸ‡¸','Alemanha':'ğŸ‡©ğŸ‡ª','ItÃ¡lia':'ğŸ‡®ğŸ‡¹','FranÃ§a':'ğŸ‡«ğŸ‡·','Portugal':'ğŸ‡µğŸ‡¹',
            'Holanda':'ğŸ‡³ğŸ‡±','BÃ©lgica':'ğŸ‡§ğŸ‡ª','EscÃ³cia':'ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿','Turquia':'ğŸ‡¹ğŸ‡·','GrÃ©cia':'ğŸ‡¬ğŸ‡·','RÃºssia':'ğŸ‡·ğŸ‡º',
            'UcrÃ¢nia':'ğŸ‡ºğŸ‡¦','PolÃ´nia':'ğŸ‡µğŸ‡±','Ãustria':'ğŸ‡¦ğŸ‡¹','SuÃ­Ã§a':'ğŸ‡¨ğŸ‡­','Dinamarca':'ğŸ‡©ğŸ‡°','SuÃ©cia':'ğŸ‡¸ğŸ‡ª',
            'Noruega':'ğŸ‡³ğŸ‡´','JapÃ£o':'ğŸ‡¯ğŸ‡µ','Coreia do Sul':'ğŸ‡°ğŸ‡·','China':'ğŸ‡¨ğŸ‡³','ArÃ¡bia Saudita':'ğŸ‡¸ğŸ‡¦','Qatar':'ğŸ‡¶ğŸ‡¦','AustrÃ¡lia':'ğŸ‡¦ğŸ‡º'
        };

        auth.onAuthStateChanged(user => {
            if (!user || user.email !== 'admin@yellup.com') { window.location.href = 'login.html'; return; }
            carregarTimes();
        });

        function sair() { auth.signOut().then(() => window.location.href = 'login.html'); }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); document.getElementById('overlay').classList.toggle('open'); }

        // ===== LOAD =====
        async function carregarTimes() {
            try {
                const snap = await db.collection('times').get();
                todosTimes = []; paisesUnicos = new Set();
                let br = 0, eu = 0, outros = 0;

                snap.forEach(doc => {
                    const t = { id: doc.id, ...doc.data() };
                    todosTimes.push(t);
                    if (t.pais) paisesUnicos.add(t.pais);
                    if (t.pais === 'Brasil') br++;
                    else if (paisesEuropa.includes(t.pais)) eu++;
                    else outros++;
                });

                document.getElementById('statTotal').textContent = todosTimes.length;
                document.getElementById('statBrasil').textContent = br;
                document.getElementById('statEuropa').textContent = eu;
                document.getElementById('statOutros').textContent = outros;

                const sel = document.getElementById('filtroPais');
                sel.innerHTML = '<option value="">Todos os PaÃ­ses</option>';
                [...paisesUnicos].sort().forEach(p => {
                    sel.innerHTML += `<option value="${p}">${bandeiras[p]||'ğŸ³ï¸'} ${p}</option>`;
                });

                timesFiltrados = [...todosTimes];
                filtrarTimes();
            } catch (e) {
                console.error(e);
                showToast('âŒ Erro: ' + e.message);
            }
        }

        // ===== FILTER =====
        function filtrarTimes() {
            const termo = document.getElementById('busca').value.toLowerCase();
            const pais = document.getElementById('filtroPais').value;
            const ord = document.getElementById('ordenacao').value;

            timesFiltrados = todosTimes.filter(t => {
                const ok1 = !termo || (t.nome||'').toLowerCase().includes(termo) || t.id.toLowerCase().includes(termo);
                const ok2 = !pais || t.pais === pais;
                return ok1 && ok2;
            });

            timesFiltrados.sort((a, b) => {
                switch (ord) {
                    case 'nome-asc': return (a.nome||'').localeCompare(b.nome||'');
                    case 'nome-desc': return (b.nome||'').localeCompare(a.nome||'');
                    case 'pais-asc': return (a.pais||'').localeCompare(b.pais||'');
                    default: return 0;
                }
            });

            paginaAtual = 1;
            renderizarTimes();
        }

        // ===== RENDER =====
        function renderizarTimes() {
            const inicio = (paginaAtual - 1) * porPagina;
            const pagina = timesFiltrados.slice(inicio, inicio + porPagina);
            const tbody = document.getElementById('listaTimes');

            if (pagina.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="empty-state">Nenhum time encontrado</td></tr>';
                atualizarPaginacao(); return;
            }

            tbody.innerHTML = pagina.map(t => {
                const nome = t.nome || 'Sem nome';
                const pais = t.pais || 'â€”';
                const b = bandeiras[pais] || 'ğŸ³ï¸';
                const ini = nome.charAt(0).toUpperCase();
                const c1 = t.primaria || '#333', c2 = t.secundaria || '#666', c3 = t.terciaria || '#999';
                const nEsc = nome.replace(/'/g, "\\'");

                return `<tr>
                    <td><div class="team-cell">
                        <div class="team-badge" style="background:linear-gradient(135deg,${c1},${c2});border-color:${c3}">${ini}</div>
                        <div><div class="team-name">${esc(nome)}</div><div class="team-country">${b} ${pais}</div></div>
                    </div></td>
                    <td><span class="id-badge" onclick="copiarId('${t.id}',this)" title="Copiar ID">ğŸ“‹ ${t.id.substring(0,14)}â€¦</span></td>
                    <td>${b} ${pais}</td>
                    <td><div class="colors-row">
                        <div class="color-dot" style="background:${c1}" title="${c1}"></div>
                        <div class="color-dot" style="background:${c2}" title="${c2}"></div>
                        <div class="color-dot" style="background:${c3}" title="${c3}"></div>
                    </div></td>
                    <td><div class="actions">
                        <button class="btn-icon" onclick="editarTime('${t.id}')" title="Editar">âœï¸</button>
                        <button class="btn-icon danger" onclick="excluirTime('${t.id}','${nEsc}')" title="Excluir">ğŸ—‘ï¸</button>
                    </div></td>
                </tr>`;
            }).join('');

            atualizarPaginacao();
        }

        function esc(t) { const d = document.createElement('div'); d.textContent = t; return d.innerHTML; }

        function atualizarPaginacao() {
            const total = Math.ceil(timesFiltrados.length / porPagina) || 1;
            document.getElementById('paginaInfo').textContent = `PÃ¡gina ${paginaAtual} de ${total} Â· ${timesFiltrados.length} times`;
            document.getElementById('btnAnterior').disabled = paginaAtual <= 1;
            document.getElementById('btnProxima').disabled = paginaAtual >= total;
        }

        function paginaAnterior() { if (paginaAtual > 1) { paginaAtual--; renderizarTimes(); } }
        function proximaPagina() { if (paginaAtual < Math.ceil(timesFiltrados.length / porPagina)) { paginaAtual++; renderizarTimes(); } }

        function copiarId(id, el) {
            navigator.clipboard.writeText(id).then(() => {
                el.classList.add('copied'); el.textContent = 'âœ… Copiado!';
                setTimeout(() => { el.classList.remove('copied'); el.innerHTML = `ğŸ“‹ ${id.substring(0,14)}â€¦`; }, 2000);
            });
        }

        // ===== MODAL =====
        function abrirModal() {
            document.getElementById('modalTitulo').textContent = 'Novo Time';
            document.getElementById('timeId').value = '';
            document.getElementById('nome').value = '';
            document.getElementById('pais').value = '';
            document.getElementById('corPrimaria').value = '#FF0000';
            document.getElementById('corPrimariaHex').value = '#FF0000';
            document.getElementById('corSecundaria').value = '#000000';
            document.getElementById('corSecundariaHex').value = '#000000';
            document.getElementById('corTerciaria').value = '#FFFFFF';
            document.getElementById('corTerciariaHex').value = '#FFFFFF';
            atualizarPreview();
            document.getElementById('modalOverlay').classList.add('active');
        }

        function fecharModal() { document.getElementById('modalOverlay').classList.remove('active'); }

        function editarTime(id) {
            const t = todosTimes.find(x => x.id === id);
            if (!t) return;
            document.getElementById('modalTitulo').textContent = 'Editar Time';
            document.getElementById('timeId').value = id;
            document.getElementById('nome').value = t.nome || '';
            document.getElementById('pais').value = t.pais || '';
            document.getElementById('corPrimaria').value = t.primaria || '#FF0000';
            document.getElementById('corPrimariaHex').value = t.primaria || '#FF0000';
            document.getElementById('corSecundaria').value = t.secundaria || '#000000';
            document.getElementById('corSecundariaHex').value = t.secundaria || '#000000';
            document.getElementById('corTerciaria').value = t.terciaria || '#FFFFFF';
            document.getElementById('corTerciariaHex').value = t.terciaria || '#FFFFFF';
            atualizarPreview();
            document.getElementById('modalOverlay').classList.add('active');
        }

        // ===== COLOR SYNC =====
        function cap(s) { return s.charAt(0).toUpperCase() + s.slice(1); }
        function syncColor(tipo) { document.getElementById(`cor${cap(tipo)}Hex`).value = document.getElementById(`cor${cap(tipo)}`).value.toUpperCase(); }
        function syncHex(tipo) {
            const hex = document.getElementById(`cor${cap(tipo)}Hex`).value;
            if (hex.match(/^#[0-9A-Fa-f]{6}$/)) document.getElementById(`cor${cap(tipo)}`).value = hex;
        }

        function atualizarPreview() {
            const nome = document.getElementById('nome').value || 'Nome do Time';
            const pais = document.getElementById('pais').value || 'PaÃ­s';
            const c1 = document.getElementById('corPrimaria').value;
            const c2 = document.getElementById('corSecundaria').value;
            const c3 = document.getElementById('corTerciaria').value;
            const badge = document.getElementById('previewBadge');
            badge.style.background = `linear-gradient(135deg, ${c1}, ${c2})`;
            badge.style.borderColor = c3;
            badge.textContent = nome.charAt(0).toUpperCase() || '?';
            document.getElementById('previewNome').textContent = nome;
            document.getElementById('previewPais').textContent = `${bandeiras[pais]||''} ${pais}`;
        }

        // ===== SAVE =====
        async function salvarTime() {
            const id = document.getElementById('timeId').value;
            const nome = document.getElementById('nome').value.trim();
            const pais = document.getElementById('pais').value;
            if (!nome) { showToast('âš ï¸ Digite o nome!'); return; }
            if (!pais) { showToast('âš ï¸ Selecione o paÃ­s!'); return; }

            const dados = {
                nome, pais,
                primaria: document.getElementById('corPrimaria').value,
                secundaria: document.getElementById('corSecundaria').value,
                terciaria: document.getElementById('corTerciaria').value
            };

            try {
                if (id) {
                    await db.collection('times').doc(id).update(dados);
                    showToast('âœ… Time atualizado!');
                } else {
                    const ref = await db.collection('times').add(dados);
                    showToast(`âœ… Time criado! ID: ${ref.id}`);
                }
                fecharModal();
                carregarTimes();
            } catch (e) {
                showToast('âŒ Erro: ' + e.message);
            }
        }

        async function excluirTime(id, nome) {
            if (!confirm(`Excluir o time "${nome}"?\n\nEssa aÃ§Ã£o nÃ£o pode ser desfeita!`)) return;
            try {
                await db.collection('times').doc(id).delete();
                showToast('ğŸ—‘ï¸ Time excluÃ­do!');
                carregarTimes();
            } catch (e) { showToast('âŒ ' + e.message); }
        }

        // ===== EXPORT =====
        function exportarCSV() {
            let csv = 'ID,Nome,PaÃ­s,PrimÃ¡ria,SecundÃ¡ria,TerciÃ¡ria\n';
            timesFiltrados.forEach(t => {
                csv += `"${t.id}","${(t.nome||'').replace(/"/g,'""')}","${t.pais||''}","${t.primaria||''}","${t.secundaria||''}","${t.terciaria||''}"\n`;
            });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([csv], { type: 'text/csv' }));
            a.download = 'times_yellup.csv'; a.click();
            showToast('ğŸ“¥ CSV exportado!');
        }

        // ===== TOAST =====
        function showToast(m) { const t = document.getElementById('toast'); t.textContent = m; t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 3000); }

        // ===== SHORTCUTS =====
        document.getElementById('modalOverlay').addEventListener('click', e => { if (e.target === e.currentTarget) fecharModal(); });
        document.addEventListener('keydown', e => { if (e.key === 'Escape') fecharModal(); });
    </script>
</body>
</html>
