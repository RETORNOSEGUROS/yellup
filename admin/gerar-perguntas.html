<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerar Perguntas V7 - R√°pido</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Poppins', sans-serif; 
            background: linear-gradient(135deg, #0a0e14 0%, #1a1a2e 100%); 
            color: #e4e8ee; 
            min-height: 100vh; 
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        
        h1 { 
            text-align: center; 
            font-size: 1.6rem; 
            margin-bottom: 5px;
            color: #ffb547;
        }
        .subtitle { text-align: center; color: #6b7280; margin-bottom: 25px; font-size: 0.85rem; }
        
        .card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #ffb547;
        }
        
        /* Tipo Tabs */
        .tipo-tabs { display: flex; gap: 10px; margin-bottom: 15px; }
        .tipo-tab {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }
        .tipo-tab:hover { border-color: rgba(255,181,71,0.3); }
        .tipo-tab.active { border-color: #ffb547; background: rgba(255,181,71,0.1); }
        .tipo-tab .icon { font-size: 1.8rem; }
        .tipo-tab .label { font-size: 0.85rem; font-weight: 600; }
        
        /* Search */
        .search-box { position: relative; margin-bottom: 15px; }
        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05);
            color: #e4e8ee;
            font-size: 0.95rem;
            font-family: 'Poppins', sans-serif;
        }
        .search-box input:focus { outline: none; border-color: #ffb547; }
        .search-box .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #6b7280; }
        
        .dropdown {
            position: absolute; top: 100%; left: 0; right: 0;
            background: #1a1a2e;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            margin-top: 5px;
        }
        .dropdown.show { display: block; }
        .dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .dropdown-item:hover { background: rgba(255,181,71,0.1); }
        
        /* Selecionado */
        .selecionado {
            background: rgba(34,197,94,0.1);
            border: 1px solid rgba(34,197,94,0.3);
            border-radius: 10px;
            padding: 12px 15px;
            display: none;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        .selecionado.show { display: flex; }
        .selecionado .nome { font-weight: 600; }
        .selecionado .trocar {
            background: none; border: none; color: #6b7280;
            cursor: pointer; font-size: 0.8rem;
        }
        .selecionado .trocar:hover { color: #ef4444; }
        
        /* Assunto */
        textarea {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05);
            color: #e4e8ee;
            font-size: 0.95rem;
            font-family: 'Poppins', sans-serif;
            min-height: 80px;
            resize: vertical;
            margin-bottom: 15px;
        }
        textarea:focus { outline: none; border-color: #ffb547; }
        
        .exemplos { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 15px; }
        .exemplo {
            padding: 5px 10px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            font-size: 0.75rem;
            cursor: pointer;
        }
        .exemplo:hover { background: rgba(255,181,71,0.2); }
        
        /* Bot√£o */
        .btn-gerar {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #ffb547, #ff9500);
            border: none;
            border-radius: 10px;
            color: #0a0e14;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
        }
        .btn-gerar:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255,181,71,0.3); }
        .btn-gerar:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        
        /* Resultado */
        .resultado { display: none; }
        .resultado.show { display: block; }
        
        .resultado-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .resultado-header h3 { color: #22c55e; font-size: 1rem; }
        
        .btn-copiar {
            padding: 8px 16px;
            background: #22c55e;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-size: 0.85rem;
        }
        .btn-copiar:hover { background: #16a34a; }
        
        .prompt-box {
            background: #0a0e14;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            font-family: monospace;
            font-size: 0.8rem;
            line-height: 1.5;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            color: #a1a1aa;
        }
        
        .dica {
            background: rgba(59,130,246,0.1);
            border: 1px solid rgba(59,130,246,0.3);
            border-radius: 10px;
            padding: 12px;
            margin-top: 15px;
            font-size: 0.8rem;
            color: #93c5fd;
        }
        
        .toast {
            position: fixed; bottom: 20px; right: 20px;
            padding: 12px 20px;
            background: #22c55e;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
        }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Gerador V7 - Modo R√°pido</h1>
        <p class="subtitle">Prompt m√≠nimo = Resposta em 2-3 minutos</p>

        <div class="card">
            <div class="card-title">1. Tipo</div>
            <div class="tipo-tabs">
                <div class="tipo-tab active" onclick="setTipo('time')">
                    <div class="icon">‚öΩ</div>
                    <div class="label">Time</div>
                </div>
                <div class="tipo-tab" onclick="setTipo('camp')">
                    <div class="icon">üèÜ</div>
                    <div class="label">Campeonato</div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">2. <span id="labelEntidade">Time</span></div>
            <div class="search-box" id="searchBox">
                <span class="material-icons search-icon">search</span>
                <input type="text" id="searchInput" placeholder="Buscar..." autocomplete="off">
                <div class="dropdown" id="dropdown"></div>
            </div>
            <div class="selecionado" id="selecionado">
                <span class="nome" id="nomeEntidade">-</span>
                <button class="trocar" onclick="trocar()">‚úï Trocar</button>
            </div>
        </div>

        <div class="card">
            <div class="card-title">3. Tema das Perguntas</div>
            <textarea id="assunto" placeholder="Sobre o que ser√£o as perguntas?&#10;&#10;Ex: Perguntas sobre Rom√°rio na sele√ß√£o&#10;Ex: Campe√µes de 1990 a 2010&#10;Ex: Hist√≥ria do est√°dio"></textarea>
            <div class="exemplos" id="exemplos"></div>
            <button class="btn-gerar" onclick="gerar()" id="btnGerar" disabled>‚ö° Gerar Prompt</button>
        </div>

        <div class="card resultado" id="resultado">
            <div class="resultado-header">
                <h3>‚úÖ Prompt Pronto!</h3>
                <button class="btn-copiar" onclick="copiar()">üìã Copiar</button>
            </div>
            <div class="prompt-box" id="promptBox"></div>
            <div class="dica">
                üí° <strong>Dica:</strong> Cole no Claude/ChatGPT. Deve responder em 2-3 minutos com 20 perguntas prontas para importar!
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <script>
        firebase.initializeApp({
            apiKey: "AIzaSyC5ZrkEy7KuCFJOtPvI7-P-JcA0MF4im5c",
            authDomain: "painel-yellup.firebaseapp.com",
            projectId: "painel-yellup",
            storageBucket: "painel-yellup.appspot.com",
            messagingSenderId: "608347210297",
            appId: "1:608347210297:web:75092713724e617c7203e8"
        });
        var db = firebase.firestore();
        var auth = firebase.auth();

        var times = [], camps = [];
        var tipo = 'time';
        var entidade = null;

        var exTime = ['Jogadores hist√≥ricos', 'T√≠tulos conquistados', 'Artilheiros', 'Anos 80/90', 'T√©cnicos', 'Rivalidades', 'Est√°dio'];
        var exCamp = ['Campe√µes por d√©cada', 'Finais hist√≥ricas', 'Artilheiros', 'Recordes', 'Times mais vezes campe√µes', 'Curiosidades'];

        document.addEventListener('DOMContentLoaded', function() {
            auth.onAuthStateChanged(function(user) {
                if (!user || user.email !== "admin@yellup.com") {
                    window.location.href = "login.html";
                } else {
                    carregar();
                }
            });
            setup();
            renderExemplos();
        });

        async function carregar() {
            var st = await db.collection('times').orderBy('nome').get();
            times = []; st.forEach(function(d) { times.push({id: d.id, ...d.data()}); });
            
            var sc = await db.collection('campeonatos').orderBy('nome').get();
            camps = []; sc.forEach(function(d) { camps.push({id: d.id, ...d.data()}); });
        }

        function setup() {
            var input = document.getElementById('searchInput');
            input.addEventListener('focus', showDropdown);
            input.addEventListener('input', showDropdown);
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-box')) {
                    document.getElementById('dropdown').classList.remove('show');
                }
            });
        }

        function setTipo(t) {
            tipo = t;
            entidade = null;
            document.querySelectorAll('.tipo-tab').forEach(function(x) { x.classList.remove('active'); });
            document.querySelectorAll('.tipo-tab')[t === 'time' ? 0 : 1].classList.add('active');
            document.getElementById('labelEntidade').textContent = t === 'time' ? 'Time' : 'Campeonato';
            document.getElementById('searchInput').value = '';
            document.getElementById('searchBox').classList.remove('hidden');
            document.getElementById('selecionado').classList.remove('show');
            document.getElementById('btnGerar').disabled = true;
            document.getElementById('resultado').classList.remove('show');
            renderExemplos();
        }

        function showDropdown() {
            var input = document.getElementById('searchInput');
            var drop = document.getElementById('dropdown');
            var busca = input.value.toLowerCase();
            var lista = tipo === 'time' ? times : camps;
            
            var filtrados = lista.filter(function(x) { return x.nome.toLowerCase().includes(busca); });
            var icon = tipo === 'time' ? '‚öΩ' : 'üèÜ';
            
            var html = filtrados.slice(0, 20).map(function(x) {
                return '<div class="dropdown-item" onclick="selecionar(\'' + x.id + '\')">' + icon + ' ' + x.nome + '</div>';
            }).join('');
            
            drop.innerHTML = html || '<div class="dropdown-item" style="color:#6b7280;">Nenhum encontrado</div>';
            drop.classList.add('show');
        }

        function selecionar(id) {
            var lista = tipo === 'time' ? times : camps;
            entidade = lista.find(function(x) { return x.id === id; });
            if (!entidade) return;
            
            document.getElementById('dropdown').classList.remove('show');
            document.getElementById('searchBox').classList.add('hidden');
            document.getElementById('nomeEntidade').textContent = (tipo === 'time' ? '‚öΩ ' : 'üèÜ ') + entidade.nome;
            document.getElementById('selecionado').classList.add('show');
            document.getElementById('btnGerar').disabled = false;
        }

        function trocar() {
            entidade = null;
            document.getElementById('searchBox').classList.remove('hidden');
            document.getElementById('selecionado').classList.remove('show');
            document.getElementById('searchInput').value = '';
            document.getElementById('btnGerar').disabled = true;
        }

        function renderExemplos() {
            var lista = tipo === 'time' ? exTime : exCamp;
            document.getElementById('exemplos').innerHTML = lista.map(function(e) {
                return '<span class="exemplo" onclick="usarExemplo(\'' + e + '\')">' + e + '</span>';
            }).join('');
        }

        function usarExemplo(t) {
            document.getElementById('assunto').value = t;
        }

        function gerar() {
            if (!entidade) return;
            var assunto = document.getElementById('assunto').value.trim();
            var prompt = gerarPrompt(entidade, assunto);
            document.getElementById('promptBox').textContent = prompt;
            document.getElementById('resultado').classList.add('show');
            document.getElementById('resultado').scrollIntoView({ behavior: 'smooth' });
        }

        function gerarPrompt(ent, assunto) {
            var tema = assunto ? 'TEMA ESPEC√çFICO: ' + assunto + '\n\n' : '';
            
            if (tipo === 'time') {
                return `Gere 20 perguntas de quiz sobre o time ${ent.nome}.

${tema}JSON array com esta estrutura:
[{
  "pergunta": "...",
  "alternativas": {"A": "...", "B": "...", "C": "...", "D": "..."},
  "correta": "A",
  "pontuacao": 5,
  "timeId": "${ent.id}",
  "timeNome": "${ent.nome}",
  "campeonatoId": "",
  "campeonatoNome": "",
  "fonte": "Wikipedia"
}]

Regras:
- pontuacao: 1-4 f√°cil, 5-6 m√©dio, 7-10 dif√≠cil
- fonte: origem da informa√ß√£o (Wikipedia, site oficial, etc)
- Apenas JSON, sem explica√ß√µes`;
            } else {
                return `Gere 20 perguntas de quiz sobre o campeonato ${ent.nome}.

${tema}JSON array com esta estrutura:
[{
  "pergunta": "...",
  "alternativas": {"A": "...", "B": "...", "C": "...", "D": "..."},
  "correta": "A",
  "pontuacao": 5,
  "timeId": "",
  "timeNome": "",
  "campeonatoId": "${ent.id}",
  "campeonatoNome": "${ent.nome}",
  "fonte": "Wikipedia"
}]

Regras:
- pontuacao: 1-4 f√°cil, 5-6 m√©dio, 7-10 dif√≠cil
- fonte: origem da informa√ß√£o (Wikipedia, RSSSF, site oficial, etc)
- Apenas JSON, sem explica√ß√µes`;
            }
        }

        function copiar() {
            var texto = document.getElementById('promptBox').textContent;
            navigator.clipboard.writeText(texto).then(function() {
                var btn = document.querySelector('.btn-copiar');
                btn.textContent = '‚úÖ Copiado!';
                setTimeout(function() { btn.textContent = 'üìã Copiar'; }, 2000);
                
                var toast = document.createElement('div');
                toast.className = 'toast';
                toast.textContent = 'Copiado! Cole no Claude/ChatGPT';
                document.body.appendChild(toast);
                setTimeout(function() { toast.remove(); }, 3000);
            });
        }
    </script>
</body>
</html>
