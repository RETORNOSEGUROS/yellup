
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel de Perguntas - Yellup</title>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
import { getFirestore, collection, getDocs, addDoc, serverTimestamp, query, where } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC5ZrkEy7KuCFJOtPvI7-P-JcA0MF4im5c",
  authDomain: "painel-yellup.firebaseapp.com",
  projectId: "painel-yellup",
  storageBucket: "painel-yellup.appspot.com",
  messagingSenderId: "608347210297",
  appId: "1:608347210297:web:75092713724e617c7203e8",
  measurementId: "G-SYZ16X31KQ"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Simula time torcido do usuário (poderá vir do banco no futuro)
const timeEscolhido = "corinthians";

async function carregarPerguntas() {
  const q = query(collection(db, "perguntas"), where("time", "==", timeEscolhido));
  const snap = await getDocs(q);
  const lista = document.getElementById("perguntas");
  lista.innerHTML = "";
  snap.forEach(docu => {
    const pergunta = docu.data();
    const div = document.createElement("div");
    div.innerHTML = `
      <h3>${pergunta.texto}</h3>
      <button onclick="responder('${docu.id}', 'A', '${pergunta.correta}')">A) ${pergunta.a}</button><br>
      <button onclick="responder('${docu.id}', 'B', '${pergunta.correta}')">B) ${pergunta.b}</button><br>
      <button onclick="responder('${docu.id}', 'C', '${pergunta.c})">C) ${pergunta.c}</button><br>
      <button onclick="responder('${docu.id}', 'D', '${pergunta.correta}')">D) ${pergunta.d}</button>
    `;
    lista.appendChild(div);
  });
}

window.responder = async (id, resp, correta) => {
  const user = auth.currentUser;
  if (!user) return alert("Você precisa estar logado.");
  const acerto = resp === correta;
  await addDoc(collection(db, "respostas"), {
    uid: user.uid,
    perguntaId: id,
    resposta: resp,
    correta: acerto,
    timestamp: serverTimestamp()
  });
  alert(acerto ? "Você acertou!" : "Resposta incorreta.");
  location.reload();
};

onAuthStateChanged(auth, (user) => {
  if (user) {
    document.getElementById("info").innerHTML = `<h2>${user.email}</h2><p>Perguntas sobre o time: <strong>${timeEscolhido.toUpperCase()}</strong></p>`;
    carregarPerguntas();
  } else {
    window.location.href = "login_usuario.html";
  }
});
</script>
<style>
body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; text-align: center; }
.container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
button { margin: 5px; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
button:hover { background: #0056b3; }
h3 { color: #333; }
</style>
</head>
<body>
<div class="container">
<div id="info"><h1>Verificando usuário...</h1></div>
<div id="perguntas"><p>Carregando perguntas...</p></div>
</div>
</body>
</html>
