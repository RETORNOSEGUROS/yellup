<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Painel - Yellup</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1a1a6e">
  <link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32.png">
  <link rel="apple-touch-icon" href="/icons/apple-icon-180.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Yellup">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* Cores principais - mais quentes e vibrantes */
      --bg-dark: #0a0e13;
      --bg-card: #131920;
      --bg-elevated: #1a2230;
      --accent-primary: #ff9f43;
      --accent-secondary: #ffc048;
      --accent-glow: rgba(255, 159, 67, 0.25);
      --live-red: #ff4757;
      --win-green: #2ed573;
      --text-primary: #f1f2f6;
      --text-secondary: #a4b0be;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg-dark);
      background-image: 
        radial-gradient(ellipse at top, rgba(255, 159, 67, 0.03) 0%, transparent 50%),
        radial-gradient(ellipse at bottom, rgba(26, 34, 48, 0.5) 0%, transparent 50%);
      background-attachment: fixed;
      color: var(--text-primary);
      min-height: 100vh;
      padding-bottom: 140px;
    }

    /* ==================== HEADER ==================== */
    .header {
      background: rgba(10, 14, 19, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 12px 16px;
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(255, 159, 67, 0.1);
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
    }

    .logo img {
      height: 36px;
      width: auto;
      filter: drop-shadow(0 2px 8px rgba(255, 181, 71, 0.3));
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffb547 0%, #ff8c42 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1.2em;
      color: #0e141b;
    }

    .user-name {
      font-weight: 600;
    }

    .btn-logout {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: #e7eef7;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      transition: all 0.3s ease;
    }

    .btn-logout:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* ==================== CONTAINER ==================== */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    /* ==================== PERFIL COMPACTO ==================== */
    .user-profile {
      background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-elevated) 100%);
      border: 1px solid rgba(255, 159, 67, 0.15);
      border-radius: 20px;
      padding: 16px 20px;
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
    }

    .user-profile::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary), var(--accent-primary));
      background-size: 200% 100%;
      animation: shimmerBar 3s linear infinite;
    }

    @keyframes shimmerBar {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* ==================== HERO DIN√ÇMICO ==================== */
    .hero-dynamic {
      position: relative;
      border-radius: 20px;
      overflow: hidden;
      margin-bottom: 20px;
      min-height: 140px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .hero-dynamic:active { transform: scale(0.985); }

    .hero-dynamic .hero-bg {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background-size: cover;
      background-position: center;
      filter: brightness(0.4) saturate(1.2);
      transition: filter 0.3s;
    }
    .hero-dynamic:hover .hero-bg { filter: brightness(0.5) saturate(1.3); }

    .hero-dynamic .hero-overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(135deg, rgba(10,14,19,0.7) 0%, rgba(10,14,19,0.3) 100%);
    }

    .hero-dynamic .hero-content {
      position: relative;
      z-index: 2;
      padding: 24px;
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .hero-emoji {
      font-size: 3.5em;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.5));
      animation: heroPulse 2s ease-in-out infinite;
      flex-shrink: 0;
    }

    @keyframes heroPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.08); }
    }

    .hero-text { flex: 1; }

    .hero-tag {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 6px;
      font-size: 0.65em;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
    }
    .hero-tag.live { background: var(--live-red); color: white; animation: pulse-live 2s infinite; }
    .hero-tag.daily { background: var(--accent-primary); color: var(--bg-dark); }
    .hero-tag.reward { background: var(--win-green); color: var(--bg-dark); }
    .hero-tag.upcoming { background: rgba(59,130,246,0.8); color: white; }

    .hero-title {
      font-size: 1.25em;
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 4px;
      text-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }

    .hero-subtitle {
      font-size: 0.85em;
      color: rgba(255,255,255,0.75);
      text-shadow: 0 1px 4px rgba(0,0,0,0.5);
    }

    .hero-arrow {
      font-size: 1.5em;
      color: rgba(255,255,255,0.6);
      flex-shrink: 0;
      animation: heroArrow 1.5s ease-in-out infinite;
    }

    @keyframes heroArrow {
      0%, 100% { transform: translateX(0); opacity: 0.6; }
      50% { transform: translateX(5px); opacity: 1; }
    }

    /* Hero navigation dots */
    .hero-dots {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 6px;
      z-index: 3;
    }
    .hero-dots .hdot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
      cursor: pointer;
    }
    .hero-dots .hdot.active {
      background: var(--accent-secondary);
      width: 18px;
      border-radius: 3px;
    }

    /* ==================== ONLINE COUNTER BAR ==================== */
    .online-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      background: linear-gradient(135deg, rgba(46,213,115,0.08), rgba(255,159,67,0.05));
      border: 1px solid rgba(46,213,115,0.15);
      border-radius: 14px;
      margin-bottom: 16px;
      font-size: 0.82em;
    }
    .online-bar .online-dot {
      width: 8px; height: 8px;
      background: #2ed573;
      border-radius: 50%;
      box-shadow: 0 0 8px rgba(46,213,115,0.6);
      animation: onlinePulse 2s ease-in-out infinite;
      flex-shrink: 0;
    }
    @keyframes onlinePulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(0.85); }
    }
    .online-bar .online-count {
      font-weight: 800;
      color: #2ed573;
    }
    .online-bar .online-text {
      color: var(--text-secondary);
    }
    .online-bar .online-cta {
      margin-left: auto;
      color: var(--accent-primary);
      font-weight: 600;
      font-size: 0.9em;
      cursor: pointer;
      white-space: nowrap;
    }

    /* ==================== NEWS TICKER / LETREIRO ==================== */
    .news-ticker {
      position: fixed;
      bottom: 80px;
      left: 0; right: 0;
      background: linear-gradient(90deg, rgba(10,14,19,0.97), rgba(26,34,48,0.97));
      border-top: 1px solid rgba(255,159,67,0.15);
      z-index: 98;
      overflow: hidden;
      height: 32px;
      display: flex;
      align-items: center;
    }
    .news-ticker-label {
      background: var(--accent-primary);
      color: #000;
      font-weight: 800;
      font-size: 0.65em;
      padding: 4px 10px;
      white-space: nowrap;
      flex-shrink: 0;
      letter-spacing: 0.5px;
      z-index: 1;
    }
    .news-ticker-track {
      display: flex;
      animation: tickerScroll var(--ticker-duration, 30s) linear infinite;
      white-space: nowrap;
    }
    @keyframes tickerScroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    .news-ticker-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 0 24px;
      font-size: 0.72em;
      color: var(--text-secondary);
      white-space: nowrap;
    }
    .news-ticker-item .ticker-emoji {
      font-size: 1.1em;
    }
    .news-ticker-item .ticker-highlight {
      color: var(--accent-secondary);
      font-weight: 700;
    }
    .news-ticker-sep {
      color: rgba(255,159,67,0.3);
      padding: 0 8px;
    }

    /* ==================== QUICK STATS STRIP ==================== */
    .quick-stats-strip {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 2px;
    }
    .quick-stats-strip::-webkit-scrollbar { display: none; }

    .qs-chip {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--bg-card);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 12px;
      white-space: nowrap;
      flex-shrink: 0;
      transition: all 0.2s;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
    }
    .qs-chip:hover { border-color: rgba(255,159,67,0.3); background: var(--bg-elevated); }

    .qs-chip .qs-icon { font-size: 1.1em; }
    .qs-chip .qs-value { font-weight: 800; font-size: 0.9em; color: var(--accent-secondary); }
    .qs-chip .qs-label { font-size: 0.7em; color: var(--text-secondary); }

    .qs-chip.streak { border-color: rgba(255,159,67,0.2); }
    .qs-chip.streak .qs-value { color: #ff9f43; }

    /* ==================== SE√á√ÉO CATEGORIZADA ==================== */
    .section-cat {
      margin-bottom: 24px;
    }

    .section-cat-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 14px;
      padding-left: 2px;
    }

    .section-cat-title {
      font-size: 1.05em;
      font-weight: 700;
    }

    .section-cat-line {
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, rgba(255,159,67,0.3), transparent);
    }

    /* Cards grandes (a√ß√µes prim√°rias) ‚Äî GLASSMORPHISM */
    .action-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 20px;
    }

    .action-card {
      position: relative;
      border-radius: 18px;
      padding: 22px 18px;
      text-decoration: none;
      color: var(--text-primary);
      overflow: hidden;
      transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(255,255,255,0.12);
      min-height: 130px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    /* Shimmer overlay on action cards */
    .action-card::before {
      content: '';
      position: absolute;
      top: 0; left: -100%; right: 0; bottom: 0;
      width: 200%;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.06) 50%, transparent 100%);
      animation: cardShimmer 4s ease-in-out infinite;
    }
    @keyframes cardShimmer {
      0% { transform: translateX(-50%); }
      100% { transform: translateX(50%); }
    }

    .action-card:hover { transform: translateY(-4px) scale(1.02); }
    .action-card:active { transform: scale(0.96); }

    .action-card .ac-icon {
      margin-bottom: 10px;
      position: relative;
      z-index: 1;
      line-height: 0;
    }
    .action-card .ac-icon img {
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
      border-radius: 8px;
    }
    .action-card .ac-title { font-weight: 800; font-size: 1em; margin-bottom: 3px; position: relative; z-index: 1; }
    .action-card .ac-desc { font-size: 0.75em; color: rgba(255,255,255,0.7); position: relative; z-index: 1; }
    .action-card .ac-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 3px 8px;
      border-radius: 8px;
      font-size: 0.55em;
      font-weight: 700;
      z-index: 2;
    }

    /* Decorative SVG shapes inside cards */
    .action-card .ac-deco {
      position: absolute;
      bottom: -10px;
      right: -10px;
      width: 80px;
      height: 80px;
      opacity: 0.08;
      z-index: 0;
    }

    /* Estilos individuais por card */
    .ac-embates {
      background: linear-gradient(135deg, rgba(220,38,38,0.85) 0%, rgba(153,27,27,0.9) 100%);
      border-color: rgba(239,68,68,0.35);
      box-shadow: 0 8px 30px rgba(239,68,68,0.2), inset 0 1px 0 rgba(255,255,255,0.1);
    }
    .ac-embates:hover { box-shadow: 0 12px 40px rgba(239,68,68,0.35), inset 0 1px 0 rgba(255,255,255,0.1); }

    .ac-penaltis {
      background: linear-gradient(135deg, rgba(22,163,74,0.85) 0%, rgba(22,101,52,0.9) 100%);
      border-color: rgba(34,197,94,0.35);
      box-shadow: 0 8px 30px rgba(34,197,94,0.2), inset 0 1px 0 rgba(255,255,255,0.1);
    }
    .ac-penaltis:hover { box-shadow: 0 12px 40px rgba(34,197,94,0.35), inset 0 1px 0 rgba(255,255,255,0.1); }

    .ac-bau {
      background: linear-gradient(135deg, rgba(202,138,4,0.85) 0%, rgba(133,77,14,0.9) 100%);
      border-color: rgba(234,179,8,0.35);
      box-shadow: 0 8px 30px rgba(234,179,8,0.15), inset 0 1px 0 rgba(255,255,255,0.1);
    }
    .ac-bau:hover { box-shadow: 0 12px 40px rgba(234,179,8,0.3), inset 0 1px 0 rgba(255,255,255,0.1); }

    .ac-missoes {
      background: linear-gradient(135deg, rgba(234,88,12,0.85) 0%, rgba(154,52,18,0.9) 100%);
      border-color: rgba(249,115,22,0.35);
      box-shadow: 0 8px 30px rgba(249,115,22,0.15), inset 0 1px 0 rgba(255,255,255,0.1);
    }
    .ac-missoes:hover { box-shadow: 0 12px 40px rgba(249,115,22,0.3), inset 0 1px 0 rgba(255,255,255,0.1); }

    /* Cards menores (explorar) */
    .explore-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .explore-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 16px 10px;
      background: rgba(19,25,32,0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 14px;
      text-decoration: none;
      color: var(--text-primary);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    .explore-card:hover {
      border-color: rgba(255,159,67,0.3);
      background: rgba(26,34,48,0.8);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }
    .explore-card:active { transform: scale(0.95); }

    .explore-card .ec-icon { margin-bottom: 6px; line-height: 0; }
    .explore-card .ec-icon img { border-radius: 6px; filter: drop-shadow(0 2px 6px rgba(0,0,0,0.3)); }
    .explore-card .ec-title { font-weight: 700; font-size: 0.75em; }
    .explore-card .ec-desc { font-size: 0.6em; color: var(--text-secondary); margin-top: 2px; }
    .explore-card .ec-badge {
      position: absolute;
      top: 6px;
      right: 6px;
      padding: 2px 6px;
      border-radius: 6px;
      font-size: 0.5em;
      font-weight: 700;
    }

    /* ==================== ANIMA√á√ïES DE ENTRADA PREMIUM ==================== */
    @keyframes revealUp {
      from { opacity: 0; transform: translateY(30px) scale(0.97); filter: blur(4px); }
      to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
    }
    @keyframes revealScale {
      from { opacity: 0; transform: scale(0.9); filter: blur(6px); }
      to { opacity: 1; transform: scale(1); filter: blur(0); }
    }
    @keyframes revealLeft {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .anim-in { animation: revealUp 0.6s cubic-bezier(0.22, 1, 0.36, 1) both; }
    .anim-scale { animation: revealScale 0.6s cubic-bezier(0.22, 1, 0.36, 1) both; }
    .anim-left { animation: revealLeft 0.5s cubic-bezier(0.22, 1, 0.36, 1) both; }
    .anim-d1 { animation-delay: 0.08s; }
    .anim-d2 { animation-delay: 0.16s; }
    .anim-d3 { animation-delay: 0.24s; }
    .anim-d4 { animation-delay: 0.32s; }
    .anim-d5 { animation-delay: 0.4s; }
    .anim-d6 { animation-delay: 0.48s; }

    /* Stagger individual cards dentro do grid */
    .action-cards .action-card { opacity: 0; animation: revealScale 0.5s cubic-bezier(0.22, 1, 0.36, 1) both; }
    .action-cards .action-card:nth-child(1) { animation-delay: 0.35s; }
    .action-cards .action-card:nth-child(2) { animation-delay: 0.42s; }
    .action-cards .action-card:nth-child(3) { animation-delay: 0.49s; }
    .action-cards .action-card:nth-child(4) { animation-delay: 0.56s; }

    .explore-grid .explore-card { opacity: 0; animation: revealUp 0.45s cubic-bezier(0.22, 1, 0.36, 1) both; }
    .explore-grid .explore-card:nth-child(1) { animation-delay: 0.45s; }
    .explore-grid .explore-card:nth-child(2) { animation-delay: 0.5s; }
    .explore-grid .explore-card:nth-child(3) { animation-delay: 0.55s; }
    .explore-grid .explore-card:nth-child(4) { animation-delay: 0.6s; }
    .explore-grid .explore-card:nth-child(5) { animation-delay: 0.65s; }
    .explore-grid .explore-card:nth-child(6) { animation-delay: 0.7s; }
    .explore-grid .explore-card:nth-child(7) { animation-delay: 0.75s; }
    .explore-grid .explore-card:nth-child(8) { animation-delay: 0.8s; }
    .explore-grid .explore-card:nth-child(9) { animation-delay: 0.85s; }

    /* ==================== SKELETON LOADING ==================== */
    @keyframes skeletonPulse {
      0% { opacity: 0.4; }
      50% { opacity: 0.7; }
      100% { opacity: 0.4; }
    }
    body.is-loading .user-profile,
    body.is-loading .hero-dynamic,
    body.is-loading .quick-stats-strip,
    body.is-loading .action-cards,
    body.is-loading .explore-grid {
      animation: skeletonPulse 1.5s ease-in-out infinite;
      pointer-events: none;
    }
    body.is-loading .user-profile .profile-header,
    body.is-loading .hero-content,
    body.is-loading .qs-chip .qs-value,
    body.is-loading .qs-chip .qs-label {
      color: transparent;
    }
    body.is-loading .hero-dots { display: none; }

    /* ==================== FLOATING PARTICLES (perfil) ==================== */
    .profile-particles {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 1;
      pointer-events: none;
      overflow: hidden;
    }
    .profile-particles .particle {
      position: absolute;
      width: 3px;
      height: 3px;
      background: rgba(255,192,72,0.4);
      border-radius: 50%;
      animation: particleFloat linear infinite;
    }
    @keyframes particleFloat {
      0% { transform: translateY(0) translateX(0); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-120px) translateX(30px); opacity: 0; }
    }

    /* ==================== SLIDESHOW DE FUNDO DO PERFIL ==================== */
    .profile-bg-slideshow {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 0;
    }

    .profile-bg-slide {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      opacity: 0;
      transition: opacity 1.5s ease-in-out;
    }

    .profile-bg-slide.active {
      opacity: 1;
    }

    .profile-bg-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg, 
        rgba(14, 20, 27, 0.85) 0%, 
        rgba(14, 20, 27, 0.75) 50%,
        rgba(14, 20, 27, 0.9) 100%
      );
      z-index: 1;
    }

    /* Quando tem fotos, escurecer menos para ver as fotos */
    .user-profile.has-bg-photos .profile-bg-overlay {
      background: linear-gradient(
        135deg, 
        rgba(14, 20, 27, 0.65) 0%, 
        rgba(14, 20, 27, 0.45) 50%,
        rgba(14, 20, 27, 0.70) 100%
      );
    }

    .user-profile.has-bg-photos {
      min-height: 190px !important;
    }

    /* Garantir que conte√∫do fique acima do slideshow */
    .user-profile .profile-header,
    .user-profile #levelProgress,
    .user-profile .user-stats {
      position: relative;
      z-index: 2;
    }

    /* Indicador de slides (opcional - mostrar bolinhas) */
    .profile-bg-indicators {
      position: absolute;
      bottom: 10px;
      right: 16px;
      display: flex;
      gap: 6px;
      z-index: 3;
    }

    .profile-bg-indicators .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }

    .profile-bg-indicators .dot.active {
      background: var(--accent-secondary);
      transform: scale(1.2);
    }

    /* ==================== BARRA DE A√á√ÉO R√ÅPIDA ==================== */
    .quick-action-bar {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      padding: 16px;
      background: linear-gradient(135deg, rgba(255, 159, 67, 0.12) 0%, rgba(255, 71, 87, 0.08) 100%);
      border: 1px solid rgba(255, 159, 67, 0.25);
      border-radius: 16px;
      align-items: center;
    }

    .quick-action-icon {
      font-size: 2em;
      animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    .quick-action-content {
      flex: 1;
    }

    .quick-action-title {
      font-weight: 700;
      font-size: 0.95em;
      margin-bottom: 2px;
    }

    .quick-action-desc {
      font-size: 0.8em;
      color: var(--text-secondary);
    }

    .quick-action-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--accent-primary) 0%, #ff8c42 100%);
      border: none;
      border-radius: 12px;
      color: var(--bg-dark);
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 0.85em;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px var(--accent-glow);
    }

    .quick-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px var(--accent-glow);
    }

    /* ==================== STREAK / SEQU√äNCIA ==================== */
    .streak-mini {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      background: linear-gradient(135deg, rgba(255, 159, 67, 0.1), rgba(255, 192, 72, 0.05));
      border: 1px solid rgba(255, 159, 67, 0.2);
      border-radius: 14px;
      margin-bottom: 20px;
    }

    .streak-fire {
      font-size: 1.8em;
      animation: fireGlow 1.5s ease-in-out infinite alternate;
    }

    @keyframes fireGlow {
      from { filter: brightness(1) drop-shadow(0 0 5px rgba(255, 159, 67, 0.3)); }
      to { filter: brightness(1.2) drop-shadow(0 0 15px rgba(255, 159, 67, 0.6)); }
    }

    .streak-info {
      flex: 1;
    }

    .streak-count {
      font-weight: 800;
      font-size: 1.1em;
      color: var(--accent-secondary);
    }

    .streak-label {
      font-size: 0.75em;
      color: var(--text-secondary);
    }

    .streak-bonus {
      padding: 6px 12px;
      background: rgba(46, 213, 115, 0.15);
      border: 1px solid rgba(46, 213, 115, 0.3);
      border-radius: 20px;
      font-size: 0.7em;
      font-weight: 600;
      color: var(--win-green);
    }

    /* ==================== ONLINE / COMUNIDADE ==================== */
    .community-bar {
      display: flex;
      justify-content: center;
      gap: 24px;
      padding: 12px 16px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 24px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .community-stat {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.8em;
    }

    .pulse-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: pulseDot 2s ease-in-out infinite;
    }

    .pulse-dot.online { background: var(--win-green); }
    .pulse-dot.live { background: var(--live-red); }

    @keyframes pulseDot {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.8); }
    }

    .community-stat strong {
      color: var(--accent-secondary);
    }

    /* ==================== CARROSSEL DE DICAS / STORIES ==================== */
    .tips-carousel {
      position: relative;
      margin-bottom: 20px;
      border-radius: 16px;
      overflow: hidden;
      height: 140px;
    }

    .tips-slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 0.5s ease;
      display: flex;
      align-items: center;
      padding: 20px;
      cursor: pointer;
      background-size: cover;
      background-position: center;
    }

    .tips-slide.active {
      opacity: 1;
    }

    .tips-slide::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(10, 14, 19, 0.85) 0%, rgba(10, 14, 19, 0.7) 100%);
    }

    .tips-slide-content {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      gap: 16px;
      width: 100%;
    }

    .tips-icon {
      font-size: 3em;
      flex-shrink: 0;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
    }

    .tips-text {
      flex: 1;
    }

    .tips-title {
      font-size: 1.1em;
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--text-primary);
    }

    .tips-desc {
      font-size: 0.85em;
      color: var(--text-secondary);
      line-height: 1.4;
    }

    .tips-badge {
      padding: 6px 14px;
      background: var(--accent-primary);
      color: var(--bg-dark);
      border-radius: 20px;
      font-size: 0.75em;
      font-weight: 700;
      white-space: nowrap;
    }

    /* Indicadores do carrossel */
    .tips-indicators {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 6px;
      z-index: 2;
    }

    .tips-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .tips-dot.active {
      background: var(--accent-primary);
      width: 24px;
      border-radius: 4px;
    }

    /* Barra de progresso autom√°tico */
    .tips-progress {
      position: absolute;
      top: 0;
      left: 0;
      height: 3px;
      background: var(--accent-primary);
      width: 0%;
      z-index: 3;
    }

    .tips-slide.active .tips-progress-active {
      animation: progressBar 5s linear forwards;
    }

    @keyframes progressBar {
      from { width: 0%; }
      to { width: 100%; }
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 25px;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffb547 0%, #ff8c42 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2em;
      font-weight: 800;
      color: #0e141b;
    }

    .profile-info h2 {
      font-size: 1.5em;
      margin-bottom: 5px;
    }

    .level-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .profile-team {
      color: #a9b5c6;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .user-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    .stat-card {
      background: rgba(0, 0, 0, 0.3);
      padding: 14px 10px;
      border-radius: 14px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid transparent;
    }

    .stat-card:hover {
      background: rgba(255, 159, 67, 0.1);
      border-color: rgba(255, 159, 67, 0.3);
      transform: translateY(-2px);
    }

    .stat-card:active {
      transform: scale(0.97);
    }

    .stat-value {
      font-size: 1.5em;
      font-weight: 800;
      color: var(--accent-secondary);
      line-height: 1.2;
    }

    .stat-label {
      font-size: 0.7em;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    /* ==================== SE√á√ÉO DE JOGOS ==================== */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .section-title {
      font-size: 1.4em;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-count {
      font-size: 0.9em;
      color: #a9b5c6;
    }

    /* ==================== SCROLL HORIZONTAL DE JOGOS ==================== */
    .games-scroll {
      display: flex;
      gap: 16px;
      overflow-x: auto;
      overflow-y: hidden;
      padding-bottom: 12px;
      margin-bottom: 30px;
      scroll-snap-type: x proximity;
      -webkit-overflow-scrolling: touch;
    }

    /* Scrollbar estilizada */
    .games-scroll::-webkit-scrollbar {
      height: 6px;
    }

    .games-scroll::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }

    .games-scroll::-webkit-scrollbar-thumb {
      background: rgba(255, 181, 71, 0.3);
      border-radius: 3px;
    }

    .games-scroll::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 181, 71, 0.5);
    }

    .games-scroll .empty-state {
      min-width: 100%;
    }

    /* ==================== CARD DO JOGO - REDESIGN MODERNO ==================== */
    .game-card {
      background: var(--bg-card);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px;
      padding: 0;
      transition: all 0.3s ease;
      min-width: 280px;
      max-width: 300px;
      flex-shrink: 0;
      scroll-snap-align: start;
      overflow: hidden;
      position: relative;
    }

    .game-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      border-color: rgba(255, 159, 67, 0.25);
    }

    .game-card:active {
      transform: scale(0.98);
    }

    /* Header do card com status */
    .game-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 14px;
      background: rgba(0, 0, 0, 0.3);
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .game-league {
      font-size: 0.7em;
      color: var(--text-secondary);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .game-league-icon {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.1);
    }

    .game-status {
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.65em;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .status-live {
      background: var(--live-red);
      animation: pulse-live 2s ease-in-out infinite;
      box-shadow: 0 0 15px rgba(255, 71, 87, 0.4);
    }

    .status-live::before {
      content: '';
      width: 5px;
      height: 5px;
      background: white;
      border-radius: 50%;
      animation: blink 1s ease-in-out infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .status-scheduled {
      background: rgba(59, 130, 246, 0.2);
      color: #60a5fa;
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .status-finished {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-secondary);
    }

    /* Corpo do card - Times lado a lado */
    .game-card-body {
      padding: 16px;
    }

    .game-matchup {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 14px;
    }

    .game-team {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      flex: 1;
      gap: 8px;
    }

    .game-team-jersey {
      width: 44px;
      height: 52px;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
      display: inline-block;
    }
    .game-team-jersey .jersey-real { width: 100%; height: 100%; }

    /* Jersey real - global */
    .jersey-real { position: relative; display: inline-block; }
    .jersey-real img { width: 100%; height: 100%; object-fit: contain; display: block; }

    .game-team-name {
      font-size: 0.8em;
      font-weight: 600;
      color: var(--text-primary);
      max-width: 90px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .game-team.winner .game-team-name {
      color: var(--win-green);
    }

    /* Info central (sem placar) */
    .game-center-info {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 0 10px;
      min-width: 70px;
    }

    .game-live-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(255, 71, 87, 0.15);
      border: 1px solid rgba(255, 71, 87, 0.3);
      border-radius: 20px;
      font-size: 0.7em;
      font-weight: 700;
      color: var(--live-red);
      margin-bottom: 4px;
    }

    .live-pulse {
      width: 8px;
      height: 8px;
      background: var(--live-red);
      border-radius: 50%;
      animation: livePulse 1.5s ease-in-out infinite;
    }

    @keyframes livePulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.8); }
    }

    .game-datetime-box {
      text-align: center;
    }

    .game-datetime-box .game-date {
      font-size: 1em;
      font-weight: 700;
      color: var(--text-primary);
    }

    .game-datetime-box .game-hour {
      font-size: 0.85em;
      color: var(--accent-secondary);
      font-weight: 600;
    }

    .game-datetime-box.finished .game-date,
    .game-datetime-box.finished .game-hour {
      color: var(--text-secondary);
    }

    .game-finished-indicator {
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 20px;
      font-size: 0.7em;
      font-weight: 600;
      color: var(--text-secondary);
    }

    /* Placar central (se usado no futuro) */
    .game-score-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0 12px;
    }

    .game-score {
      font-size: 1.6em;
      font-weight: 800;
      letter-spacing: 2px;
      color: var(--text-primary);
    }

    .game-score-divider {
      width: 20px;
      height: 2px;
      background: rgba(255, 255, 255, 0.2);
      margin: 4px 0;
      border-radius: 1px;
    }

    .game-time-info {
      font-size: 0.7em;
      color: var(--text-secondary);
      text-align: center;
    }

    .game-time-info.live {
      color: var(--live-red);
      font-weight: 600;
    }

    /* VS para jogos agendados */
    .game-vs {
      font-size: 1em;
      font-weight: 700;
      color: var(--text-secondary);
      padding: 8px 0;
    }

    .game-datetime {
      text-align: center;
    }

    .game-date {
      font-size: 0.9em;
      font-weight: 700;
      color: var(--text-primary);
    }

    .game-hour {
      font-size: 0.75em;
      color: var(--text-secondary);
    }

    /* ==================== BARRA DE TORCIDA VISUAL ==================== */
    .torcida-section {
      padding: 0 16px 12px;
    }

    .torcida-label {
      font-size: 0.65em;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      text-align: center;
    }

    /* Se√ß√£o de pontos com estilo diferenciado */
    .pontos-section {
      margin-top: 4px;
      padding-top: 10px;
      border-top: 1px dashed rgba(255,255,255,0.08);
    }

    .pontos-section .torcida-label {
      color: var(--accent-secondary);
    }

    .torcida-visual {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .torcida-side {
      display: flex;
      align-items: center;
      gap: 6px;
      flex: 1;
    }

    .torcida-side.left {
      justify-content: flex-end;
    }

    .torcida-side.right {
      justify-content: flex-start;
    }

    .torcida-percent {
      font-size: 0.85em;
      font-weight: 700;
      min-width: 36px;
    }

    .torcida-side.left .torcida-percent {
      text-align: right;
    }

    .torcida-side.right .torcida-percent {
      text-align: left;
    }

    .torcida-bar-container {
      flex: 1;
      height: 8px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 4px;
      overflow: hidden;
      display: flex;
    }

    .torcida-bar-fill {
      height: 100%;
      transition: width 0.5s ease;
      position: relative;
    }

    .torcida-bar-fill.left {
      border-radius: 4px 0 0 4px;
    }

    .torcida-bar-fill.right {
      border-radius: 0 4px 4px 0;
    }

    /* Efeito de brilho na barra de quem est√° ganhando */
    .torcida-bar-fill.winning {
      box-shadow: 0 0 10px currentColor;
    }

    .torcida-bar-fill.winning::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shimmerBar 2s infinite;
    }

    /* ==================== CR√âDITOS EM DISPUTA ==================== */
    .creditos-disputa {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px 16px;
      margin: 0 16px 12px;
      background: linear-gradient(135deg, rgba(255, 159, 67, 0.12), rgba(255, 192, 72, 0.06));
      border: 1px solid rgba(255, 159, 67, 0.25);
      border-radius: 10px;
    }

    .creditos-icon {
      font-size: 1.1em;
    }

    .creditos-valor {
      font-size: 1.2em;
      font-weight: 800;
      color: var(--accent-secondary);
    }

    .creditos-label {
      font-size: 0.75em;
      color: var(--text-secondary);
    }

    /* Destaque maior quando tem muitos cr√©ditos */
    .creditos-disputa.high-value {
      background: linear-gradient(135deg, rgba(255, 159, 67, 0.2), rgba(255, 192, 72, 0.1));
      border-color: rgba(255, 159, 67, 0.4);
      animation: creditsPulse 2s ease-in-out infinite;
    }

    @keyframes creditsPulse {
      0%, 100% { box-shadow: 0 0 0 rgba(255, 159, 67, 0); }
      50% { box-shadow: 0 0 15px rgba(255, 159, 67, 0.2); }
    }

    /* Badge "Voc√™ torceu" */
    .user-cheered {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 8px 12px;
      margin: 0 16px 12px;
      background: linear-gradient(135deg, rgba(46, 213, 115, 0.15), rgba(46, 213, 115, 0.05));
      border: 1px solid rgba(46, 213, 115, 0.3);
      border-radius: 10px;
      font-size: 0.75em;
      font-weight: 600;
      color: var(--win-green);
    }

    .user-cheered-jersey {
      width: 18px;
      height: 22px;
      display: inline-block;
    }
    .user-cheered-jersey .jersey-real { width: 100%; height: 100%; }

    /* ==================== BOT√ÉO DE A√á√ÉO DO CARD ==================== */
    .game-card-action {
      padding: 12px 16px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }

    .btn-game {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 0.85em;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-game:active {
      transform: scale(0.97);
    }

    .btn-game.primary {
      background: linear-gradient(135deg, var(--accent-primary) 0%, #ff8c42 100%);
      color: var(--bg-dark);
      box-shadow: 0 4px 15px var(--accent-glow);
    }

    .btn-game.secondary {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text-primary);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn-game.live {
      background: linear-gradient(135deg, var(--live-red) 0%, #ff6b81 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3);
      animation: btnPulse 2s ease-in-out infinite;
    }

    @keyframes btnPulse {
      0%, 100% { box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3); }
      50% { box-shadow: 0 4px 25px rgba(255, 71, 87, 0.5); }
    }

    /* Card de jogo AO VIVO - super destaque */
    .game-card.is-live {
      border: 2px solid rgba(255, 71, 87, 0.4);
      box-shadow: 0 0 25px rgba(255, 71, 87, 0.15);
    }

    .game-card.is-live .game-card-header {
      background: linear-gradient(135deg, rgba(255, 71, 87, 0.15), rgba(255, 71, 87, 0.05));
    }

    /* Card quando √© o time do cora√ß√£o */
    .game-card.my-team-playing {
      border-color: rgba(255, 159, 67, 0.4);
    }

    .game-card.my-team-playing::before {
      content: 'üíõ SEU TIME';
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 3px 8px;
      background: var(--accent-primary);
      color: var(--bg-dark);
      font-size: 0.55em;
      font-weight: 700;
      border-radius: 8px;
      z-index: 2;
    }

    /* Indicador "arraste para ver mais" */
    .scroll-hint {
      display: none;
      align-items: center;
      gap: 6px;
      font-size: 0.75em;
      color: #a9b5c6;
      margin-left: auto;
    }

    .scroll-hint .arrow {
      display: inline-block;
      animation: scrollArrow 1.5s ease-in-out infinite;
    }

    @keyframes scrollArrow {
      0%, 100% { transform: translateX(0); opacity: 0.5; }
      50% { transform: translateX(5px); opacity: 1; }
    }

    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .game-teams {
      flex: 1;
    }

    .team-name {
      font-weight: 600;
      font-size: 1.1em;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Camiseta mini */
    .jersey-mini {
      width: 24px;
      height: 28px;
      display: inline-block;
      vertical-align: middle;
    }
    .jersey-mini .jersey-real { width: 100%; height: 100%; }

    .vs {
      color: #a9b5c6;
      font-size: 0.85em;
      margin: 5px 0;
    }

    .game-status {
      padding: 6px 14px;
      border-radius: 50px;
      font-size: 0.7em;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-live {
      background: linear-gradient(135deg, var(--live-red) 0%, #ff6b81 100%);
      animation: pulse-live 2s ease-in-out infinite;
      box-shadow: 0 0 20px rgba(255, 71, 87, 0.5);
    }

    .status-live::before {
      content: '';
      width: 6px;
      height: 6px;
      background: white;
      border-radius: 50%;
      animation: blink 1s ease-in-out infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    @keyframes pulse-live {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.05); }
    }

    .game-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
    }

    .info-item {
      text-align: center;
    }

    .info-label {
      font-size: 0.75em;
      color: #a9b5c6;
      margin-bottom: 3px;
    }

    .info-value {
      font-weight: 600;
      color: #e7eef7;
    }

    /* TORCIDA */
    .torcida {
      margin-bottom: 15px;
    }

    .torcida-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.85em;
    }

    .torcida-bar {
      height: 8px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 50px;
      overflow: hidden;
      display: flex;
      width: 100%;
    }

    .torcida-fill-a {
      transition: width 0.5s ease;
      flex-shrink: 0;
      height: 100%;
    }

    .torcida-fill-b {
      transition: width 0.5s ease;
      flex-shrink: 0;
      height: 100%;
    }

    /* BADGE DE TIME ESCOLHIDO */
    .team-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 8px 15px;
      background: linear-gradient(135deg, rgba(46, 204, 113, 0.2), rgba(39, 174, 96, 0.2));
      border: 2px solid #2ecc71;
      border-radius: 50px;
      font-size: 0.85em;
      font-weight: 600;
      color: #2ecc71;
      margin-bottom: 15px;
    }

    /* BOT√ïES DE A√á√ÉO */
    .game-actions {
      display: flex;
      gap: 10px;
    }

    .btn-action {
      flex: 1;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95em;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-primary) 0%, #ff8c42 100%);
      color: var(--bg-dark);
      box-shadow: 0 4px 15px var(--accent-glow);
      font-weight: 700;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px var(--accent-glow);
    }

    .btn-primary:active {
      transform: scale(0.97);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.25);
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
    }

    .btn-secondary:active {
      transform: scale(0.97);
    }

    /* ==================== MODAL DE ESCOLHA ==================== */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: linear-gradient(135deg, #1e2936 0%, #18222e 100%);
      border-radius: 20px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      border: 1px solid rgba(255, 255, 255, 0.1);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      text-align: center;
      margin-bottom: 25px;
    }

    .modal-header h2 {
      font-size: 1.5em;
      margin-bottom: 10px;
    }

    .modal-header p {
      color: #a9b5c6;
    }

    .team-options {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .team-option {
      flex: 1;
      padding: 20px;
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .team-option:hover {
      border-color: #ffb547;
      background: rgba(255, 181, 71, 0.1);
    }

    .team-option .jersey-modal {
      width: 60px;
      height: 70px;
      margin: 0 auto 15px;
      display: block;
    }
    .team-option .jersey-modal .jersey-real { width: 100%; height: 100%; }

    .team-option .team-name-modal {
      font-weight: 600;
      font-size: 1.1em;
    }

    .modal-warning {
      text-align: center;
      padding: 15px;
      background: rgba(231, 76, 60, 0.1);
      border: 1px solid rgba(231, 76, 60, 0.3);
      border-radius: 10px;
      margin-bottom: 20px;
      color: #e74c3c;
      font-size: 0.9em;
    }

    .modal-actions {
      display: flex;
      justify-content: center;
    }

    .btn-cancel {
      padding: 12px 30px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      color: #a9b5c6;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      transition: all 0.3s ease;
    }

    .btn-cancel:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* EMPTY STATE */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #a9b5c6;
    }

    .empty-icon {
      font-size: 4em;
      margin-bottom: 20px;
    }

    /* TOAST */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 15px 30px;
      border-radius: 50px;
      font-weight: 600;
      z-index: 2000;
      opacity: 0;
      transition: all 0.3s ease;
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* BOTTOM NAV */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(14, 20, 27, 0.98);
      backdrop-filter: blur(20px);
      padding: 10px 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 99;
    }

    .nav-content {
      max-width: 600px;
      margin: 0 auto;
      display: flex;
      justify-content: space-around;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      color: #a9b5c6;
      text-decoration: none;
      font-size: 0.75em;
      transition: all 0.3s ease;
      padding: 5px 10px;
    }

    .nav-item:hover, .nav-item.active {
      color: #ffb547;
    }

    .nav-icon {
      font-size: 1.5em;
    }

    /* Nav Cr√©ditos destaque */
    .nav-item.nav-creditos {
      position: relative;
      color: #ffaa32;
    }

    .nav-item.nav-creditos .nav-icon {
      background: linear-gradient(135deg, #ff6b35, #ffaa32);
      width: 38px;
      height: 38px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: -18px;
      box-shadow: 0 4px 16px rgba(255, 107, 53, 0.4);
      animation: navCreditoPulse 3s ease infinite;
      font-size: 1.2em;
    }

    .nav-creditos-saldo {
      font-size: 0.7em;
      font-weight: 700;
      color: #ffaa32;
      margin-top: 1px;
    }

    @keyframes navCreditoPulse {
      0%, 100% { box-shadow: 0 4px 16px rgba(255, 107, 53, 0.35); }
      50% { box-shadow: 0 4px 22px rgba(255, 107, 53, 0.6); }
    }

    /* ==================== QUIZ DI√ÅRIO DO TIME DO CORA√á√ÉO ==================== */
    .quiz-diario-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(8px);
    }

    .quiz-diario-overlay.active {
      display: flex;
    }

    .quiz-diario-card {
      background: linear-gradient(135deg, #1e2936 0%, #18222e 100%);
      border-radius: 24px;
      padding: 0;
      max-width: 480px;
      width: 92%;
      border: 1px solid rgba(255, 181, 71, 0.3);
      animation: quizSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(255, 181, 71, 0.1);
    }

    @keyframes quizSlideIn {
      from {
        opacity: 0;
        transform: translateY(60px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .quiz-diario-banner {
      background: linear-gradient(135deg, #ffb547 0%, #ff8c42 100%);
      padding: 20px 25px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .quiz-diario-banner::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 60%);
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% { transform: translateX(-30%) translateY(-30%); }
      50% { transform: translateX(30%) translateY(30%); }
    }

    .quiz-diario-banner h2 {
      color: #0e141b;
      font-size: 1.3em;
      font-weight: 800;
      position: relative;
      z-index: 1;
    }

    .quiz-diario-banner p {
      color: rgba(14, 20, 27, 0.7);
      font-size: 0.85em;
      margin-top: 4px;
      position: relative;
      z-index: 1;
    }

    .quiz-diario-body {
      padding: 25px;
    }

    /* Step: Convite */
    .quiz-step-convite {
      text-align: center;
    }

    .quiz-step-convite .quiz-team-info {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin: 15px 0 20px;
      padding: 12px 20px;
      background: rgba(255, 181, 71, 0.1);
      border: 1px solid rgba(255, 181, 71, 0.2);
      border-radius: 12px;
    }

    .quiz-step-convite .quiz-team-info .jersey-quiz {
      width: 40px;
      height: 48px;
      display: inline-block;
    }
    .quiz-step-convite .jersey-quiz .jersey-real { width: 100%; height: 100%; }

    .quiz-step-convite .quiz-team-name {
      font-weight: 700;
      font-size: 1.1em;
      color: #ffb547;
    }

    .quiz-step-convite p {
      color: #a9b5c6;
      font-size: 0.9em;
      line-height: 1.5;
      margin-bottom: 20px;
    }

    .quiz-convite-btns {
      display: flex;
      gap: 12px;
    }

    .quiz-convite-btns button {
      flex: 1;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-weight: 700;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95em;
      transition: all 0.3s ease;
    }

    .btn-quiz-sim {
      background: linear-gradient(135deg, #ffb547 0%, #ff8c42 100%);
      color: #0e141b;
      box-shadow: 0 4px 15px rgba(255, 181, 71, 0.3);
    }

    .btn-quiz-sim:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 181, 71, 0.5);
    }

    .btn-quiz-nao {
      background: rgba(255, 255, 255, 0.08);
      color: #a9b5c6;
      border: 1px solid rgba(255, 255, 255, 0.15) !important;
    }

    .btn-quiz-nao:hover {
      background: rgba(255, 255, 255, 0.15);
      color: #e7eef7;
    }

    /* Step: Pergunta */
    .quiz-step-pergunta {
      display: none;
    }

    .quiz-pergunta-texto {
      font-size: 1.05em;
      font-weight: 600;
      color: #e7eef7;
      line-height: 1.5;
      margin-bottom: 20px;
      text-align: center;
    }

    .quiz-xp-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 12px;
      background: rgba(255, 181, 71, 0.15);
      border: 1px solid rgba(255, 181, 71, 0.3);
      border-radius: 20px;
      font-size: 0.75em;
      font-weight: 700;
      color: #ffb547;
      margin-bottom: 15px;
    }

    .quiz-alternativas {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .quiz-alt-btn {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      background: rgba(0, 0, 0, 0.25);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      font-family: 'Poppins', sans-serif;
      color: #e7eef7;
      font-size: 0.9em;
      width: 100%;
    }

    .quiz-alt-btn:hover:not(.disabled) {
      border-color: rgba(255, 181, 71, 0.5);
      background: rgba(255, 181, 71, 0.08);
      transform: translateX(4px);
    }

    .quiz-alt-btn .alt-letra {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 0.85em;
      flex-shrink: 0;
      transition: all 0.3s ease;
    }

    .quiz-alt-btn.correta {
      border-color: #2ecc71 !important;
      background: rgba(46, 204, 113, 0.15) !important;
      animation: pulseCorrect 0.5s ease;
    }

    .quiz-alt-btn.correta .alt-letra {
      background: #2ecc71;
      color: #fff;
    }

    .quiz-alt-btn.errada {
      border-color: #e74c3c !important;
      background: rgba(231, 76, 60, 0.15) !important;
      animation: shakeWrong 0.5s ease;
    }

    .quiz-alt-btn.errada .alt-letra {
      background: #e74c3c;
      color: #fff;
    }

    .quiz-alt-btn.disabled {
      cursor: default;
      opacity: 0.5;
    }

    .quiz-alt-btn.disabled:not(.correta):not(.errada) {
      opacity: 0.35;
    }

    @keyframes pulseCorrect {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }

    @keyframes shakeWrong {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }

    /* Step: Resultado */
    .quiz-step-resultado {
      display: none;
      text-align: center;
    }

    .quiz-resultado-icon {
      font-size: 4em;
      margin-bottom: 10px;
      animation: bounceIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes bounceIn {
      from { transform: scale(0); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .quiz-resultado-titulo {
      font-size: 1.4em;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .quiz-resultado-titulo.acertou {
      color: #2ecc71;
    }

    .quiz-resultado-titulo.errou {
      color: #e74c3c;
    }

    .quiz-resultado-msg {
      color: #a9b5c6;
      font-size: 0.9em;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .quiz-xp-ganho {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 24px;
      background: linear-gradient(135deg, rgba(255, 181, 71, 0.2), rgba(255, 140, 66, 0.1));
      border: 2px solid rgba(255, 181, 71, 0.4);
      border-radius: 50px;
      font-weight: 800;
      font-size: 1.2em;
      color: #ffb547;
      margin-bottom: 20px;
      animation: bounceIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s both;
    }

    .btn-quiz-fechar {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-weight: 700;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95em;
      background: linear-gradient(135deg, #ffb547 0%, #ff8c42 100%);
      color: #0e141b;
      transition: all 0.3s ease;
    }

    .btn-quiz-fechar:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 181, 71, 0.5);
    }

    /* ==================== FIM QUIZ DI√ÅRIO ==================== */

    /* ==================== BANNER INSTAGRAM (INLINE) ==================== */
    .instagram-banner {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 16px 24px;
      margin: 30px 0 10px;
      background: linear-gradient(135deg, rgba(240, 148, 51, 0.1) 0%, rgba(225, 48, 108, 0.1) 50%, rgba(188, 24, 136, 0.1) 100%);
      border: 1px solid rgba(225, 48, 108, 0.25);
      border-radius: 14px;
      text-decoration: none;
      color: #e7eef7;
      transition: all 0.3s ease;
    }

    .instagram-banner:hover {
      border-color: rgba(225, 48, 108, 0.5);
      background: linear-gradient(135deg, rgba(240, 148, 51, 0.15) 0%, rgba(225, 48, 108, 0.15) 50%, rgba(188, 24, 136, 0.15) 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(225, 48, 108, 0.2);
    }

    .instagram-banner .insta-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .instagram-banner .insta-icon svg {
      width: 18px;
      height: 18px;
      fill: white;
    }

    .instagram-banner .insta-text {
      font-size: 0.9em;
      font-weight: 600;
    }

    .instagram-banner .insta-text span {
      color: #a9b5c6;
      font-weight: 400;
      font-size: 0.85em;
    }

    /* ===== ONBOARDING ===== */
    .onboarding-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.92);
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(12px);
    }
    .onboarding-overlay.active { display: flex; }

    .onboarding-container {
      width: 100%;
      max-width: 420px;
      max-height: 90vh;
      padding: 0 16px;
      position: relative;
    }

    .onboarding-card {
      background: linear-gradient(180deg, #1a2332 0%, #0e141b 100%);
      border: 1px solid rgba(255,181,71,0.15);
      border-radius: 24px;
      overflow: hidden;
      position: relative;
    }

    .onb-slide {
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 32px 24px 24px;
      text-align: center;
      animation: onbFadeIn 0.5s ease;
      min-height: 480px;
    }
    .onb-slide.active { display: flex; }

    @keyframes onbFadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .onb-illustration {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3.5em;
      margin-bottom: 20px;
      position: relative;
      animation: onbFloat 3s ease-in-out infinite;
    }
    @keyframes onbFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    .onb-title {
      font-family: 'Orbitron', monospace;
      font-weight: 800;
      font-size: 1.15em;
      margin-bottom: 8px;
      color: #fff;
    }

    .onb-subtitle {
      font-size: 0.9em;
      color: var(--accent);
      font-weight: 600;
      margin-bottom: 14px;
    }

    .onb-desc {
      font-size: 0.85em;
      color: #a9b5c6;
      line-height: 1.6;
      margin-bottom: 20px;
      max-width: 320px;
    }
    .onb-desc strong { color: #e7eef7; }

    .onb-features {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      width: 100%;
      margin-bottom: 20px;
    }
    .onb-feat {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 12px;
      padding: 12px 10px;
      text-align: center;
    }
    .onb-feat-icon { font-size: 1.5em; margin-bottom: 4px; }
    .onb-feat-label { font-size: 0.72em; color: #a9b5c6; font-weight: 600; }

    .onb-dots {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-bottom: 16px;
    }
    .onb-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      transition: 0.3s;
    }
    .onb-dot.active {
      background: var(--accent);
      width: 24px;
      border-radius: 4px;
    }

    .onb-actions {
      display: flex;
      gap: 10px;
      width: 100%;
      padding: 0 24px 24px;
    }
    .onb-btn-skip {
      flex: 1;
      background: transparent;
      border: 1px solid rgba(255,255,255,0.15);
      color: #a9b5c6;
      padding: 14px;
      border-radius: 14px;
      font-family: inherit;
      font-size: 0.85em;
      font-weight: 600;
      cursor: pointer;
    }
    .onb-btn-next {
      flex: 2;
      background: linear-gradient(135deg, #ffb547, #ff8c42);
      border: none;
      color: #000;
      padding: 14px;
      border-radius: 14px;
      font-family: inherit;
      font-size: 0.9em;
      font-weight: 700;
      cursor: pointer;
      transition: 0.2s;
    }
    .onb-btn-next:hover { transform: scale(1.02); }

    .onb-confetti {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      overflow: hidden;
    }
    .confetti-piece {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 2px;
      animation: confettiFall 3s ease-in-out infinite;
    }
    @keyframes confettiFall {
      0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(500px) rotate(720deg); opacity: 0; }
    }

    /* ===== MODAL PASSE / LIMITE ===== */
    .passe-modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.85);
      z-index: 9998;
      display: none;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    }
    .passe-modal-overlay.active { display: flex; }

    .passe-modal {
      background: linear-gradient(180deg, #1a2332, #0e141b);
      border: 1px solid rgba(255,181,71,0.2);
      border-radius: 20px;
      max-width: 380px;
      width: 90%;
      padding: 28px 24px;
      text-align: center;
    }
    .passe-modal-icon { font-size: 3em; margin-bottom: 12px; }
    .passe-modal-title {
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      font-size: 1.1em;
      margin-bottom: 8px;
    }
    .passe-modal-desc {
      font-size: 0.85em;
      color: #a9b5c6;
      line-height: 1.6;
      margin-bottom: 16px;
    }
    .passe-modal-desc strong { color: #e7eef7; }

    .passe-modal-counter {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 16px;
    }
    .passe-counter-dot {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9em;
      font-weight: 700;
    }
    .passe-counter-dot.used {
      background: rgba(239,68,68,0.2);
      border: 2px solid #ef4444;
      color: #ef4444;
    }
    .passe-counter-dot.free {
      background: rgba(16,185,129,0.15);
      border: 2px dashed rgba(16,185,129,0.4);
      color: #10b981;
    }

    .passe-modal-badge {
      display: inline-block;
      background: rgba(255,181,71,0.15);
      border: 1px solid rgba(255,181,71,0.3);
      color: var(--accent);
      padding: 6px 14px;
      border-radius: 10px;
      font-size: 0.75em;
      font-weight: 700;
      margin-bottom: 16px;
    }

    .passe-modal-btns {
      display: flex;
      gap: 10px;
    }
    .passe-btn-fechar {
      flex: 1;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      color: #a9b5c6;
      padding: 12px;
      border-radius: 12px;
      font-family: inherit;
      font-size: 0.85em;
      font-weight: 600;
      cursor: pointer;
    }
    .passe-btn-upgrade {
      flex: 2;
      background: linear-gradient(135deg, #ffb547, #ff8c42);
      border: none;
      color: #000;
      padding: 12px;
      border-radius: 12px;
      font-family: inherit;
      font-size: 0.9em;
      font-weight: 700;
      cursor: pointer;
    }

    .passe-expirado-banner {
      background: linear-gradient(135deg, rgba(239,68,68,0.12), rgba(220,38,38,0.05));
      border: 1px solid rgba(239,68,68,0.25);
      border-radius: 14px;
      padding: 14px 18px;
      margin-bottom: 20px;
      display: none;
      align-items: center;
      gap: 12px;
      cursor: pointer;
    }
    .passe-expirado-banner.show { display: flex; }
    .passe-expirado-banner .icon { font-size: 1.5em; }
    .passe-expirado-banner .info { flex: 1; }
    .passe-expirado-banner .title { font-weight: 700; font-size: 0.85em; color: #f87171; }
    .passe-expirado-banner .desc { font-size: 0.75em; color: #a9b5c6; }
    .passe-expirado-banner .action { color: var(--accent); font-weight: 700; font-size: 0.8em; }

    /* RESPONSIVO */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: row;
        gap: 10px;
      }

      .user-menu {
        gap: 8px;
      }

      .user-name {
        display: none;
      }

      .btn-logout {
        padding: 6px 12px;
        font-size: 0.85em;
      }

      .container {
        padding: 16px 12px;
      }

      .user-profile {
        padding: 18px 14px;
      }

      .game-card {
        min-width: 270px;
        max-width: 290px;
      }

      /* Cr√©ditos em disputa mobile */
      .creditos-disputa {
        padding: 8px 12px;
        margin: 0 12px 10px;
      }

      .creditos-valor {
        font-size: 1.1em;
      }

      .creditos-label {
        font-size: 0.7em;
      }

      .team-options {
        flex-direction: column;
      }

      .user-stats {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }

      .stat-card {
        padding: 12px 6px;
      }

      .stat-value {
        font-size: 1.2em;
      }

      .stat-label {
        font-size: 0.65em;
      }

      .quick-action-bar {
        flex-wrap: wrap;
      }

      .quick-action-btn {
        width: 100%;
        margin-top: 10px;
      }

      /* Hero mobile */
      .hero-dynamic { min-height: 120px; }
      .hero-dynamic .hero-content { padding: 18px; gap: 14px; }
      .hero-emoji { font-size: 2.5em; }
      .hero-title { font-size: 1.05em; }
      .hero-subtitle { font-size: 0.78em; }
      .hero-dots { bottom: 8px; }

      /* Action cards mobile */
      .action-cards { gap: 10px; }
      .action-card { min-height: 115px; padding: 18px 14px; }
      .action-card .ac-icon img { width: 44px; height: 44px; }
      .action-card .ac-title { font-size: 0.9em; }
      .action-card .ac-deco { width: 60px; height: 60px; }

      /* Explore grid mobile */
      .explore-grid { gap: 8px; }
      .explore-card { padding: 14px 8px; }
      .explore-card .ec-icon img { width: 30px; height: 30px; }

      /* Carrossel no mobile */
      .tips-carousel {
        height: 130px;
        border-radius: 14px;
      }

      .tips-slide {
        padding: 16px;
      }

      .tips-icon {
        font-size: 2.2em;
      }

      .tips-title {
        font-size: 1em;
      }

      .tips-desc {
        font-size: 0.75em;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .tips-badge {
        padding: 5px 10px;
        font-size: 0.7em;
      }

      .community-bar {
        gap: 16px;
      }

      .community-stat {
        font-size: 0.75em;
      }

      .streak-mini {
        padding: 12px 14px;
      }

      .streak-count {
        font-size: 1em;
      }
    }

    @media (max-width: 380px) {
      .action-cards {
        grid-template-columns: 1fr 1fr;
        gap: 8px;
      }

      .action-card { min-height: 100px; padding: 14px 12px; }
      .action-card .ac-icon img { width: 36px; height: 36px; }
      .action-card .ac-title { font-size: 0.82em; }

      .explore-grid { grid-template-columns: repeat(3, 1fr); gap: 6px; }
      .explore-card { padding: 12px 6px; }
      .explore-card .ec-icon img { width: 26px; height: 26px; }
      .explore-card .ec-title { font-size: 0.65em; }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header-content">
      <div class="logo"><img src="/icons/logo-yellup.png" alt="Yellup"></div>
      <div class="user-menu">
        <a href="notificacoes.html" class="btn-notif" id="btnNotif" style="
          position: relative;
          padding: 8px;
          margin-right: 10px;
          font-size: 1.3em;
          text-decoration: none;
        ">
          üîî
          <span id="notifBadge" style="
            position: absolute;
            top: 0;
            right: 0;
            background: #ef4444;
            color: #fff;
            font-size: 0.5em;
            padding: 2px 5px;
            border-radius: 10px;
            display: none;
          ">0</span>
        </a>
        <div class="user-avatar" id="userAvatar">U</div>
        <span class="user-name" id="userName">Usu√°rio</span>
        <button class="btn-logout" onclick="logout()">Sair</button>
      </div>
    </div>
  </header>

  <!-- CONTAINER PRINCIPAL -->
  <div class="container">
    
    <!-- PERFIL COM FOTOS DE FUNDO -->
    <div class="user-profile anim-in" id="userProfileCard" style="padding:0;min-height:180px;">
      <!-- Slideshow de Fundo Personalizado -->
      <div class="profile-bg-slideshow" id="profileBgSlideshow">
        <div class="profile-bg-slide active" id="bgSlide1"></div>
        <div class="profile-bg-slide" id="bgSlide2"></div>
        <div class="profile-bg-slide" id="bgSlide3"></div>
        <div class="profile-bg-overlay"></div>
      </div>
      <!-- Floating particles -->
      <div class="profile-particles" id="profileParticles"></div>
      
      <div style="position:relative;z-index:2;padding:20px 20px 16px;">
        <div class="profile-header" style="display:flex;align-items:center;gap:14px;margin-bottom:12px;">
          <div class="profile-avatar" id="profileAvatar" style="width:58px;height:58px;border-radius:50%;font-size:1.5em;flex-shrink:0;border:2px solid rgba(255,159,67,0.4);">U</div>
          <div style="flex:1;min-width:0;">
            <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
              <h2 id="profileName" style="font-size:1.2em;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-shadow:0 2px 8px rgba(0,0,0,0.5);">Usu√°rio</h2>
              <div id="profileLevel" style="display:inline-flex;"></div>
            </div>
            <div class="profile-team" style="margin-top:4px;">
              <span id="profileTeamJersey"></span>
              <span id="profileTeam" style="font-size:0.8em;text-shadow:0 1px 4px rgba(0,0,0,0.5);">Carregando...</span>
            </div>
          </div>
          <a href="editar-perfil.html" style="background:rgba(255,255,255,0.12);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,0.2);padding:8px 14px;border-radius:10px;color:rgba(255,255,255,0.9);text-decoration:none;font-size:0.75em;font-weight:600;flex-shrink:0;transition:all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='rgba(255,255,255,0.12)'">‚úèÔ∏è Perfil</a>
        </div>
        <div id="levelProgress" style="margin-bottom:0;"></div>
      </div>
    </div>

    <!-- QUICK STATS STRIP -->
    <div class="quick-stats-strip anim-in anim-d1">
      <div class="qs-chip" onclick="window.location.href='historico.html'">
        <span class="qs-icon">üíé</span>
        <span class="qs-value" id="statCredits">0</span>
        <span class="qs-label">cr√©ditos</span>
      </div>
      <div class="qs-chip" onclick="window.location.href='evolucao.html'">
        <span class="qs-icon">‚≠ê</span>
        <span class="qs-value" id="statXP">0</span>
        <span class="qs-label">XP</span>
      </div>
      <div class="qs-chip" onclick="window.location.href='ranking-geral.html'">
        <span class="qs-icon">üéÆ</span>
        <span class="qs-value" id="statGames">0</span>
        <span class="qs-label">jogos</span>
      </div>
      <div class="qs-chip streak" id="streakChip" style="display:none;">
        <span class="qs-icon">üî•</span>
        <span class="qs-value" id="streakChipValue">0</span>
        <span class="qs-label">dias</span>
      </div>
      <a href="loja-passes.html" class="qs-chip" id="passeChip">
        <span class="qs-icon">üé´</span>
        <span class="qs-value" id="statFree" style="font-size:0.75em;">Free</span>
      </a>
    </div>

    <!-- BARRA ONLINE + CTA -->
    <div class="online-bar anim-in anim-d1" id="onlineBar">
      <div class="online-dot"></div>
      <span class="online-count" id="onlineCount">...</span>
      <span class="online-text">torcedores online</span>
      <span class="online-cta" onclick="window.location.href='embates-pvp.html'">Jogar agora ‚Üí</span>
    </div>

    <!-- HERO DIN√ÇMICO (substituiu carrossel + quick action + community bar + streak) -->
    <div class="hero-dynamic anim-in anim-d2" id="heroDynamic" onclick="heroAction()">
      <div class="hero-bg" id="heroBg" style="background-image:url('https://images.unsplash.com/photo-1489944440615-453fc2b6a9a9?w=800&q=80');"></div>
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <div class="hero-emoji" id="heroEmoji">‚öΩ</div>
        <div class="hero-text">
          <div class="hero-tag daily" id="heroTag">QUIZ DI√ÅRIO</div>
          <div class="hero-title" id="heroTitle">Teste seu conhecimento!</div>
          <div class="hero-subtitle" id="heroSubtitle">Responda e ganhe XP</div>
        </div>
        <div class="hero-arrow">‚Ä∫</div>
      </div>
      <div class="hero-dots" id="heroDots"></div>
    </div>

    <!-- JOGOS AO VIVO -->
    <!-- BANNER PASSE EXPIRADO -->
    <div class="passe-expirado-banner" id="passeExpiradoBanner" onclick="window.location.href='loja-passes.html'">
      <div class="icon">‚ö†Ô∏è</div>
      <div class="info">
        <div class="title" id="passeBannerTitle">Seu passe expirou!</div>
        <div class="desc" id="passeBannerDesc">Voc√™ voltou ao plano Free (2 torcidas/dia)</div>
      </div>
      <div class="action">Renovar ‚Üí</div>
    </div>

    <section id="sectionLive" class="anim-in anim-d3">
      <div class="section-header">
        <h2 class="section-title">üî¥ Ao Vivo</h2>
        <span class="section-count" id="countLive">0 jogos</span>
        <span class="scroll-hint" id="hintLive"><span class="arrow">‚Üí</span> arraste</span>
      </div>
      <div class="games-scroll" id="gamesLive">
        <div class="empty-state">
          <div class="empty-icon">‚öΩ</div>
          <p>Carregando jogos...</p>
        </div>
      </div>
    </section>

    <!-- PR√ìXIMOS JOGOS -->
    <section id="sectionScheduled">
      <div class="section-header">
        <h2 class="section-title">üìÖ Pr√≥ximos Jogos</h2>
        <span class="section-count" id="countScheduled">0 jogos</span>
        <span class="scroll-hint" id="hintScheduled"><span class="arrow">‚Üí</span> arraste</span>
      </div>
      <div class="games-scroll" id="gamesScheduled">
        <div class="empty-state">
          <div class="empty-icon">üìÖ</div>
          <p>Carregando jogos...</p>
        </div>
      </div>
    </section>

    <!-- üéÆ JOGAR AGORA -->
    <section class="section-cat anim-in anim-d4" id="sectionModes">
      <div class="section-cat-header">
        <span class="section-cat-title">üéÆ Jogar Agora</span>
        <div class="section-cat-line"></div>
      </div>
      <div class="action-cards">
        <a href="embates-pvp.html" class="action-card ac-embates">
          <div>
            <div class="ac-icon"><img src="/icons/painel/icon-embates-128.png" alt="Embates" width="52" height="52"></div>
            <div class="ac-title">Embates PvP</div>
            <div class="ac-desc">Quem sabe mais de futebol?</div>
          </div>
          <svg class="ac-deco" viewBox="0 0 80 80" fill="white"><path d="M40 5L50 25H70L54 38L60 58L40 45L20 58L26 38L10 25H30Z"/></svg>
        </a>
        <a href="penaltis.html" class="action-card ac-penaltis">
          <div>
            <div class="ac-icon"><img src="/icons/painel/icon-penaltis-128.png" alt="P√™naltis" width="52" height="52"></div>
            <div class="ac-title">P√™naltis PvP</div>
            <div class="ac-desc">Bata antes que ele defenda</div>
          </div>
          <div class="ac-badge" style="background:rgba(255,255,255,0.25);color:white;">NOVO</div>
          <svg class="ac-deco" viewBox="0 0 80 80" fill="white"><circle cx="40" cy="40" r="35"/></svg>
        </a>
        <a href="bau.html" class="action-card ac-bau" id="bauCard">
          <div>
            <div class="ac-icon"><img src="/icons/painel/icon-bau-128.png" alt="Ba√∫" width="52" height="52"></div>
            <div class="ac-title">Ba√∫ Di√°rio</div>
            <div class="ac-desc">Tem presente te esperando üëÄ</div>
          </div>
          <div class="ac-badge" id="bauBadge" style="display:none;background:var(--live-red);color:white;animation:pulse-live 2s infinite;">ABRIR</div>
          <svg class="ac-deco" viewBox="0 0 80 80" fill="white"><rect x="15" y="30" width="50" height="35" rx="4"/><rect x="10" y="22" width="60" height="14" rx="3"/><rect x="36" y="22" width="8" height="43"/></svg>
        </a>
        <a href="missoes.html" class="action-card ac-missoes">
          <div>
            <div class="ac-icon"><img src="/icons/painel/icon-missoes-128.png" alt="Miss√µes" width="52" height="52"></div>
            <div class="ac-title">Miss√µes</div>
            <div class="ac-desc" id="missoesDesc">Complete e ganhe cr√©ditos</div>
          </div>
          <svg class="ac-deco" viewBox="0 0 80 80" fill="white"><circle cx="40" cy="40" r="30" fill="none" stroke="white" stroke-width="4"/><circle cx="40" cy="40" r="20" fill="none" stroke="white" stroke-width="4"/><circle cx="40" cy="40" r="8"/></svg>
        </a>
      </div>
    </section>

    <!-- üìä EXPLORAR -->
    <section class="section-cat anim-in anim-d5">
      <div class="section-cat-header">
        <span class="section-cat-title">üìä Explorar</span>
        <div class="section-cat-line"></div>
      </div>
      <div class="explore-grid">
        <a href="ranking-geral.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-ranking-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Ranking</span>
          <span class="ec-desc">Voc√™ t√° no top?</span>
        </a>
        <a href="rating.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-rating-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Rating</span>
          <span class="ec-desc">Qual sua nota?</span>
          <span class="ec-badge" style="background:#dc2626;color:white;">NOVO</span>
        </a>
        <a href="torneios.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-torneios-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Torneios</span>
          <span class="ec-desc">Ven√ßa e ganhe!</span>
        </a>
        <a href="teste-ligas.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-ligas-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Teste Ligas</span>
          <span class="ec-desc">10 gr√°tis por dia</span>
        </a>
        <a href="bolsa.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-socio-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">S√≥cio-Time</span>
          <span class="ec-desc">Apoie seu clube</span>
        </a>
        <a href="evolucao.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-evolucao-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Evolu√ß√£o</span>
          <span class="ec-desc" id="evolucaoDesc">Seu progresso</span>
        </a>
        <a href="chat.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-chat-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Chat</span>
          <span class="ec-desc">Zueira ao vivo</span>
        </a>
        <a href="amigos.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-amigos-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Amigos</span>
          <span class="ec-desc">Sua comunidade</span>
        </a>
        <a href="historico.html" class="explore-card">
          <span class="ec-icon"><img src="/icons/painel/icon-historico-64.png" alt="" width="36" height="36"></span>
          <span class="ec-title">Hist√≥rico</span>
          <span class="ec-desc">Seus jogos</span>
        </a>
      </div>
    </section>

    <!-- PATROCINADORES (EM BREVE) -->
    <a href="#" onclick="showToast('üöÄ Patrocinadores em breve!');return false;" class="explore-card" style="display:flex;flex-direction:row;gap:12px;align-items:center;padding:14px 18px;margin-bottom:10px;border-style:dashed;opacity:0.7;">
      <span style="font-size:1.5em;">ü§ù</span>
      <div style="flex:1;">
        <span class="ec-title" style="font-size:0.85em;">Patrocinadores</span>
        <span class="ec-desc" style="display:block;">Ganhe cr√©ditos gr√°tis!</span>
      </div>
      <span style="background:#6366f1;color:white;font-size:0.6em;font-weight:700;padding:3px 8px;border-radius:6px;">EM BREVE</span>
    </a>

    <!-- INSTAGRAM BANNER -->
    <a href="https://www.instagram.com/yellup.app?igsh=MTNxNTZ0cjRzajdkcw==" target="_blank" rel="noopener noreferrer" class="instagram-banner">
      <div class="insta-icon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
        </svg>
      </div>
      <div class="insta-text">
        Siga @yellup.app<br>
        <span>Novidades, dicas e promo√ß√µes!</span>
      </div>
    </a>

  </div>

  <!-- MODAL QUIZ DI√ÅRIO DO TIME DO CORA√á√ÉO -->
  <div class="quiz-diario-overlay" id="quizDiarioOverlay">
    <div class="quiz-diario-card">
      <div class="quiz-diario-banner">
        <h2>‚öΩ Quiz Di√°rio do Cora√ß√£o</h2>
        <p>Teste seu conhecimento sobre seu time!</p>
      </div>
      <div class="quiz-diario-body">

        <!-- STEP 1: Convite -->
        <div class="quiz-step-convite" id="quizStepConvite">
          <div class="quiz-team-info">
            <span class="jersey-quiz" id="quizTeamJersey"></span>
            <span class="quiz-team-name" id="quizTeamName">Seu Time</span>
          </div>
          <p>Que tal responder <strong>uma pergunta</strong> sobre seu time do cora√ß√£o e ganhar <strong>XP</strong>? üéØ</p>
          <div class="quiz-convite-btns">
            <button class="btn-quiz-nao" onclick="fecharQuizDiario()">Agora n√£o</button>
            <button class="btn-quiz-sim" onclick="iniciarQuizDiario()">üéÆ Bora!</button>
          </div>
        </div>

        <!-- STEP 2: Pergunta -->
        <div class="quiz-step-pergunta" id="quizStepPergunta">
          <div class="quiz-xp-badge" id="quizXpBadge">‚≠ê Vale 5 XP</div>
          <div class="quiz-pergunta-texto" id="quizPerguntaTexto"></div>
          <div class="quiz-alternativas" id="quizAlternativas"></div>
        </div>

        <!-- STEP 3: Resultado -->
        <div class="quiz-step-resultado" id="quizStepResultado">
          <div class="quiz-resultado-icon" id="quizResultIcon"></div>
          <div class="quiz-resultado-titulo" id="quizResultTitulo"></div>
          <div class="quiz-resultado-msg" id="quizResultMsg"></div>
          <div class="quiz-xp-ganho" id="quizXpGanho"></div>
          <button class="btn-quiz-fechar" onclick="fecharQuizDiario()">üëç Continuar</button>
        </div>

      </div>
    </div>
  </div>

  <!-- MODAL DE ESCOLHA DE TIME -->
  <div class="modal-overlay" id="modalEscolha">
    <div class="modal-content">
      <div class="modal-header">
        <h2>‚öΩ Escolha seu Time</h2>
        <p>Para qual time voc√™ vai torcer nesta partida?</p>
      </div>
      
      <div class="team-options">
        <div class="team-option" id="optionTeamA" onclick="confirmarEscolha('A')">
          <div class="jersey-modal" id="jerseyModalA"></div>
          <div class="team-name-modal" id="teamNameModalA">Time A</div>
        </div>
        <div class="team-option" id="optionTeamB" onclick="confirmarEscolha('B')">
          <div class="jersey-modal" id="jerseyModalB"></div>
          <div class="team-name-modal" id="teamNameModalB">Time B</div>
        </div>
      </div>

      <div class="modal-warning">
        ‚ö†Ô∏è Aten√ß√£o: Voc√™ n√£o poder√° mudar de time ap√≥s a escolha!
      </div>

      <div class="modal-actions">
        <button class="btn-cancel" onclick="fecharModal()">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- MODAL LIMITE DE TORCIDAS -->
  <div class="passe-modal-overlay" id="passeLimiteModal">
    <div class="passe-modal">
      <div class="passe-modal-icon" id="passeLimiteIcon">üîí</div>
      <div class="passe-modal-title" id="passeLimiteTitulo">Limite atingido!</div>
      <div class="passe-modal-counter" id="passeLimiteCounter"></div>
      <div class="passe-modal-desc" id="passeLimiteDesc">
        No plano <strong>Free</strong> voc√™ pode torcer em at√© <strong>2 jogos por dia</strong>. 
        Fa√ßa upgrade para torcer em <strong>jogos ilimitados</strong>!
      </div>
      <div class="passe-modal-badge" id="passeLimiteBadge">‚öΩ Plano Free ‚Äî 2 torcidas/dia</div>
      <div class="passe-modal-btns">
        <button class="passe-btn-fechar" onclick="fecharPasseModal()">Entendi</button>
        <button class="passe-btn-upgrade" onclick="window.location.href='loja-passes.html'">üé´ Ver Passes</button>
      </div>
    </div>
  </div>

  <!-- ==================== ONBOARDING TUTORIAL ==================== -->
  <div class="onboarding-overlay" id="onboardingOverlay">
    <div class="onboarding-container">
      <div class="onboarding-card">

        <!-- SLIDE 0: BEM-VINDO -->
        <div class="onb-slide active" id="onbSlide0">
          <div class="onb-illustration" style="background: linear-gradient(135deg, rgba(255,181,71,0.2), rgba(255,140,66,0.1));">
            ‚öΩ
          </div>
          <div class="onb-title">BEM-VINDO AO YELLUP!</div>
          <div class="onb-subtitle">A plataforma do torcedor de verdade</div>
          <div class="onb-desc">
            Aqui voc√™ <strong>torce, joga, compete</strong> e prova que √© o maior conhecedor do seu time. Vamos te mostrar tudo que voc√™ pode fazer!
          </div>
          <div class="onb-features">
            <div class="onb-feat"><div class="onb-feat-icon">üß†</div><div class="onb-feat-label">Quiz ao vivo</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">‚öîÔ∏è</div><div class="onb-feat-label">Embates PvP</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üèÜ</div><div class="onb-feat-label">Torneios</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üí∞</div><div class="onb-feat-label">Pr√™mios reais</div></div>
          </div>
        </div>

        <!-- SLIDE 1: JOGOS AO VIVO -->
        <div class="onb-slide" id="onbSlide1">
          <div class="onb-illustration" style="background: linear-gradient(135deg, rgba(239,68,68,0.2), rgba(220,38,38,0.1));">
            üì∫
          </div>
          <div class="onb-title">JOGOS AO VIVO</div>
          <div class="onb-subtitle">Tor√ßa e responda em tempo real!</div>
          <div class="onb-desc">
            Quando seu time joga, o quiz come√ßa! <strong>Escolha seu lado, responda perguntas</strong> e ganhe cr√©ditos enquanto assiste ao jogo. Quanto mais acerta, mais sobe no ranking.
          </div>
          <div class="onb-features">
            <div class="onb-feat"><div class="onb-feat-icon">‚öΩ</div><div class="onb-feat-label">Escolha time</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üß†</div><div class="onb-feat-label">Quiz durante jogo</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üíé</div><div class="onb-feat-label">Ganhe cr√©ditos</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üìä</div><div class="onb-feat-label">Acumule XP</div></div>
          </div>
        </div>

        <!-- SLIDE 2: PVP E P√äNALTIS -->
        <div class="onb-slide" id="onbSlide2">
          <div class="onb-illustration" style="background: linear-gradient(135deg, rgba(234,179,8,0.2), rgba(202,138,4,0.1));">
            ‚öîÔ∏è
          </div>
          <div class="onb-title">DESAFIE SEUS AMIGOS</div>
          <div class="onb-subtitle">Embates PvP e P√™naltis!</div>
          <div class="onb-desc">
            Convide amigos para <strong>embates de conhecimento</strong> em tempo real! Ou dispute nos <strong>P√™naltis PvP</strong> ‚Äî acerte o canto e defenda as cobran√ßas do advers√°rio.
          </div>
          <div class="onb-features">
            <div class="onb-feat"><div class="onb-feat-icon">‚öîÔ∏è</div><div class="onb-feat-label">Embates 1v1</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">‚öΩ</div><div class="onb-feat-label">P√™naltis PvP</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üë•</div><div class="onb-feat-label">Convide amigos</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üèÖ</div><div class="onb-feat-label">Ganhe trof√©us</div></div>
          </div>
        </div>

        <!-- SLIDE 3: TORNEIOS E RANKING -->
        <div class="onb-slide" id="onbSlide3">
          <div class="onb-illustration" style="background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(5,150,105,0.1));">
            üèÜ
          </div>
          <div class="onb-title">TORNEIOS E RANKING</div>
          <div class="onb-subtitle">Compita e suba de faixa!</div>
          <div class="onb-desc">
            Participe de <strong>torneios semanais</strong> com pr√™mios reais. Seu <strong>Rating Superf√£</strong> sobe conforme voc√™ joga, torce, conversa e compete ‚Äî de Reserva at√© Imortal! üî•
          </div>
          <div class="onb-features">
            <div class="onb-feat"><div class="onb-feat-icon">üèÖ</div><div class="onb-feat-label">Torneios</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üî•</div><div class="onb-feat-label">Rating Superf√£</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üìä</div><div class="onb-feat-label">Ranking Global</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üéñÔ∏è</div><div class="onb-feat-label">6 faixas</div></div>
          </div>
        </div>

        <!-- SLIDE 4: COMUNIDADE E MAIS -->
        <div class="onb-slide" id="onbSlide4">
          <div class="onb-illustration" style="background: linear-gradient(135deg, rgba(236,72,153,0.2), rgba(219,39,119,0.1));">
            üí¨
          </div>
          <div class="onb-title">COMUNIDADE YELLUP</div>
          <div class="onb-subtitle">Muito mais que um app de quiz!</div>
          <div class="onb-desc">
            <strong>Chat ao vivo</strong> com outros torcedores, <strong>Bolsa de Times</strong> pra investir, <strong>Ba√∫ di√°rio</strong> com recompensas, <strong>Miss√µes</strong> pra completar e em breve <strong>Patrocinadores</strong> que te d√£o cr√©ditos gr√°tis!
          </div>
          <div class="onb-features">
            <div class="onb-feat"><div class="onb-feat-icon">üí¨</div><div class="onb-feat-label">Chat ao vivo</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üìà</div><div class="onb-feat-label">Bolsa de Times</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">üéÅ</div><div class="onb-feat-label">Ba√∫ di√°rio</div></div>
            <div class="onb-feat"><div class="onb-feat-icon">ü§ù</div><div class="onb-feat-label">Patrocinadores</div></div>
          </div>
        </div>

        <!-- SLIDE 5: BORA JOGAR! -->
        <div class="onb-slide" id="onbSlide5">
          <div class="onb-confetti" id="onbConfetti"></div>
          <div class="onb-illustration" style="background: linear-gradient(135deg, rgba(255,181,71,0.25), rgba(255,140,66,0.15)); font-size: 4em;">
            üéâ
          </div>
          <div class="onb-title" style="font-size: 1.3em;">TUDO PRONTO!</div>
          <div class="onb-subtitle">Voc√™ ganhou 20 cr√©ditos de boas-vindas! üéÅ</div>
          <div class="onb-desc">
            Comece respondendo o <strong>Quiz Di√°rio</strong> do seu time, explore os modos de jogo e convide seus amigos. Quanto mais voc√™ joga, mais <strong>sobe no ranking</strong>!
          </div>
          <div class="onb-features">
            <div class="onb-feat" style="border-color: rgba(255,181,71,0.2);"><div class="onb-feat-icon">1Ô∏è‚É£</div><div class="onb-feat-label">Responda o Quiz</div></div>
            <div class="onb-feat" style="border-color: rgba(255,181,71,0.2);"><div class="onb-feat-icon">2Ô∏è‚É£</div><div class="onb-feat-label">Tor√ßa em jogos</div></div>
            <div class="onb-feat" style="border-color: rgba(255,181,71,0.2);"><div class="onb-feat-icon">3Ô∏è‚É£</div><div class="onb-feat-label">Desafie amigos</div></div>
            <div class="onb-feat" style="border-color: rgba(255,181,71,0.2);"><div class="onb-feat-icon">4Ô∏è‚É£</div><div class="onb-feat-label">Suba no Ranking!</div></div>
          </div>
        </div>

        <!-- DOTS + BUTTONS -->
        <div class="onb-dots" id="onbDots">
          <div class="onb-dot active"></div>
          <div class="onb-dot"></div>
          <div class="onb-dot"></div>
          <div class="onb-dot"></div>
          <div class="onb-dot"></div>
          <div class="onb-dot"></div>
        </div>
        <div class="onb-actions">
          <button class="onb-btn-skip" id="onbBtnSkip" onclick="fecharOnboarding()">Pular</button>
          <button class="onb-btn-next" id="onbBtnNext" onclick="proximoSlideOnboarding()">Pr√≥ximo ‚Üí</button>
        </div>
      </div>
    </div>
  </div>

  <!-- NEWS TICKER / LETREIRO -->
  <div class="news-ticker" id="newsTicker">
    <div class="news-ticker-label">‚ö° AO VIVO</div>
    <div class="news-ticker-track" id="newsTickerTrack">
      <!-- JS popula -->
    </div>
  </div>

  <!-- BOTTOM NAV -->
  <nav class="bottom-nav">
    <div class="nav-content">
      <a href="painel.html" class="nav-item active">
        <span class="nav-icon">üè†</span>
        <span>In√≠cio</span>
      </a>
      <a href="ranking-geral.html" class="nav-item">
        <span class="nav-icon">üèÜ</span>
        <span>Ranking</span>
      </a>
      <a href="indicacoes.html" class="nav-item">
        <span class="nav-icon">üéÅ</span>
        <span>Indicar</span>
      </a>
      <a href="loja-passes.html" class="nav-item nav-creditos">
        <span class="nav-icon">üé´</span>
        <span class="nav-creditos-saldo" id="navCreditosSaldo">...</span>
      </a>
      <a href="editar-perfil.html" class="nav-item">
        <span class="nav-icon">üë§</span>
        <span>Perfil</span>
      </a>
    </div>
  </nav>

  <!-- TOAST -->
  <div class="toast" id="toast"></div>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-functions-compat.js"></script>
  <script src="missoes-helper.js"></script>
  
  <!-- Utilit√°rio de Bandeiras -->
  <script src="js/bandeiras-utils.js"></script>
  
  <script>
    // ===================================
    // üî• CONFIGURA√á√ÉO FIREBASE
    // ===================================
    const firebaseConfig = {
      apiKey: "AIzaSyC5ZrkEy7KuCFJOtPvI7-P-JcA0MF4im5c",
      authDomain: "painel-yellup.firebaseapp.com",
      projectId: "painel-yellup",
      storageBucket: "painel-yellup.appspot.com",
      messagingSenderId: "608347210297",
      appId: "1:608347210297:web:75092713724e617c7203e8",
      measurementId: "G-SYZ16X31KQ"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    // ===================================
    // üì¶ VARI√ÅVEIS GLOBAIS
    // ===================================
    let currentUserId = null;
    let currentUserData = null;
    let jogoAtual = null;  // Jogo sendo selecionado no modal

    // ===================================
    // üéñÔ∏è SISTEMA DE N√çVEIS
    // ===================================
    const NIVEIS = [
      { nome: 'Bronze', minXP: 0, classe: 'level-bronze', emoji: 'ü•â', cor: '#CD7F32' },
      { nome: 'Prata', minXP: 500, classe: 'level-prata', emoji: 'ü•à', cor: '#C0C0C0' },
      { nome: 'Ouro', minXP: 2000, classe: 'level-ouro', emoji: 'ü•á', cor: '#FFD700' },
      { nome: 'Diamante', minXP: 5000, classe: 'level-diamante', emoji: 'üíé', cor: '#B9F2FF' },
      { nome: 'Mestre', minXP: 10000, classe: 'level-mestre', emoji: 'üëë', cor: '#9B59B6' }
    ];

    function calcularNivel(xp) {
      let nivel = NIVEIS[0];
      for (const n of NIVEIS) {
        if (xp >= n.minXP) nivel = n;
      }
      return nivel;
    }

    function calcularProximoNivel(xp) {
      for (const n of NIVEIS) {
        if (xp < n.minXP) return n;
      }
      return null; // J√° √© mestre
    }

    function calcularProgressoNivel(xp) {
      const nivelAtual = calcularNivel(xp);
      const proximoNivel = calcularProximoNivel(xp);
      
      if (!proximoNivel) return 100; // Mestre
      
      const xpNoNivelAtual = xp - nivelAtual.minXP;
      const xpParaProximo = proximoNivel.minXP - nivelAtual.minXP;
      
      return Math.round((xpNoNivelAtual / xpParaProximo) * 100);
    }

    // ===================================
    // üìä RENDER LEVEL PROGRESS (DRY)
    // ===================================
    function renderLevelProgress(xp, nivel, proximoNivel, progresso) {
      const bar = document.getElementById('levelProgress');
      if (!bar) return;
      if (proximoNivel) {
        bar.innerHTML = `
          <div style="font-size:0.78em;color:#d4d8de;margin-bottom:5px;text-shadow:0 1px 6px rgba(0,0,0,0.7);">
            ${xp} / ${proximoNivel.minXP} XP para ${proximoNivel.emoji} ${proximoNivel.nome}
          </div>
          <div style="height:7px;background:rgba(0,0,0,0.4);border-radius:4px;overflow:hidden;backdrop-filter:blur(4px);">
            <div style="width:${progresso}%;height:100%;background:linear-gradient(90deg,${nivel.cor},${proximoNivel.cor});border-radius:4px;box-shadow:0 0 8px ${nivel.cor}40;transition:width 0.8s cubic-bezier(0.22,1,0.36,1);"></div>
          </div>
        `;
      } else {
        bar.innerHTML = `<div style="font-size:0.8em;color:#9B59B6;">üëë N√≠vel m√°ximo atingido!</div>`;
      }
    }

    // ===================================
    // üëï FUN√á√ÉO PARA GERAR CAMISETA SVG
    // ===================================
    function gerarCamisetaSVG(corPrimaria, corSecundaria, corTerciaria) {
      corPrimaria = corPrimaria || '#28a745';
      corSecundaria = corSecundaria || '#ffffff';
      corTerciaria = corTerciaria || corPrimaria;
      
      const maskCSS = `-webkit-mask-image:url('/icons/camiseta-base.png');mask-image:url('/icons/camiseta-base.png');-webkit-mask-size:contain;mask-size:contain;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-position:center;mask-position:center;`;
      
      return `
        <span class="jersey-real" style="position:relative;display:inline-block;${maskCSS}">
          <img src="/icons/camiseta-base.png" style="width:100%;height:100%;object-fit:contain;display:block;" alt="">
          <span style="position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(160deg, ${corPrimaria} 0%, ${corTerciaria} 100%);mix-blend-mode:multiply;pointer-events:none;"></span>
          <span style="position:absolute;top:0;left:15%;right:15%;height:14%;background:linear-gradient(180deg, ${corSecundaria} 0%, transparent 100%);mix-blend-mode:multiply;pointer-events:none;opacity:0.7;"></span>
          <span style="position:absolute;bottom:0;left:10%;right:10%;height:8%;background:linear-gradient(0deg, ${corSecundaria} 0%, transparent 100%);mix-blend-mode:multiply;pointer-events:none;opacity:0.5;"></span>
          <span style="position:absolute;top:18%;left:0;width:8%;bottom:10%;background:${corSecundaria};mix-blend-mode:multiply;pointer-events:none;opacity:0.35;"></span>
          <span style="position:absolute;top:18%;right:0;width:8%;bottom:10%;background:${corSecundaria};mix-blend-mode:multiply;pointer-events:none;opacity:0.35;"></span>
          <span style="position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 40%, rgba(0,0,0,0.05) 100%);pointer-events:none;"></span>
        </span>
      `;
    }

    // ===================================
    // üí¨ TOAST
    // ===================================
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // ===================================
    // üîê AUTENTICA√á√ÉO
    // ===================================
    auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL)
      .then(() => console.log("‚úÖ Persist√™ncia configurada"))
      .catch((error) => console.error("‚ùå Erro:", error));

    showSkeleton(); // Show skeleton while loading
    auth.onAuthStateChanged(async (user) => {
      console.log("üîç Verificando autentica√ß√£o...");
      
      if (!user) {
        console.log("‚ùå Usu√°rio n√£o autenticado");
        window.location.href = 'index.html';
        return;
      }

      console.log("‚úÖ Usu√°rio autenticado:", user.uid);
      currentUserId = user.uid;

      try {
        // Carregar dados do usu√°rio
        const userDoc = await db.collection('usuarios').doc(currentUserId).get();
        
        if (!userDoc.exists) {
          console.error("‚ùå Usu√°rio n√£o encontrado no banco!");
          showToast('‚ùå Erro: Usu√°rio n√£o encontrado');
          return;
        }

        currentUserData = userDoc.data();
        console.log("‚úÖ Dados do usu√°rio:", currentUserData);

        // Atualizar interface
        await atualizarPerfil();
        await carregarJogos();

        // üéì ONBOARDING - Mostrar tutorial para novos usu√°rios
        if (currentUserData.primeiroLogin === true) {
          mostrarOnboarding();
        } else {
          // ‚öΩ QUIZ DI√ÅRIO - S√≥ mostra se n√£o √© primeiro login
          await verificarQuizDiario();
        }

        // üé´ VERIFICAR PASSE EXPIRADO
        await verificarPasseExpirado();

        // Atualizar display de torcidas restantes
        atualizarDisplayPasse();

        // üì∑ SLIDESHOW DE FOTOS DE FUNDO E A√á√ïES R√ÅPIDAS
        setTimeout(async () => {
          hideSkeleton();
          carregarFotosFundoPerfil();
          await verificarBadgesNovas();
          buildHeroStates();
          renderHeroDots();
          applyHeroState(heroStates[0], false);
          startHeroRotate();
          initProfileParticles();
          updateOnlineCounter();
          buildNewsTicker();
        }, 500);

      } catch (error) {
        console.error("‚ùå Erro:", error);
        showToast('‚ùå Erro ao carregar dados');
      }
    });

    // ===================================
    // üë§ ATUALIZAR PERFIL
    // ===================================
    async function atualizarPerfil() {
      const nome = currentUserData.usuarioUnico || currentUserData.usuario || currentUserData.nome || 'Usu√°rio';
      const inicial = nome.charAt(0).toUpperCase();
      const xp = currentUserData.xp || 0;

      document.getElementById('userName').textContent = nome;
      document.getElementById('profileName').textContent = nome;
      
      // Avatar - mostrar foto se existir
      const userAvatarEl = document.getElementById('userAvatar');
      const profileAvatarEl = document.getElementById('profileAvatar');
      
      if (currentUserData.avatarUrl) {
        const imgStyle = 'width:100%;height:100%;object-fit:cover;border-radius:50%;';
        userAvatarEl.innerHTML = `<img src="${currentUserData.avatarUrl}" alt="Avatar" style="${imgStyle}">`;
        profileAvatarEl.innerHTML = `<img src="${currentUserData.avatarUrl}" alt="Avatar" style="${imgStyle}">`;
      } else {
        userAvatarEl.textContent = inicial;
        profileAvatarEl.textContent = inicial;
      }

      // Calcular n√≠vel
      const nivel = calcularNivel(xp);
      const proximoNivel = calcularProximoNivel(xp);
      const progresso = calcularProgressoNivel(xp);

      // Atualizar badge de n√≠vel
      const nivelBadge = document.getElementById('profileLevel');
      if (nivelBadge) {
        nivelBadge.innerHTML = `
          <span class="level-badge" style="background: ${nivel.cor}20; color: ${nivel.cor}; border: 1px solid ${nivel.cor}50;">
            ${nivel.emoji} ${nivel.nome}
          </span>
        `;
      }

      // Barra de progresso do n√≠vel
      renderLevelProgress(xp, nivel, proximoNivel, progresso);

      // Estat√≠sticas
      document.getElementById('statCredits').textContent = currentUserData.creditos || 0;
      document.getElementById('statXP').textContent = xp;

      // Atualizar badge de cr√©ditos no nav
      const navSaldo = document.getElementById('navCreditosSaldo');
      if (navSaldo) navSaldo.textContent = (currentUserData.creditos || 0) + ' üí∞';
      
      const jogosParticipados = currentUserData.torcidas ? Object.keys(currentUserData.torcidas).length : 0;
      document.getElementById('statGames').textContent = jogosParticipados;

      // Passe status
      const passe = currentUserData.passe || { tipo: 'free', ativo: false };
      const tipoPasse = (passe.ativo && passe.tipo !== 'free') ? passe.tipo : 'free';
      const passeMap = { free: '‚öΩ Free', semanal: 'üåü Semanal', mensal: 'üíé Mensal', anual: 'üëë Anual' };
      const statFreeEl = document.getElementById('statFree');
      if (statFreeEl) {
        const passeInfo = getPasseInfo();
        if (passeInfo.expirado) {
          statFreeEl.textContent = '‚ö†Ô∏è Expirado';
          statFreeEl.style.color = '#ef4444';
        } else if (passeInfo.ilimitado) {
          statFreeEl.textContent = passeMap[tipoPasse] || 'üé´ Ativo';
          statFreeEl.style.color = '#10b981';
        } else {
          const restam = 2 - contarTorcidasHoje();
          statFreeEl.textContent = '‚öΩ Free (' + restam + '/2)';
          statFreeEl.style.color = restam > 0 ? '#a9b5c6' : '#ef4444';
        }
        statFreeEl.style.fontSize = '0.8em';
      }

      // Time do cora√ß√£o
      if (currentUserData.timeId) {
        try {
          const timeDoc = await db.collection('times').doc(currentUserData.timeId).get();
          if (timeDoc.exists) {
            const time = { id: timeDoc.id, ...timeDoc.data() };
            const bandeira = getBandeira(time.codigoPais);
            document.getElementById('profileTeam').textContent = `‚ù§Ô∏è ${bandeira} ${time.nome}`;
            document.getElementById('profileTeamJersey').innerHTML = gerarCamisetaSVG(
              time.primaria, time.secundaria, time.terciaria
            );
            document.getElementById('profileTeamJersey').style.cssText = 'width:30px;height:35px;display:inline-block;';
          }
        } catch (e) {
          console.error("Erro ao buscar time:", e);
        }
      }
    }

    // ===================================
    // üéÆ CARREGAR JOGOS
    // ===================================
    async function carregarJogos() {
      try {
        console.log("üéÆ Carregando jogos...");

        const jogosSnap = await db.collection('jogos').orderBy('dataInicio', 'desc').get();
        
        const jogosLive = [];
        const jogosScheduled = [];
        const jogosFinished = [];
        const now = new Date();

        for (const doc of jogosSnap.docs) {
          const jogo = { id: doc.id, ...doc.data() };
          
          // Determinar status
          const inicio = jogo.dataInicio?.toDate ? jogo.dataInicio.toDate() : new Date(jogo.dataInicio);
          const fim = jogo.dataFim?.toDate ? jogo.dataFim.toDate() : null;

          // Guardar datas parseadas para ordena√ß√£o
          jogo._inicio = inicio;
          jogo._fim = fim;

          if (jogo.status === 'finalizado' || (fim && fim < now)) {
            jogo.statusCalc = 'ENCERRADO';
            jogosFinished.push(jogo);
          } else if (jogo.status === 'ao_vivo' || (inicio <= now && (!fim || fim > now))) {
            jogo.statusCalc = 'LIVE';
            jogosLive.push(jogo);
          } else {
            jogo.statusCalc = 'AGENDADO';
            jogosScheduled.push(jogo);
          }
        }

        // ====== ORDENA√á√ÉO ======
        // Live: come√ßaram antes primeiro (ASC por dataInicio)
        jogosLive.sort((a, b) => a._inicio - b._inicio);

        // Pr√≥ximos: v√£o come√ßar antes primeiro (ASC por dataInicio)
        jogosScheduled.sort((a, b) => a._inicio - b._inicio);

        // Encerrados: acabaram por √∫ltimo primeiro (DESC por dataFim ou dataInicio)
        jogosFinished.sort((a, b) => {
          const fimA = a._fim || a._inicio;
          const fimB = b._fim || b._inicio;
          return fimB - fimA;
        });

        console.log(`üìä Live: ${jogosLive.length}, Agendados: ${jogosScheduled.length}, Encerrados: ${jogosFinished.length}`);

        // Renderizar (encerrados agora ficam em historico.html)
        await renderizarJogos('gamesLive', jogosLive, 'countLive');
        await renderizarJogos('gamesScheduled', jogosScheduled, 'countScheduled');

        // Mostrar dica de scroll se tiver mais de 1 card
        if (jogosLive.length > 1) document.getElementById('hintLive').style.display = 'flex';
        if (jogosScheduled.length > 1) document.getElementById('hintScheduled').style.display = 'flex';

      } catch (error) {
        console.error("‚ùå Erro ao carregar jogos:", error);
        showToast('‚ùå Erro ao carregar jogos');
      }
    }

    // ===================================
    // üèÜ FAIXAS DE PREMIA√á√ÉO
    // ===================================
    const PREMIACAO_FAIXAS = [
      { min: 0, max: 9, top: [10, 7, 5], faixas: [] },
      {
        min: 10, max: 100,
        top: [18, 16, 14, 12, 10],
        faixas: [
          { de: 6, ate: 15, valor: 9 },
          { de: 16, ate: 25, valor: 7 },
          { de: 26, ate: 35, valor: 5 },
          { de: 36, ate: 45, valor: 4 },
          { de: 46, ate: 50, valor: 3 }
        ]
      },
      {
        min: 101, max: 500,
        top: [30, 25, 22, 20, 18],
        faixas: [
          { de: 6, ate: 15, valor: 16 },
          { de: 16, ate: 25, valor: 14 },
          { de: 26, ate: 35, valor: 12 },
          { de: 36, ate: 45, valor: 10 },
          { de: 46, ate: 50, valor: 5 }
        ]
      },
      {
        min: 501, max: Infinity,
        top: [50, 45, 40, 35, 30],
        faixas: [
          { de: 6, ate: 15, valor: 25 },
          { de: 16, ate: 25, valor: 20 },
          { de: 26, ate: 35, valor: 18 },
          { de: 36, ate: 45, valor: 15 },
          { de: 46, ate: 50, valor: 10 }
        ]
      }
    ];

    function calcularTotalFaixa(totalParticipantes) {
      if (totalParticipantes <= 0) return { total: 0, premiados: 0, topPremios: [] };
      const faixa = PREMIACAO_FAIXAS.find(f => totalParticipantes >= f.min && totalParticipantes <= f.max) || PREMIACAO_FAIXAS[0];
      let total = faixa.top.reduce((a, b) => a + b, 0);
      let premiados = faixa.top.length;
      for (const fx of faixa.faixas) {
        for (let pos = fx.de; pos <= fx.ate && pos <= totalParticipantes; pos++) {
          total += fx.valor;
          premiados++;
        }
      }
      return { total, premiados, topPremios: faixa.top };
    }

    // ===================================
    // üìã RENDERIZAR JOGOS
    // ===================================
    async function renderizarJogos(containerId, jogos, countId) {
      const container = document.getElementById(containerId);
      const count = document.getElementById(countId);

      if (jogos.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">‚öΩ</div>
            <p>Nenhum jogo encontrado</p>
          </div>
        `;
        count.textContent = '0 jogos';
        return;
      }

      count.textContent = `${jogos.length} ${jogos.length === 1 ? 'jogo' : 'jogos'}`;

      // Processar jogos com informa√ß√µes dos times
      const jogosProcessados = await Promise.all(jogos.map(async jogo => {
        // Buscar dados dos times
        let timeCasaData = { nome: 'Time A', primaria: '#28a745', secundaria: '#fff', terciaria: '#28a745' };
        let timeForaData = { nome: 'Time B', primaria: '#dc3545', secundaria: '#fff', terciaria: '#dc3545' };

        try {
          if (jogo.timeCasaId) {
            const casaDoc = await db.collection('times').doc(jogo.timeCasaId).get();
            if (casaDoc.exists) timeCasaData = casaDoc.data();
          }
          if (jogo.timeForaId) {
            const foraDoc = await db.collection('times').doc(jogo.timeForaId).get();
            if (foraDoc.exists) timeForaData = foraDoc.data();
          }
        } catch (e) {
          console.error("Erro ao buscar times:", e);
        }

        // ‚úÖ VERIFICAR SE USU√ÅRIO J√Å ESCOLHEU TIME (do documento do usu√°rio)
        const torcidaEscolhida = currentUserData.torcidas?.[jogo.id];
        let nomeTimeTorcido = null;
        let corTimeTorcido = null;

        if (torcidaEscolhida) {
          // Encontrar qual time foi escolhido
          if (torcidaEscolhida === jogo.timeCasaId) {
            nomeTimeTorcido = timeCasaData.nome;
            corTimeTorcido = timeCasaData.primaria;
          } else if (torcidaEscolhida === jogo.timeForaId) {
            nomeTimeTorcido = timeForaData.nome;
            corTimeTorcido = timeForaData.primaria;
          }
        }

        // ‚úÖ BUSCAR PONTOS DA SUBCOLE√á√ÉO PARTICIPANTES
        // O participante salva: timeId (ID do time), pontos
        let pontosCasa = 0;
        let pontosFora = 0;
        
        try {
          const partSnap = await db.collection('jogos').doc(jogo.id).collection('participantes').get();
          partSnap.forEach(doc => {
            const p = doc.data();
            const pts = p.pontos || 0;
            // Comparar timeId com os IDs dos times do jogo
            if (p.timeId === jogo.timeCasaId) {
              pontosCasa += pts;
            } else if (p.timeId === jogo.timeForaId) {
              pontosFora += pts;
            }
          });
          console.log(`üìä Jogo ${jogo.id}: Casa=${pontosCasa} pts, Fora=${pontosFora} pts`);
        } catch (e) {
          console.log('Erro ao buscar pontos:', jogo.id, e);
        }

        return {
          ...jogo,
          timeCasaData,
          timeForaData,
          torcidaEscolhida,
          nomeTimeTorcido,
          corTimeTorcido,
          pontosCasa,
          pontosFora
        };
      }));

      // Gerar HTML com layout MODERNO
      container.innerHTML = jogosProcessados.map(jogo => {
        const isLive = jogo.statusCalc === 'LIVE';
        const isScheduled = jogo.statusCalc === 'AGENDADO';
        const isFinished = jogo.statusCalc === 'ENCERRADO';
        
        const dataInicio = jogo.dataInicio?.toDate ? jogo.dataInicio.toDate() : new Date(jogo.dataInicio);

        // Contagem de torcida
        const torcidaCasa = jogo.torcidaCasaCount || 0;
        const torcidaFora = jogo.torcidaForaCount || 0;
        const totalTorcida = torcidaCasa + torcidaFora || 1;
        const percCasa = Math.round((torcidaCasa / totalTorcida) * 100);
        const percFora = 100 - percCasa;

        // Pontos dos times - j√° buscados no Promise.all acima
        const pontosCasa = jogo.pontosCasa || 0;
        const pontosFora = jogo.pontosFora || 0;
        
        const totalPontos = pontosCasa + pontosFora || 1;
        const percPontosCasa = Math.round((pontosCasa / totalPontos) * 100);
        const percPontosFora = 100 - percPontosCasa;

        // Quem est√° ganhando na torcida e nos pontos
        const casaWinning = percCasa > percFora;
        const foraWinning = percFora > percCasa;
        const casaPontosWinning = percPontosCasa > percPontosFora;
        const foraPontosWinning = percPontosFora > percPontosCasa;

        // Status badge
        let statusBadge = '';
        if (isLive) {
          statusBadge = `<span class="game-status status-live">AO VIVO</span>`;
        } else if (isScheduled) {
          statusBadge = `<span class="game-status status-scheduled">${dataInicio.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}</span>`;
        } else {
          statusBadge = `<span class="game-status status-finished">ENCERRADO</span>`;
        }

        // Placar ou hor√°rio - SEM PLACAR (plataforma de quiz)
        let scoreOrTime = '';
        if (isLive) {
          scoreOrTime = `
            <div class="game-live-indicator">
              <span class="live-pulse"></span>
              <span>AO VIVO</span>
            </div>
            <div class="game-time-info">${dataInicio.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}</div>
          `;
        } else if (isScheduled) {
          scoreOrTime = `
            <div class="game-datetime-box">
              <div class="game-date">${dataInicio.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}</div>
              <div class="game-hour">${dataInicio.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}</div>
            </div>
          `;
        } else {
          // ENCERRADO - mostra a data
          scoreOrTime = `
            <div class="game-datetime-box finished">
              <div class="game-date">${dataInicio.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}</div>
              <div class="game-hour">${dataInicio.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}</div>
            </div>
          `;
        }

        // Cr√©ditos em disputa ‚Äî baseado no n√∫mero de participantes
        const totalParticipantes = (jogo.torcidaCasaCount || 0) + (jogo.torcidaForaCount || 0);
        // Se ainda sem participantes, usa faixa m√≠nima (0-9: top 3 = 10+7+5 = 22)
        const premiacaoInfo = totalParticipantes > 0
          ? calcularTotalFaixa(totalParticipantes)
          : calcularTotalFaixa(1);
        const creditosEmDisputa = premiacaoInfo.total;
        const creditosDisplay = creditosEmDisputa;

        // Badge de time escolhido
        let userCheeredBadge = '';
        if (jogo.nomeTimeTorcido) {
          userCheeredBadge = `
            <div class="user-cheered">
              <span>‚úÖ</span>
              <span>Torcendo: ${jogo.nomeTimeTorcido}</span>
            </div>
          `;
        }

        // Bot√£o de a√ß√£o
        let actionButton = '';
        if (jogo.torcidaEscolhida) {
          const btnClass = isLive ? 'btn-game live' : 'btn-game primary';
          const btnText = isLive ? 'üî¥ Jogar Agora' : (isFinished ? 'üìä Ver Resultado' : 'üéÆ Entrar');
          actionButton = `<button class="${btnClass}" onclick="entrarNoJogo('${jogo.id}')">${btnText}</button>`;
        } else if (!isFinished) {
          actionButton = `<button class="btn-game secondary" onclick="abrirModalEscolha('${jogo.id}')">‚öΩ Escolher Time</button>`;
        } else {
          actionButton = `<button class="btn-game secondary" disabled style="opacity: 0.5;">N√£o participou</button>`;
        }

        // Gerar camisetas
        const jerseyCasa = `<span class="game-team-jersey">${gerarCamisetaSVG(
          jogo.timeCasaData.primaria, 
          jogo.timeCasaData.secundaria, 
          jogo.timeCasaData.terciaria
        )}</span>`;

        const jerseyFora = `<span class="game-team-jersey">${gerarCamisetaSVG(
          jogo.timeForaData.primaria, 
          jogo.timeForaData.secundaria, 
          jogo.timeForaData.terciaria
        )}</span>`;

        // Classes extras do card
        const cardClasses = ['game-card'];
        if (isLive) cardClasses.push('is-live');
        if (currentUserData.timeId && (jogo.timeCasaId === currentUserData.timeId || jogo.timeForaId === currentUserData.timeId)) {
          cardClasses.push('my-team-playing');
        }

        return `
          <div class="${cardClasses.join(' ')}">
            <!-- Header com competi√ß√£o e status -->
            <div class="game-card-header">
              <div class="game-league">
                <span>${jogo.competicao || 'Partida'}</span>
              </div>
              ${statusBadge}
            </div>

            <!-- Corpo: Times e Placar -->
            <div class="game-card-body">
              <div class="game-matchup">
                <!-- Time Casa -->
                <div class="game-team">
                  ${jerseyCasa}
                  <span class="game-team-name">${jogo.timeCasaData.nome}</span>
                </div>

                <!-- Info Central -->
                <div class="game-center-info">
                  ${scoreOrTime}
                </div>

                <!-- Time Fora -->
                <div class="game-team">
                  ${jerseyFora}
                  <span class="game-team-name">${jogo.timeForaData.nome}</span>
                </div>
              </div>
            </div>

            <!-- Barra de Torcida Visual -->
            <div class="torcida-section">
              <div class="torcida-label">Torcida na plataforma</div>
              <div class="torcida-visual">
                <div class="torcida-side left">
                  <span class="torcida-percent" style="color: ${jogo.timeCasaData.primaria}">${percCasa}%</span>
                </div>
                <div class="torcida-bar-container">
                  <div class="torcida-bar-fill left ${casaWinning ? 'winning' : ''}" style="width: ${percCasa}%; background: ${jogo.timeCasaData.primaria}; color: ${jogo.timeCasaData.primaria};"></div>
                  <div class="torcida-bar-fill right ${foraWinning ? 'winning' : ''}" style="width: ${percFora}%; background: ${jogo.timeForaData.primaria}; color: ${jogo.timeForaData.primaria};"></div>
                </div>
                <div class="torcida-side right">
                  <span class="torcida-percent" style="color: ${jogo.timeForaData.primaria}">${percFora}%</span>
                </div>
              </div>
            </div>

            <!-- Barra de Pontos Visual -->
            <div class="torcida-section pontos-section">
              <div class="torcida-label">‚≠ê Pontos no quiz</div>
              <div class="torcida-visual">
                <div class="torcida-side left">
                  <span class="torcida-percent" style="color: ${jogo.timeCasaData.primaria}">${percPontosCasa}%</span>
                </div>
                <div class="torcida-bar-container">
                  <div class="torcida-bar-fill left ${casaPontosWinning ? 'winning' : ''}" style="width: ${percPontosCasa}%; background: ${jogo.timeCasaData.primaria}; color: ${jogo.timeCasaData.primaria};"></div>
                  <div class="torcida-bar-fill right ${foraPontosWinning ? 'winning' : ''}" style="width: ${percPontosFora}%; background: ${jogo.timeForaData.primaria}; color: ${jogo.timeForaData.primaria};"></div>
                </div>
                <div class="torcida-side right">
                  <span class="torcida-percent" style="color: ${jogo.timeForaData.primaria}">${percPontosFora}%</span>
                </div>
              </div>
            </div>

            <!-- Cr√©ditos em Disputa -->
            <div class="creditos-disputa ${creditosEmDisputa >= 50 ? 'high-value' : ''}">
              <span class="creditos-icon">üíé</span>
              <span class="creditos-valor">${creditosDisplay}</span>
              <span class="creditos-label">${isFinished ? 'foram disputados' : 'em disputa'} (top ${premiacaoInfo.premiados || 3})</span>
            </div>

            <!-- Badge de torcida escolhida -->
            ${userCheeredBadge}

            <!-- Bot√£o de A√ß√£o -->
            <div class="game-card-action">
              ${actionButton}
            </div>
          </div>
        `;
      }).join('');
    }

    // ===================================
    // ‚öΩ MODAL DE ESCOLHA DE TIME
    // ===================================
    async function abrirModalEscolha(jogoId) {
      console.log("üéØ Abrindo modal para jogo:", jogoId);

      // üé´ VERIFICAR LIMITE DE TORCIDAS
      if (!verificarLimiteTorcida()) {
        console.log("üîí Limite de torcidas atingido - bloqueando");
        return;
      }

      try {
        // Buscar dados do jogo
        const jogoDoc = await db.collection('jogos').doc(jogoId).get();
        if (!jogoDoc.exists) {
          showToast('‚ùå Jogo n√£o encontrado');
          return;
        }

        const jogo = { id: jogoId, ...jogoDoc.data() };

        // Buscar dados dos times
        let timeCasaData = { nome: 'Time A', primaria: '#28a745', secundaria: '#fff', terciaria: '#28a745' };
        let timeForaData = { nome: 'Time B', primaria: '#dc3545', secundaria: '#fff', terciaria: '#dc3545' };

        if (jogo.timeCasaId) {
          const casaDoc = await db.collection('times').doc(jogo.timeCasaId).get();
          if (casaDoc.exists) timeCasaData = { id: jogo.timeCasaId, ...casaDoc.data() };
        }
        if (jogo.timeForaId) {
          const foraDoc = await db.collection('times').doc(jogo.timeForaId).get();
          if (foraDoc.exists) timeForaData = { id: jogo.timeForaId, ...foraDoc.data() };
        }

        // Salvar jogo atual para usar na confirma√ß√£o
        jogoAtual = {
          id: jogoId,
          timeCasaId: jogo.timeCasaId,
          timeForaId: jogo.timeForaId,
          timeCasaData,
          timeForaData
        };

        // Atualizar modal
        document.getElementById('teamNameModalA').textContent = timeCasaData.nome;
        document.getElementById('teamNameModalB').textContent = timeForaData.nome;

        document.getElementById('jerseyModalA').innerHTML = gerarCamisetaSVG(
          timeCasaData.primaria, timeCasaData.secundaria, timeCasaData.terciaria
        );
        document.getElementById('jerseyModalB').innerHTML = gerarCamisetaSVG(
          timeForaData.primaria, timeForaData.secundaria, timeForaData.terciaria
        );

        // Aplicar cores de borda
        document.getElementById('optionTeamA').style.borderColor = timeCasaData.primaria;
        document.getElementById('optionTeamB').style.borderColor = timeForaData.primaria;

        // Mostrar modal
        document.getElementById('modalEscolha').classList.add('active');

      } catch (error) {
        console.error("‚ùå Erro ao abrir modal:", error);
        showToast('‚ùå Erro ao carregar times');
      }
    }

    function fecharModal() {
      document.getElementById('modalEscolha').classList.remove('active');
      jogoAtual = null;
    }

    // ===================================
    // ‚úÖ CONFIRMAR ESCOLHA DE TIME
    // ===================================
    async function confirmarEscolha(lado) {
      if (!jogoAtual) {
        showToast('‚ùå Erro: Jogo n√£o selecionado');
        return;
      }

      const timeEscolhidoId = lado === 'A' ? jogoAtual.timeCasaId : jogoAtual.timeForaId;
      const timeEscolhidoNome = lado === 'A' ? jogoAtual.timeCasaData.nome : jogoAtual.timeForaData.nome;

      console.log("‚úÖ Confirmando escolha:");
      console.log("   Jogo:", jogoAtual.id);
      console.log("   Time ID:", timeEscolhidoId);
      console.log("   Time Nome:", timeEscolhidoNome);

      // Confirmar
      if (!confirm(`Voc√™ quer torcer para ${timeEscolhidoNome}?\n\n‚ö†Ô∏è Esta escolha n√£o pode ser alterada!`)) {
        return;
      }

      try {
        showToast('üíæ Salvando...');

        // 1. Atualizar documento do usu√°rio com o timeId real
        await db.collection('usuarios').doc(currentUserId).update({
          [`torcidas.${jogoAtual.id}`]: timeEscolhidoId
        });

        // 2. Atualizar contador do jogo
        const campoContador = lado === 'A' ? 'torcidaCasaCount' : 'torcidaForaCount';
        await db.collection('jogos').doc(jogoAtual.id).update({
          [campoContador]: firebase.firestore.FieldValue.increment(1)
        });

        // 3. Atualizar dados locais
        if (!currentUserData.torcidas) currentUserData.torcidas = {};
        currentUserData.torcidas[jogoAtual.id] = timeEscolhidoId;

        console.log("‚úÖ Escolha salva com sucesso!");
        showToast(`‚úÖ Voc√™ est√° torcendo para ${timeEscolhidoNome}!`);

        // üé´ Incrementar contador de torcidas do dia
        await incrementarTorcidaHoje();

        // Mostrar quantas torcidas restam (se free)
        const passeInfo = getPasseInfo();
        if (!passeInfo.ilimitado) {
          const restam = 2 - contarTorcidasHoje();
          if (restam > 0) {
            showToast(`‚úÖ Torcendo para ${timeEscolhidoNome}! (${restam} torcida${restam > 1 ? 's' : ''} restante${restam > 1 ? 's' : ''} hoje)`);
          }
        }

        // ‚úÖ Atualizar miss√£o "torcer para 1 time"
        MissoesHelper.registrar(currentUserId, 'torcer_1');

        // Fechar modal
        fecharModal();

        // Recarregar jogos
        await carregarJogos();

        // Redirecionar para o jogo ap√≥s 1 segundo
        setTimeout(() => {
          entrarNoJogo(jogoAtual.id);
        }, 1000);

      } catch (error) {
        console.error("‚ùå Erro ao salvar:", error);
        showToast('‚ùå Erro ao salvar escolha. Tente novamente!');
      }
    }

    // ===================================
    // üéÆ ENTRAR NO JOGO
    // ===================================
    function entrarNoJogo(jogoId) {
      window.location.href = `painel-jogo.html?jogoId=${jogoId}`;
    }

    // ===================================
    // üö™ LOGOUT
    // ===================================
    function logout() {
      if (confirm('Deseja realmente sair?')) {
        auth.signOut().then(() => {
          window.location.href = 'index.html';
        });
      }
    }

    // ===================================
    // ‚öΩ QUIZ DI√ÅRIO DO TIME DO CORA√á√ÉO
    // ===================================
    // ==========================================
    // üé´ SISTEMA DE PASSES ‚Äî VALIDA√á√ÉO E LIMITES
    // ==========================================

    /**
     * Retorna info completa do passe do usu√°rio
     * Verifica expira√ß√£o e retorna limites
     */
    function getPasseInfo() {
      const passe = currentUserData.passe || {};
      const agora = new Date();

      // Sem passe = Free
      if (!passe.ativo || !passe.tipo || passe.tipo === 'free') {
        return { tipo: 'free', ativo: false, expirado: false, limite: 2, ilimitado: false, label: '‚öΩ Free' };
      }

      // Verificar expira√ß√£o
      let dataExpiracao = null;
      if (passe.dataExpiracao) {
        // Firestore Timestamp ou string
        dataExpiracao = passe.dataExpiracao.toDate ? passe.dataExpiracao.toDate() : new Date(passe.dataExpiracao);
      }

      if (dataExpiracao && agora > dataExpiracao) {
        // EXPIROU!
        return {
          tipo: passe.tipo,
          ativo: false,
          expirado: true,
          expirouEm: dataExpiracao,
          limite: 2,
          ilimitado: false,
          label: '‚ö†Ô∏è ' + passe.tipo.charAt(0).toUpperCase() + passe.tipo.slice(1) + ' (expirado)'
        };
      }

      // Passe ativo
      const labels = { semanal: 'üåü Semanal', mensal: 'üíé Mensal', anual: 'üëë Anual' };
      return {
        tipo: passe.tipo,
        ativo: true,
        expirado: false,
        dataExpiracao: dataExpiracao,
        limite: 999,
        ilimitado: true,
        label: labels[passe.tipo] || 'üé´ ' + passe.tipo
      };
    }

    /**
     * Conta quantas torcidas o usu√°rio fez HOJE
     */
    function contarTorcidasHoje() {
      const torcidasHoje = currentUserData.torcidasHoje || {};
      const agora = new Date();
      const brasilOffset = -3 * 60;
      const brasilTime = new Date(agora.getTime() + (brasilOffset - agora.getTimezoneOffset()) * 60000);
      const hoje = brasilTime.toISOString().split('T')[0];

      // Se o campo √© de outro dia, zerou
      if (torcidasHoje.data !== hoje) return 0;
      return torcidasHoje.count || 0;
    }

    /**
     * Incrementa o contador de torcidas do dia
     */
    async function incrementarTorcidaHoje() {
      const agora = new Date();
      const brasilOffset = -3 * 60;
      const brasilTime = new Date(agora.getTime() + (brasilOffset - agora.getTimezoneOffset()) * 60000);
      const hoje = brasilTime.toISOString().split('T')[0];

      const torcidasHoje = currentUserData.torcidasHoje || {};

      if (torcidasHoje.data === hoje) {
        // Mesmo dia ‚Äî incrementar
        const novoCount = (torcidasHoje.count || 0) + 1;
        await db.collection('usuarios').doc(currentUserId).update({
          'torcidasHoje.count': novoCount
        });
        if (!currentUserData.torcidasHoje) currentUserData.torcidasHoje = {};
        currentUserData.torcidasHoje.count = novoCount;
      } else {
        // Novo dia ‚Äî resetar
        await db.collection('usuarios').doc(currentUserId).update({
          'torcidasHoje': { data: hoje, count: 1 }
        });
        currentUserData.torcidasHoje = { data: hoje, count: 1 };
      }
    }

    /**
     * Verifica se passe expirou ao carregar o painel
     * Mostra banner + desativa no Firestore se necess√°rio
     */
    async function verificarPasseExpirado() {
      const info = getPasseInfo();

      if (info.expirado) {
        console.log('‚ö†Ô∏è Passe ' + info.tipo + ' expirou!');

        // Desativar no Firestore
        try {
          await db.collection('usuarios').doc(currentUserId).update({
            'passe.ativo': false,
            'passe.expiradoEm': info.expirouEm.toISOString()
          });
          if (currentUserData.passe) currentUserData.passe.ativo = false;
        } catch (e) {
          console.error('Erro ao desativar passe:', e);
        }

        // Mostrar banner
        const banner = document.getElementById('passeExpiradoBanner');
        if (banner) {
          const diasAtras = Math.floor((new Date() - info.expirouEm) / (1000 * 60 * 60 * 24));
          document.getElementById('passeBannerTitle').textContent =
            'Seu passe ' + info.tipo + ' expirou' + (diasAtras > 0 ? ' h√° ' + diasAtras + ' dia(s)' : ' hoje') + '!';
          document.getElementById('passeBannerDesc').textContent =
            'Voc√™ voltou ao plano Free (2 torcidas/dia). Renove para torcer ilimitado!';
          banner.classList.add('show');
        }

        showToast('‚ö†Ô∏è Seu passe ' + info.tipo + ' expirou! Voc√™ est√° no plano Free.');
      }
    }

    /**
     * Verifica se o usu√°rio pode torcer em mais um jogo
     * Retorna true se OK, false se bloqueado (e mostra modal)
     */
    function verificarLimiteTorcida() {
      const info = getPasseInfo();

      // Passe ativo e ilimitado = sempre pode
      if (info.ativo && info.ilimitado) return true;

      // Free ou expirado ‚Äî verificar limite di√°rio
      const usadasHoje = contarTorcidasHoje();
      const limite = 2;

      if (usadasHoje >= limite) {
        // BLOQUEADO ‚Äî mostrar modal
        mostrarModalLimite(usadasHoje, limite, info);
        return false;
      }

      // Pode torcer, mas avisar se est√° na √∫ltima
      if (usadasHoje === limite - 1) {
        showToast('‚ö†Ô∏è Esta √© sua √∫ltima torcida gr√°tis hoje!');
      }

      return true;
    }

    /**
     * Mostra modal de limite atingido
     */
    function mostrarModalLimite(usadas, limite, passeInfo) {
      const modal = document.getElementById('passeLimiteModal');
      const icon = document.getElementById('passeLimiteIcon');
      const titulo = document.getElementById('passeLimiteTitulo');
      const desc = document.getElementById('passeLimiteDesc');
      const badge = document.getElementById('passeLimiteBadge');
      const counter = document.getElementById('passeLimiteCounter');

      if (passeInfo.expirado) {
        icon.textContent = '‚è∞';
        titulo.textContent = 'Passe expirado!';
        desc.innerHTML = 'Seu passe <strong>' + passeInfo.tipo + '</strong> expirou. ' +
          'No plano Free voc√™ pode torcer em at√© <strong>2 jogos por dia</strong>. ' +
          'Renove para voltar ao <strong>ilimitado</strong>!';
        badge.textContent = '‚ö†Ô∏è Passe ' + passeInfo.tipo + ' expirado ‚Äî limite de 2/dia';
      } else {
        icon.textContent = 'üîí';
        titulo.textContent = 'Limite atingido hoje!';
        desc.innerHTML = 'No plano <strong>Free</strong> voc√™ pode torcer em at√© <strong>2 jogos por dia</strong>. ' +
          'Volte amanh√£ ou fa√ßa upgrade para torcer em <strong>jogos ilimitados</strong>! üöÄ';
        badge.textContent = '‚öΩ Plano Free ‚Äî 2 torcidas/dia';
      }

      // Bolinhas de contagem
      let counterHtml = '';
      for (let i = 0; i < limite; i++) {
        if (i < usadas) {
          counterHtml += '<div class="passe-counter-dot used">‚úì</div>';
        } else {
          counterHtml += '<div class="passe-counter-dot free">-</div>';
        }
      }
      counter.innerHTML = counterHtml;

      modal.classList.add('active');
    }

    function fecharPasseModal() {
      document.getElementById('passeLimiteModal').classList.remove('active');
    }

    /**
     * Atualiza o display do passe no perfil
     * Mostra torcidas restantes para free, dias restantes para pagos
     */
    function atualizarDisplayPasse() {
      const info = getPasseInfo();
      const statFreeEl = document.getElementById('statFree');
      if (!statFreeEl) return;

      if (info.expirado) {
        statFreeEl.textContent = '‚ö†Ô∏è Expirado';
        statFreeEl.style.color = '#ef4444';
      } else if (info.ilimitado && info.dataExpiracao) {
        const diasRestam = Math.ceil((info.dataExpiracao - new Date()) / (1000 * 60 * 60 * 24));
        const labels = { semanal: 'üåü', mensal: 'üíé', anual: 'üëë' };
        statFreeEl.textContent = (labels[info.tipo] || 'üé´') + ' ' + diasRestam + 'd restantes';
        statFreeEl.style.color = diasRestam <= 3 ? '#f59e0b' : '#10b981';
      } else if (!info.ilimitado) {
        const restam = 2 - contarTorcidasHoje();
        statFreeEl.textContent = '‚öΩ Free (' + restam + '/2 hoje)';
        statFreeEl.style.color = restam > 0 ? '#a9b5c6' : '#ef4444';
      }
    }

    // Fechar modal ao clicar fora
    document.getElementById('passeLimiteModal').addEventListener('click', function(e) {
      if (e.target === this) fecharPasseModal();
    });

    // ==========================================
    // üéì ONBOARDING TUTORIAL
    // ==========================================
    let onbSlideAtual = 0;
    const TOTAL_SLIDES_ONB = 6;

    function mostrarOnboarding() {
      onbSlideAtual = 0;
      document.getElementById('onboardingOverlay').classList.add('active');
      atualizarSlideOnboarding();
      console.log('üéì Onboarding: mostrando tutorial para novo usu√°rio');
    }

    function proximoSlideOnboarding() {
      onbSlideAtual++;
      if (onbSlideAtual >= TOTAL_SLIDES_ONB) {
        fecharOnboarding();
        return;
      }
      atualizarSlideOnboarding();
    }

    function atualizarSlideOnboarding() {
      // Slides
      for (let i = 0; i < TOTAL_SLIDES_ONB; i++) {
        const slide = document.getElementById('onbSlide' + i);
        if (slide) slide.classList.toggle('active', i === onbSlideAtual);
      }
      // Dots
      const dots = document.querySelectorAll('#onbDots .onb-dot');
      dots.forEach((dot, i) => dot.classList.toggle('active', i === onbSlideAtual));
      // Button text
      const btnNext = document.getElementById('onbBtnNext');
      const btnSkip = document.getElementById('onbBtnSkip');
      if (onbSlideAtual === TOTAL_SLIDES_ONB - 1) {
        btnNext.textContent = 'üéÆ Bora Jogar!';
        btnSkip.style.display = 'none';
        // Confetti no √∫ltimo slide
        gerarConfetti();
      } else {
        btnNext.textContent = 'Pr√≥ximo ‚Üí';
        btnSkip.style.display = 'block';
      }
    }

    async function fecharOnboarding() {
      document.getElementById('onboardingOverlay').classList.remove('active');
      // Marcar que n√£o √© mais primeiro login
      try {
        await db.collection('usuarios').doc(currentUserId).update({
          primeiroLogin: false
        });
        currentUserData.primeiroLogin = false;
        console.log('üéì Onboarding: conclu√≠do, primeiroLogin = false');
      } catch (e) {
        console.error('Erro ao atualizar primeiroLogin:', e);
      }
      // Agora sim verificar quiz di√°rio
      await verificarQuizDiario();
    }

    function gerarConfetti() {
      const container = document.getElementById('onbConfetti');
      if (!container || container.children.length > 0) return;
      const cores = ['#ffb547', '#ff8c42', '#10b981', '#3b82f6', '#ec4899', '#eab308', '#dc2626'];
      for (let i = 0; i < 40; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.left = Math.random() * 100 + '%';
        piece.style.background = cores[Math.floor(Math.random() * cores.length)];
        piece.style.animationDelay = (Math.random() * 2) + 's';
        piece.style.animationDuration = (2 + Math.random() * 2) + 's';
        piece.style.width = (4 + Math.random() * 8) + 'px';
        piece.style.height = (4 + Math.random() * 8) + 'px';
        container.appendChild(piece);
      }
    }

    // Permitir swipe no onboarding
    (function() {
      let touchStartX = 0;
      document.addEventListener('touchstart', function(e) {
        if (!document.getElementById('onboardingOverlay').classList.contains('active')) return;
        touchStartX = e.touches[0].clientX;
      });
      document.addEventListener('touchend', function(e) {
        if (!document.getElementById('onboardingOverlay').classList.contains('active')) return;
        const diff = touchStartX - e.changedTouches[0].clientX;
        if (diff > 50) proximoSlideOnboarding(); // swipe left = next
        if (diff < -50 && onbSlideAtual > 0) { onbSlideAtual -= 2; proximoSlideOnboarding(); } // swipe right = prev
      });
    })();

    let quizDiarioPerguntaAtual = null;

    /**
     * Verifica se deve mostrar o quiz di√°rio
     * Regras:
     *  1. Usu√°rio precisa ter um timeId (time do cora√ß√£o)
     *  2. N√£o pode ter respondido hoje (verificado via Firestore)
     *  3. N√£o pode j√° ter sido exibido nesta sess√£o (sessionStorage)
     */
    async function verificarQuizDiario() {
      try {
        // J√° exibiu nesta sess√£o? N√£o mostra de novo (reload/navega√ß√£o)
        if (sessionStorage.getItem('yellup_quiz_diario_exibido')) {
          console.log("üìã Quiz di√°rio: j√° exibido nesta sess√£o, pulando.");
          return;
        }

        // Tem time do cora√ß√£o?
        if (!currentUserData.timeId) {
          console.log("üìã Quiz di√°rio: usu√°rio n√£o tem time do cora√ß√£o.");
          return;
        }

        // J√° respondeu hoje? (usa hor√°rio de Bras√≠lia, n√£o UTC)
        const agora = new Date();
        const brasilOffset = -3 * 60; // UTC-3
        const brasilTime = new Date(agora.getTime() + (brasilOffset - agora.getTimezoneOffset()) * 60000);
        const hoje = brasilTime.toISOString().split('T')[0]; // "YYYY-MM-DD" em BRT
        const ultimoQuiz = currentUserData.ultimoQuizDiario || '';

        if (ultimoQuiz === hoje) {
          console.log("üìã Quiz di√°rio: j√° respondeu hoje (" + hoje + ").");
          sessionStorage.setItem('yellup_quiz_diario_exibido', 'true');
          return;
        }

        // Buscar dados do time para exibir no modal
        const timeDoc = await db.collection('times').doc(currentUserData.timeId).get();
        if (!timeDoc.exists) {
          console.log("üìã Quiz di√°rio: time n√£o encontrado no banco.");
          return;
        }

        const timeData = timeDoc.data();

        // Preencher info do time no modal
        document.getElementById('quizTeamName').textContent = timeData.nome || 'Seu Time';
        document.getElementById('quizTeamJersey').innerHTML = gerarCamisetaSVG(
          timeData.primaria, timeData.secundaria, timeData.terciaria
        );

        // Marcar sess√£o como exibido (mesmo que o user feche sem responder)
        sessionStorage.setItem('yellup_quiz_diario_exibido', 'true');

        // Pequeno delay para o painel carregar e n√£o competir visualmente
        setTimeout(() => {
          document.getElementById('quizDiarioOverlay').classList.add('active');
        }, 1200);

        console.log("‚úÖ Quiz di√°rio: mostrando convite para " + timeData.nome);

      } catch (error) {
        console.error("‚ùå Erro no quiz di√°rio:", error);
      }
    }

    /**
     * Usu√°rio aceitou: busca pergunta aleat√≥ria e exibe
     */
    async function iniciarQuizDiario() {
      try {
        // Esconder convite, mostrar loading no bot√£o
        const btnSim = document.querySelector('.btn-quiz-sim');
        btnSim.textContent = '‚è≥ Buscando...';
        btnSim.disabled = true;

        // Buscar perguntas do time do cora√ß√£o
        const perguntasSnap = await db.collection('perguntas')
          .where('timeId', '==', currentUserData.timeId)
          .get();

        if (perguntasSnap.empty) {
          showToast('üòî Ainda n√£o temos perguntas sobre seu time. Em breve!');
          fecharQuizDiario();
          return;
        }

        // ==========================================
        // COLETAR TODAS AS PERGUNTAS J√Å RESPONDIDAS
        // (jogos, embates, PvP, ligas, quiz di√°rio)
        // ==========================================
        const jaRespondidas = new Set();

        // 1. perguntasRespondidas_* (uma chave por jogo/time)
        for (const chave of Object.keys(currentUserData)) {
          if (chave.startsWith('perguntasRespondidas_')) {
            const arr = currentUserData[chave];
            if (Array.isArray(arr)) {
              arr.forEach(id => jaRespondidas.add(id));
            }
          }
        }

        // 2. perguntasLigas (chaves por liga, cada uma com array de IDs)
        if (currentUserData.perguntasLigas) {
          for (const liga of Object.values(currentUserData.perguntasLigas)) {
            if (Array.isArray(liga)) {
              liga.forEach(id => jaRespondidas.add(id));
            }
          }
        }

        // 3. √öltima pergunta do quiz di√°rio
        if (currentUserData.ultimaQuizDiarioPerguntaId) {
          jaRespondidas.add(currentUserData.ultimaQuizDiarioPerguntaId);
        }

        console.log('üìã Quiz di√°rio: ' + jaRespondidas.size + ' perguntas j√° respondidas no total');

        // ==========================================
        // FILTRAR: s√≥ perguntas que o usu√°rio NUNCA viu
        // ==========================================
        const todasPerguntas = perguntasSnap.docs;
        let perguntasNovas = todasPerguntas.filter(doc => !jaRespondidas.has(doc.id));

        console.log('üìã Quiz di√°rio: ' + todasPerguntas.length + ' perguntas do time, ' + perguntasNovas.length + ' ainda n√£o respondidas');

        // Se zerou o banco, reseta ‚Äî permite repetir
        if (perguntasNovas.length === 0) {
          console.log('üìã Quiz di√°rio: todas as perguntas j√° foram respondidas! Reciclando...');
          perguntasNovas = todasPerguntas;
          showToast('üîÑ Voc√™ j√° respondeu todas! Reciclando perguntas.');
        }

        // Escolher aleat√≥ria entre as novas
        const randomIndex = Math.floor(Math.random() * perguntasNovas.length);
        const perguntaDoc = perguntasNovas[randomIndex];
        
        quizDiarioPerguntaAtual = {
          id: perguntaDoc.id,
          ...perguntaDoc.data()
        };

        // Preencher a pergunta
        const pontuacao = quizDiarioPerguntaAtual.pontuacao || 5;
        document.getElementById('quizXpBadge').textContent = `‚≠ê Acertou = +${pontuacao} XP | Participou = +2 XP`;
        document.getElementById('quizPerguntaTexto').textContent = quizDiarioPerguntaAtual.pergunta;

        // Gerar alternativas
        const alternativas = quizDiarioPerguntaAtual.alternativas;
        const container = document.getElementById('quizAlternativas');
        container.innerHTML = '';

        ['A', 'B', 'C', 'D'].forEach(letra => {
          if (alternativas[letra]) {
            const btn = document.createElement('button');
            btn.className = 'quiz-alt-btn';
            btn.innerHTML = `
              <span class="alt-letra">${letra}</span>
              <span>${alternativas[letra]}</span>
            `;
            btn.onclick = () => responderQuizDiario(letra, btn);
            container.appendChild(btn);
          }
        });

        // Transi√ß√£o: convite ‚Üí pergunta
        document.getElementById('quizStepConvite').style.display = 'none';
        document.getElementById('quizStepPergunta').style.display = 'block';

      } catch (error) {
        console.error("‚ùå Erro ao buscar pergunta:", error);
        showToast('‚ùå Erro ao carregar pergunta. Tente novamente!');
        fecharQuizDiario();
      }
    }

    /**
     * Usu√°rio respondeu a pergunta
     */
    async function responderQuizDiario(letraEscolhida, btnClicado) {
      if (!quizDiarioPerguntaAtual) return;

      // Desabilitar todos os bot√µes
      const todosBtn = document.querySelectorAll('.quiz-alt-btn');
      todosBtn.forEach(btn => {
        btn.classList.add('disabled');
        btn.onclick = null;
      });

      const correta = quizDiarioPerguntaAtual.correta;
      const acertou = letraEscolhida === correta;
      const pontuacaoBase = quizDiarioPerguntaAtual.pontuacao || 5;
      const xpGanho = acertou ? pontuacaoBase : 2;

      // Marcar visualmente
      if (acertou) {
        btnClicado.classList.add('correta');
      } else {
        btnClicado.classList.add('errada');
        // Mostrar qual era a correta
        todosBtn.forEach(btn => {
          if (btn.querySelector('.alt-letra').textContent === correta) {
            btn.classList.add('correta');
            btn.classList.remove('disabled');
          }
        });
      }

      // Salvar no Firestore (data em hor√°rio de Bras√≠lia)
      const agora = new Date();
      const brasilOffset = -3 * 60;
      const brasilTime = new Date(agora.getTime() + (brasilOffset - agora.getTimezoneOffset()) * 60000);
      const hoje = brasilTime.toISOString().split('T')[0];

      // Chave de perguntas respondidas do time (mesma usada nos jogos)
      const chaveRespondidas = 'perguntasRespondidas_' + currentUserData.timeId;

      try {
        await db.collection('usuarios').doc(currentUserId).update({
          ultimoQuizDiario: hoje,
          ultimaQuizDiarioPerguntaId: quizDiarioPerguntaAtual.id,
          xp: firebase.firestore.FieldValue.increment(xpGanho),
          quizDiarioTotal: firebase.firestore.FieldValue.increment(1),
          quizDiarioAcertos: acertou
            ? firebase.firestore.FieldValue.increment(1)
            : firebase.firestore.FieldValue.increment(0),
          // Salvar no mesmo array dos jogos para cruzar perguntas
          [chaveRespondidas]: firebase.firestore.FieldValue.arrayUnion(quizDiarioPerguntaAtual.id)
        });

        // Atualizar dados locais
        currentUserData.ultimoQuizDiario = hoje;
        currentUserData.ultimaQuizDiarioPerguntaId = quizDiarioPerguntaAtual.id;
        currentUserData.xp = (currentUserData.xp || 0) + xpGanho;
        // Atualizar array local tamb√©m
        if (!currentUserData[chaveRespondidas]) currentUserData[chaveRespondidas] = [];
        currentUserData[chaveRespondidas].push(quizDiarioPerguntaAtual.id);

        console.log(`‚úÖ Quiz di√°rio: ${acertou ? 'ACERTOU' : 'ERROU'} ‚Üí +${xpGanho} XP | Pergunta ${quizDiarioPerguntaAtual.id} salva em ${chaveRespondidas}`);
      } catch (error) {
        console.error("‚ùå Erro ao salvar quiz di√°rio:", error);
      }

      // Ap√≥s 1.5s, mostrar resultado
      setTimeout(() => {
        mostrarResultadoQuiz(acertou, xpGanho);
      }, 1500);
    }

    /**
     * Exibe o step de resultado final
     */
    function mostrarResultadoQuiz(acertou, xpGanho) {
      document.getElementById('quizStepPergunta').style.display = 'none';
      document.getElementById('quizStepResultado').style.display = 'block';

      if (acertou) {
        document.getElementById('quizResultIcon').textContent = 'üéâ';
        document.getElementById('quizResultTitulo').textContent = 'Mandou bem!';
        document.getElementById('quizResultTitulo').className = 'quiz-resultado-titulo acertou';
        document.getElementById('quizResultMsg').textContent = 
          'Voc√™ conhece bem seu time do cora√ß√£o! Volte amanh√£ para mais uma pergunta.';
      } else {
        document.getElementById('quizResultIcon').textContent = 'üí™';
        document.getElementById('quizResultTitulo').textContent = 'Quase l√°!';
        document.getElementById('quizResultTitulo').className = 'quiz-resultado-titulo errou';
        document.getElementById('quizResultMsg').textContent = 
          'Continue tentando! Aproveite nossa plataforma para aprender mais sobre futebol. Volte amanh√£!';
      }

      document.getElementById('quizXpGanho').textContent = `‚≠ê +${xpGanho} XP`;

      // Atualizar XP exibido no perfil sem recarregar
      document.getElementById('statXP').textContent = currentUserData.xp || 0;

      // Atualizar n√≠vel se mudou
      const nivel = calcularNivel(currentUserData.xp);
      const proximoNivel = calcularProximoNivel(currentUserData.xp);
      const progresso = calcularProgressoNivel(currentUserData.xp);

      const nivelBadge = document.getElementById('profileLevel');
      if (nivelBadge) {
        nivelBadge.innerHTML = `
          <span class="level-badge" style="background: ${nivel.cor}20; color: ${nivel.cor}; border: 1px solid ${nivel.cor}50;">
            ${nivel.emoji} ${nivel.nome}
          </span>
        `;
      }

      renderLevelProgress(currentUserData.xp, nivel, proximoNivel, progresso);
    }

    /**
     * Fechar modal e resetar steps
     */
    function fecharQuizDiario() {
      document.getElementById('quizDiarioOverlay').classList.remove('active');

      // Resetar para o estado inicial (caso abra amanh√£)
      setTimeout(() => {
        document.getElementById('quizStepConvite').style.display = 'block';
        document.getElementById('quizStepPergunta').style.display = 'none';
        document.getElementById('quizStepResultado').style.display = 'none';

        // Resetar bot√£o
        const btnSim = document.querySelector('.btn-quiz-sim');
        if (btnSim) {
          btnSim.textContent = 'üéÆ Bora!';
          btnSim.disabled = false;
        }

        quizDiarioPerguntaAtual = null;
      }, 400);
    }

    // Fechar quiz di√°rio ao clicar no overlay (fora do card)
    document.getElementById('quizDiarioOverlay').addEventListener('click', function(e) {
      if (e.target === this) {
        fecharQuizDiario();
      }
    });

    // ===================================
    // FIM QUIZ DI√ÅRIO
    // ===================================

    // ===================================
    // CARROSSEL DE DICAS
    // ===================================
    let currentSlide = 0;
    let slideInterval;
    const totalSlides = 5;
    const slideDelay = 5000; // 5 segundos por slide

    function goToSlide(index) {
      const slides = document.querySelectorAll('.tips-slide');
      const dots = document.querySelectorAll('.tips-dot');
      
      slides.forEach(s => s.classList.remove('active'));
      dots.forEach(d => d.classList.remove('active'));
      
      currentSlide = index;
      slides[currentSlide].classList.add('active');
      dots[currentSlide].classList.add('active');
      
      // Reiniciar intervalo
      clearInterval(slideInterval);
      startCarousel();
    }

    function nextSlide() {
      currentSlide = (currentSlide + 1) % totalSlides;
      goToSlide(currentSlide);
    }

    function startCarousel() {
      slideInterval = setInterval(nextSlide, slideDelay);
    }

    // Touch/swipe support para mobile
    let touchStartX = 0;
    let touchEndX = 0;

    document.getElementById('tipsCarousel')?.addEventListener('touchstart', e => {
      touchStartX = e.changedTouches[0].screenX;
    }, { passive: true });

    document.getElementById('tipsCarousel')?.addEventListener('touchend', e => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    }, { passive: true });

    function handleSwipe() {
      const diff = touchStartX - touchEndX;
      if (Math.abs(diff) > 50) { // M√≠nimo de 50px para considerar swipe
        if (diff > 0) {
          // Swipe left - pr√≥ximo slide
          nextSlide();
        } else {
          // Swipe right - slide anterior
          currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
          goToSlide(currentSlide);
        }
      }
    }

    // Iniciar carrossel (desativado no v9 ‚Äî substitu√≠do pelo hero)
    // startCarousel();

    // ===================================
    // ATIVIDADE RECENTE DOS AMIGOS
    // ===================================
    
    /**
     * Carrega atividade recente dos amigos do usu√°rio
    /**
     * Verifica se deve mostrar a√ß√£o r√°pida (ex: time jogando)
     */
    let heroActionCallback = null;

    function heroAction() {
      if (heroActionCallback) heroActionCallback();
    }

    function atualizarHero() {
      if (!currentUserData) return;
      
      // Atualizar streak chip
      const streak = currentUserData.streak || currentUserData.streakDias || 0;
      const streakChip = document.getElementById('streakChip');
      if (streakChip && streak > 0) {
        streakChip.style.display = 'flex';
        document.getElementById('streakChipValue').textContent = streak;
      }
      
      // Delegate to new rotation system
      buildHeroStates();
      heroCurrentIndex = 0;
      renderHeroDots();
      applyHeroState(heroStates[0], false);
      startHeroRotate();
    }

    // Manter compatibilidade
    function verificarAcaoRapida() { atualizarHero(); }
    function executarAcaoRapida() {}

    // ===================================
    // üîÑ HERO AUTO-ROTATE
    // ===================================
    let heroStates = [];
    let heroCurrentIndex = 0;
    let heroRotateInterval = null;

    function buildHeroStates() {
      if (!currentUserData) return;
      heroStates = [];
      
      const gamesLive = document.getElementById('gamesLive');
      const temJogoDoTime = gamesLive?.querySelector('.game-card.my-team-playing');
      const _agora = new Date();
      const _brOffset = -3 * 60;
      const _brTime = new Date(_agora.getTime() + (_brOffset - _agora.getTimezoneOffset()) * 60000);
      const hoje = _brTime.toISOString().split('T')[0];
      const jaFezQuizHoje = currentUserData.ultimoQuizDiario === hoje;
      const bauDisponivel = document.getElementById('bauBadge')?.style.display === 'block';

      if (temJogoDoTime) {
        heroStates.push({
          bg: "url('https://images.unsplash.com/photo-1489944440615-453fc2b6a9a9?w=800&q=80')",
          emoji: 'üì£', tagClass: 'hero-tag live', tag: 'üî¥ AO VIVO',
          title: 'Seu time est√° em campo!', subtitle: 'Mostre que voc√™ entende de futebol',
          action: () => { temJogoDoTime.scrollIntoView({behavior:'smooth',block:'center'}); setTimeout(()=>temJogoDoTime.click(),300); }
        });
      }
      if (!jaFezQuizHoje) {
        heroStates.push({
          bg: "url('https://images.unsplash.com/photo-1606925797300-0b35e9d1794e?w=800&q=80')",
          emoji: 'üß†', tagClass: 'hero-tag daily', tag: 'QUIZ DI√ÅRIO',
          title: 'Acerte e ganhe XP gr√°tis!', subtitle: 'Uma pergunta por dia sobre seu time',
          action: () => verificarQuizDiario()
        });
      }
      if (bauDisponivel) {
        heroStates.push({
          bg: "url('https://images.unsplash.com/photo-1513151233558-d860c5398176?w=800&q=80')",
          emoji: 'üéÅ', tagClass: 'hero-tag reward', tag: 'RECOMPENSA',
          title: 'Tem presente te esperando!', subtitle: 'Abra o ba√∫ e ganhe cr√©ditos gr√°tis',
          action: () => window.location.href = 'bau.html'
        });
      }
      // Always add PvP + indica√ß√£o
      heroStates.push({
        bg: "url('https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=800&q=80')",
        emoji: '‚öîÔ∏è', tagClass: 'hero-tag upcoming', tag: 'DESAFIE',
        title: 'Quem sabe mais de futebol?', subtitle: 'Chame um amigo pro Embate PvP',
        action: () => window.location.href = 'embates-pvp.html'
      });
      heroStates.push({
        bg: "url('https://images.unsplash.com/photo-1522778119026-d647f0596c20?w=800&q=80')",
        emoji: 'üèÖ', tagClass: 'hero-tag reward', tag: 'TORNEIOS',
        title: 'Ven√ßa torneios e ganhe pr√™mios!', subtitle: 'Torneios toda semana ‚Äî entre agora',
        action: () => window.location.href = 'torneios.html'
      });
      heroStates.push({
        bg: "url('https://images.unsplash.com/photo-1556056652-41dcf741e6b7?w=800&q=80')",
        emoji: 'üéÅ', tagClass: 'hero-tag upcoming', tag: 'INDIQUE',
        title: 'Convide amigos e ganhe cr√©ditos!', subtitle: 'Voc√™s dois saem ganhando',
        action: () => window.location.href = 'indicacoes.html'
      });
    }

    function applyHeroState(state, animate) {
      const hero = document.getElementById('heroDynamic');
      if (!hero || !state) return;
      
      if (animate) {
        hero.style.transition = 'opacity 0.3s';
        hero.style.opacity = '0';
        setTimeout(() => {
          setHeroContent(state);
          hero.style.opacity = '1';
        }, 300);
      } else {
        setHeroContent(state);
      }
      heroActionCallback = state.action;
      updateHeroDots();
    }

    function setHeroContent(s) {
      document.getElementById('heroBg').style.backgroundImage = s.bg;
      document.getElementById('heroEmoji').textContent = s.emoji;
      const tag = document.getElementById('heroTag');
      tag.className = s.tagClass;
      tag.textContent = s.tag;
      document.getElementById('heroTitle').textContent = s.title;
      document.getElementById('heroSubtitle').textContent = s.subtitle;
    }

    function renderHeroDots() {
      const container = document.getElementById('heroDots');
      if (!container || heroStates.length <= 1) { if(container) container.innerHTML = ''; return; }
      container.innerHTML = heroStates.map((_, i) => 
        `<div class="hdot ${i === heroCurrentIndex ? 'active' : ''}" onclick="event.stopPropagation();goToHeroState(${i})"></div>`
      ).join('');
    }

    function updateHeroDots() {
      const dots = document.querySelectorAll('.hero-dots .hdot');
      dots.forEach((d, i) => d.classList.toggle('active', i === heroCurrentIndex));
      if (dots.length === 0) renderHeroDots();
    }

    function goToHeroState(idx) {
      if (idx === heroCurrentIndex) return;
      heroCurrentIndex = idx;
      applyHeroState(heroStates[idx], true);
      // Reset rotation timer
      startHeroRotate();
    }

    // Touch swipe for hero
    (function() {
      let startX = 0;
      const hero = document.getElementById('heroDynamic');
      if (!hero) return;
      hero.addEventListener('touchstart', e => { startX = e.touches[0].clientX; }, {passive: true});
      hero.addEventListener('touchend', e => {
        const diff = startX - e.changedTouches[0].clientX;
        if (Math.abs(diff) < 40 || heroStates.length <= 1) return;
        if (diff > 0) { // swipe left = next
          heroCurrentIndex = (heroCurrentIndex + 1) % heroStates.length;
        } else { // swipe right = prev
          heroCurrentIndex = (heroCurrentIndex - 1 + heroStates.length) % heroStates.length;
        }
        applyHeroState(heroStates[heroCurrentIndex], true);
        startHeroRotate();
      }, {passive: true});
    })();

    function startHeroRotate() {
      if (heroStates.length <= 1) return;
      if (heroRotateInterval) clearInterval(heroRotateInterval);
      heroRotateInterval = setInterval(() => {
        heroCurrentIndex = (heroCurrentIndex + 1) % heroStates.length;
        applyHeroState(heroStates[heroCurrentIndex], true);
      }, 6000);
    }

    // ===================================
    // ‚ú® PARTICLE SYSTEM
    // ===================================
    function initProfileParticles() {
      const container = document.getElementById('profileParticles');
      if (!container) return;
      for (let i = 0; i < 12; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = (Math.random() * 100) + '%';
        p.style.bottom = (Math.random() * 30) + '%';
        p.style.animationDuration = (3 + Math.random() * 4) + 's';
        p.style.animationDelay = (Math.random() * 5) + 's';
        p.style.width = (2 + Math.random() * 3) + 'px';
        p.style.height = p.style.width;
        container.appendChild(p);
      }
    }

    // ===================================
    // üíÄ SKELETON LOADING
    // ===================================
    function showSkeleton() {
      document.body.classList.add('is-loading');
    }

    function hideSkeleton() {
      document.body.classList.remove('is-loading');
    }

    // ===================================
    // üü¢ ONLINE COUNTER (simulado + real)
    // ===================================
    function getSimulatedOnline() {
      const now = new Date();
      const brOffset = -3 * 60;
      const brTime = new Date(now.getTime() + (brOffset - now.getTimezoneOffset()) * 60000);
      const hour = brTime.getHours();
      
      // Curva realista baseada no hor√°rio BR
      const curves = {
        0: 85, 1: 45, 2: 30, 3: 20, 4: 15, 5: 25,
        6: 80, 7: 150, 8: 280, 9: 420, 10: 550, 11: 680,
        12: 820, 13: 750, 14: 900, 15: 1100, 16: 1350,
        17: 1600, 18: 2100, 19: 2800, 20: 3200, 21: 3500,
        22: 2400, 23: 400
      };
      
      const base = curves[hour] || 200;
      // Varia√ß√£o aleat√≥ria de ¬±15%
      const variation = base * (0.85 + Math.random() * 0.3);
      return Math.round(variation);
    }

    function updateOnlineCounter() {
      const el = document.getElementById('onlineCount');
      if (!el) return;
      const count = getSimulatedOnline();
      const formatted = count >= 1000 ? (count/1000).toFixed(1) + 'k' : count.toString();
      el.textContent = formatted;
    }

    // Atualizar a cada 45s com varia√ß√£o
    setInterval(updateOnlineCounter, 45000);

    // ===================================
    // üì∞ NEWS TICKER / LETREIRO
    // ===================================
    async function buildNewsTicker() {
      const track = document.getElementById('newsTickerTrack');
      if (!track) return;

      const items = [];
      
      try {
        // Buscar dados reais do ranking
        const rankSnap = await db.collection('usuarios')
          .orderBy('xp', 'desc')
          .limit(5)
          .get();
        
        if (!rankSnap.empty) {
          const topUser = rankSnap.docs[0].data();
          items.push({ emoji: 'üëë', text: `<span class="ticker-highlight">${topUser.nome || 'Jogador'}</span> lidera o ranking com ${topUser.xp || 0} XP` });
          
          if (rankSnap.docs.length > 2) {
            const secondUser = rankSnap.docs[1].data();
            const thirdUser = rankSnap.docs[2].data();
            items.push({ emoji: 'üèÜ', text: `Top 3: <span class="ticker-highlight">${topUser.nome?.split(' ')[0]}</span>, <span class="ticker-highlight">${secondUser.nome?.split(' ')[0]}</span> e <span class="ticker-highlight">${thirdUser.nome?.split(' ')[0]}</span>` });
          }
        }

        // Buscar dados de times mais torcidos
        const timesSnap = await db.collection('usuarios')
          .limit(100)
          .get();
        
        if (!timesSnap.empty) {
          const timeCount = {};
          timesSnap.forEach(doc => {
            const time = doc.data().time;
            if (time) timeCount[time] = (timeCount[time] || 0) + 1;
          });
          const sorted = Object.entries(timeCount).sort((a,b) => b[1] - a[1]);
          if (sorted.length >= 3) {
            items.push({ emoji: '‚öΩ', text: `Maiores torcidas: <span class="ticker-highlight">${sorted[0][0]}</span> em 1¬∫, <span class="ticker-highlight">${sorted[1][0]}</span> em 2¬∫, <span class="ticker-highlight">${sorted[2][0]}</span> em 3¬∫` });
          }
        }
      } catch(e) {
        console.log('Ticker: erro ao buscar dados reais', e);
      }

      // Itens fixos de engajamento
      items.push({ emoji: '‚öîÔ∏è', text: 'Chame seus amigos e crie um <span class="ticker-highlight">torneio de Embates PvP</span>' });
      items.push({ emoji: '‚öΩ', text: 'Seja o melhor cobrador de p√™naltis da plataforma!' });
      items.push({ emoji: 'üèÖ', text: 'Torneios toda semana com <span class="ticker-highlight">pr√™mios em cr√©ditos</span>!' });
      items.push({ emoji: 'üß†', text: 'Acerte 10 perguntas gr√°tis e ganhe <span class="ticker-highlight">cr√©ditos e XP</span>' });
      items.push({ emoji: 'üéÅ', text: 'Convide amigos e voc√™s dois ganham <span class="ticker-highlight">cr√©ditos gr√°tis</span>' });
      items.push({ emoji: 'üî•', text: 'Voc√™ sabe sua nota como torcedor? Acesse o <span class="ticker-highlight">Rating Superf√£</span>' });
      items.push({ emoji: 'üìä', text: 'Complete miss√µes di√°rias e suba no <span class="ticker-highlight">Ranking Global</span>' });

      // Shuffle items
      for (let i = items.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [items[i], items[j]] = [items[j], items[i]];
      }

      // Duplicar para loop cont√≠nuo
      const html = items.map(it => 
        `<span class="news-ticker-item"><span class="ticker-emoji">${it.emoji}</span>${it.text}</span><span class="news-ticker-sep">‚Ä¢</span>`
      ).join('');
      
      track.innerHTML = html + html; // Duplicado pro scroll infinito

      // Ajustar velocidade baseado no tamanho
      const duration = Math.max(25, items.length * 5);
      track.style.setProperty('--ticker-duration', duration + 's');
    }

    // ===================================
    // üîä SOUND EFFECTS (Web Audio API)
    // ===================================
    const YellupSounds = {
      ctx: null,
      enabled: true,
      
      init() {
        try {
          this.ctx = new (window.AudioContext || window.webkitAudioContext)();
        } catch(e) {}
      },

      play(type) {
        if (!this.enabled || !this.ctx) return;
        if (this.ctx.state === 'suspended') this.ctx.resume();
        
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.connect(gain);
        gain.connect(this.ctx.destination);
        
        const now = this.ctx.currentTime;
        
        switch(type) {
          case 'tap': // Toque em card
            osc.frequency.value = 600;
            osc.type = 'sine';
            gain.gain.setValueAtTime(0.08, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
            osc.start(now);
            osc.stop(now + 0.1);
            break;
          case 'coin': // Ganhar cr√©ditos
            osc.frequency.setValueAtTime(800, now);
            osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
            osc.type = 'sine';
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.2);
            osc.start(now);
            osc.stop(now + 0.2);
            break;
          case 'success': // Acerto
            osc.frequency.setValueAtTime(523, now);
            osc.type = 'sine';
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
            osc.start(now);
            osc.stop(now + 0.15);
            setTimeout(() => {
              if (!this.ctx) return;
              const o2 = this.ctx.createOscillator();
              const g2 = this.ctx.createGain();
              o2.connect(g2); g2.connect(this.ctx.destination);
              o2.frequency.value = 659;
              o2.type = 'sine';
              const t = this.ctx.currentTime;
              g2.gain.setValueAtTime(0.1, t);
              g2.gain.exponentialRampToValueAtTime(0.001, t + 0.2);
              o2.start(t); o2.stop(t + 0.2);
            }, 120);
            break;
          case 'error': // Erro
            osc.frequency.setValueAtTime(300, now);
            osc.frequency.exponentialRampToValueAtTime(200, now + 0.15);
            osc.type = 'sawtooth';
            gain.gain.setValueAtTime(0.06, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.15);
            osc.start(now);
            osc.stop(now + 0.15);
            break;
        }
      }
    };

    // ===================================
    // üì≥ HAPTIC FEEDBACK (Vibra√ß√£o)
    // ===================================
    function haptic(type) {
      if (!navigator.vibrate) return;
      switch(type) {
        case 'light': navigator.vibrate(10); break;
        case 'medium': navigator.vibrate(25); break;
        case 'success': navigator.vibrate([15, 50, 15]); break;
        case 'error': navigator.vibrate([30, 20, 30]); break;
      }
    }

    // Adicionar feedback em todos os cards interativos
    document.addEventListener('click', function(e) {
      const card = e.target.closest('.action-card, .explore-card, .qs-chip, .hero-dynamic');
      if (card) {
        haptic('light');
        YellupSounds.play('tap');
      }
    });

    // Init sounds on first interaction
    document.addEventListener('touchstart', function initSound() {
      YellupSounds.init();
      document.removeEventListener('touchstart', initSound);
    }, { once: true });
    document.addEventListener('click', function initSound() {
      YellupSounds.init();
      document.removeEventListener('click', initSound);
    }, { once: true });

    // ===================================
    // FIM GAMIFICA√á√ÉO VIS√çVEL

    // ===================================
    // AUTO-REFRESH DOS JOGOS (silencioso)
    // ===================================
    let autoRefreshInterval = null;
    const AUTO_REFRESH_SECONDS = 30; // Atualiza a cada 30 segundos

    function iniciarAutoRefresh() {
      // Limpar intervalo anterior se existir
      if (autoRefreshInterval) {
        clearInterval(autoRefreshInterval);
      }

      // Iniciar intervalo silencioso
      autoRefreshInterval = setInterval(async () => {
        try {
          await carregarJogos();
          console.log('üîÑ Jogos atualizados automaticamente');
        } catch (error) {
          console.error('Erro no auto-refresh:', error);
        }
      }, AUTO_REFRESH_SECONDS * 1000);

      console.log(`üîÑ Auto-refresh iniciado (${AUTO_REFRESH_SECONDS}s)`);
    }

    // Iniciar auto-refresh quando p√°gina carregar
    window.addEventListener('load', () => {
      setTimeout(iniciarAutoRefresh, 2000);
    });

    // Pausar quando aba n√£o est√° vis√≠vel para economizar recursos
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        if (autoRefreshInterval) {
          clearInterval(autoRefreshInterval);
          autoRefreshInterval = null;
          console.log('‚è∏Ô∏è Auto-refresh pausado (aba oculta)');
        }
      } else {
        // Atualizar imediatamente ao voltar e reiniciar intervalo
        carregarJogos();
        iniciarAutoRefresh();
        console.log('‚ñ∂Ô∏è Auto-refresh retomado');
      }
    });

    // ===================================
    // SLIDESHOW DE FOTOS DO PERFIL
    // ===================================
    let bgSlideshowInterval = null;
    let currentBgSlide = 0;
    let bgPhotos = [];

    /**
     * Carrega fotos de fundo do perfil do usu√°rio
     * As fotos s√£o salvas em: usuarios/{uid}/fotosFundo (array de URLs)
     */
    async function carregarFotosFundoPerfil() {
      if (!currentUserData) {
        console.log('üì∑ currentUserData n√£o dispon√≠vel');
        return;
      }

      console.log('üì∑ Verificando fotos de fundo...');
      console.log('üì∑ currentUserData.fotosFundo:', currentUserData.fotosFundo);

      // Buscar fotos de fundo do usu√°rio
      const fotos = currentUserData.fotosFundo || [];
      
      if (fotos.length === 0) {
        console.log('üì∑ Usu√°rio n√£o tem fotos de fundo personalizadas');
        return;
      }

      bgPhotos = fotos.slice(0, 3); // M√°ximo 3 fotos
      console.log('üì∑ Fotos a carregar:', bgPhotos);
      
      const profileCard = document.getElementById('userProfileCard');
      
      if (profileCard) {
        profileCard.classList.add('has-bg-photos');
      }

      // Aplicar fotos aos slides
      bgPhotos.forEach((url, index) => {
        const slide = document.getElementById(`bgSlide${index + 1}`);
        if (slide) {
          slide.style.backgroundImage = `url('${url}')`;
          console.log(`üì∑ Slide ${index + 1} configurado:`, url.substring(0, 50) + '...');
        }
      });

      // Adicionar indicadores se tiver mais de 1 foto
      if (bgPhotos.length > 1) {
        // Remover indicadores anteriores se existirem
        const oldIndicators = document.querySelector('.profile-bg-indicators');
        if (oldIndicators) oldIndicators.remove();
        
        const indicators = document.createElement('div');
        indicators.className = 'profile-bg-indicators';
        indicators.innerHTML = bgPhotos.map((_, i) => 
          `<div class="dot ${i === 0 ? 'active' : ''}" data-index="${i}"></div>`
        ).join('');
        
        if (profileCard) {
          profileCard.appendChild(indicators);
        }

        // Iniciar slideshow
        iniciarSlideshowPerfil();
      }

      console.log(`üì∑ ‚úÖ Carregadas ${bgPhotos.length} fotos de fundo do perfil`);
    }

    function iniciarSlideshowPerfil() {
      if (bgPhotos.length <= 1) return;

      // Limpar intervalo anterior
      if (bgSlideshowInterval) {
        clearInterval(bgSlideshowInterval);
      }

      // Trocar slide a cada 5 segundos
      bgSlideshowInterval = setInterval(() => {
        // Remover active do slide atual
        const slideAtual = document.getElementById(`bgSlide${currentBgSlide + 1}`);
        if (slideAtual) slideAtual.classList.remove('active');

        // Avan√ßar para pr√≥ximo slide
        currentBgSlide = (currentBgSlide + 1) % bgPhotos.length;

        // Ativar novo slide
        const novoSlide = document.getElementById(`bgSlide${currentBgSlide + 1}`);
        if (novoSlide) novoSlide.classList.add('active');

        // Atualizar indicadores
        const dots = document.querySelectorAll('.profile-bg-indicators .dot');
        dots.forEach((dot, i) => {
          dot.classList.toggle('active', i === currentBgSlide);
        });

      }, 5000); // 5 segundos por foto
    }
    // ===================================

    // Fechar modal ao clicar fora
    document.getElementById('modalEscolha').addEventListener('click', function(e) {
      if (e.target === this) {
        fecharModal();
      }
    });

    // ===================================
    // üéÅ BADGES DIN√ÇMICAS (Ba√∫, Miss√µes, Evolu√ß√£o)
    // ===================================
    async function verificarBadgesNovas() {
      try {
        // Ba√∫: mostrar badge "ABRIR" se n√£o abriu hoje
        const hoje = new Date();
        const hojeStr = `${hoje.getFullYear()}-${String(hoje.getMonth()+1).padStart(2,'0')}-${String(hoje.getDate()).padStart(2,'0')}`;
        
        const bauDoc = await db.collection('usuarios').doc(currentUserId)
          .collection('bau_diario').doc('estado').get();
        
        const bauBadge = document.getElementById('bauBadge');
        if (bauBadge) {
          if (!bauDoc.exists || bauDoc.data().ultimaAbertura !== hojeStr) {
            bauBadge.style.display = 'block';
          } else {
            bauBadge.style.display = 'none';
          }
        }

        // Evolu√ß√£o: mostrar n√≠vel atual
        const xp = currentUserData.xp || currentUserData.pontuacao || 0;
        const niveis = [
          { nome: 'Bronze', emoji: 'ü•â', threshold: 0 },
          { nome: 'Prata', emoji: 'ü•à', threshold: 500 },
          { nome: 'Ouro', emoji: 'ü•á', threshold: 2000 },
          { nome: 'Diamante', emoji: 'üíé', threshold: 5000 },
          { nome: 'Mestre', emoji: 'üëë', threshold: 10000 }
        ];
        let nivelAtual = niveis[0];
        for (let i = niveis.length - 1; i >= 0; i--) {
          if (xp >= niveis[i].threshold) { nivelAtual = niveis[i]; break; }
        }
        const evolDesc = document.getElementById('evolucaoDesc');
        if (evolDesc) evolDesc.textContent = `${nivelAtual.emoji} ${nivelAtual.nome} ‚Ä¢ ${xp} XP`;

        // Miss√µes: mostrar quantas completas
        const missoesSnap = await db.collection('usuarios').doc(currentUserId)
          .collection('missoes').get();
        let completas = 0;
        let total = 0;
        missoesSnap.forEach(doc => {
          total++;
          if (doc.data().concluido) completas++;
        });
        const missDesc = document.getElementById('missoesDesc');
        if (missDesc && total > 0) {
          missDesc.textContent = `${completas}/${total} completas`;
        }
      } catch (e) {
        console.error('Badges check:', e);
      }
    }

    console.log("‚úÖ Yellup Painel v10.2 - Camisetas Reais 3D + Midjourney Icons + Ticker + Sounds!");

    // Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }
  </script>

</body>
</html>
